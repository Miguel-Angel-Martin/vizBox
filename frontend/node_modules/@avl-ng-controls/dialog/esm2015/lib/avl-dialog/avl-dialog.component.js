var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};
var __metadata = (this && this.__metadata) || function (k, v) {
    if (typeof Reflect === "object" && typeof Reflect.metadata === "function") return Reflect.metadata(k, v);
};
import { Component, ElementRef, Input, Output, EventEmitter, ViewChild, ViewEncapsulation, ContentChild, TemplateRef, HostBinding, HostListener } from '@angular/core';
import { ConfigurableFocusTrapFactory } from '@angular/cdk/a11y';
import { NgForm } from '@angular/forms';
let AvlDialogComponent = class AvlDialogComponent {
    constructor(focusTrap) {
        this.focusTrap = focusTrap;
        this._open = false;
        this._dirty = false;
        this._warningOnClose = false;
        this._warningHeaderText = '';
        this._warningDialogText = '';
        this.openWarning = false;
        /**
         * If true, the dialog can be closed by clicking on scrim
         */
        this.closeOnScrimClick = true;
        /**
         * If true, new dialog can open inside a dialog
         */
        this.complex = false;
        /**
         * When checked, dialog opens in fullscreen mode
         */
        this.fullscreen = false;
        this.openChange = new EventEmitter();
    }
    /**
     * Sets the text for warning dialog header.
     */
    get warningHeaderText() {
        return this._warningHeaderText;
    }
    set warningHeaderText(value) {
        if (this._warningHeaderText !== value) {
            this._warningHeaderText = value;
        }
    }
    /**
     * Sets the main warning dialog text.
     */
    get warningDialogText() {
        return this._warningDialogText;
    }
    set warningDialogText(value) {
        if (this._warningDialogText !== value) {
            this._warningDialogText = value;
        }
    }
    /**
     * Can be set to open or close the dialog.
     * Returns the current state of the dialog.
     */
    get open() {
        return this._open;
    }
    set open(value) {
        if (this._open !== value) {
            this._open = !!value;
            this.openChange.emit(this._open);
            this.focusTrap.create(this.element.nativeElement).focusFirstTabbableElementWhenReady();
        }
    }
    /**
     * Indicates if the form has been touched.
     * Returns the current value of the attribute.
     */
    get dirty() {
        return !!this._dirty;
    }
    set dirty(value) {
        if (this._dirty !== value) {
            this._dirty = !!value;
            this.focusTrap.create(this.element.nativeElement).focusFirstTabbableElementWhenReady();
        }
    }
    /**
     * Can be set to indicate if the warning dialog should be opened.
     * Returns the current value of the attribute.
     */
    get warningOnClose() {
        return !!this._warningOnClose;
    }
    set warningOnClose(value) {
        if (this._warningOnClose !== value) {
            this._warningOnClose = !!value;
            this.focusTrap.create(this.element.nativeElement).focusFirstTabbableElementWhenReady();
        }
    }
    /** @hidden */
    close(event) {
        const target = event.target;
        if (this.closeOnScrimClick && target.classList.contains('scrim')) {
            if (this.warningOnClose) {
                if (this.openWarning === false) {
                    this.openWarning = true;
                }
            }
            else {
                if (this.dirty === true) {
                    this.openWarning = true;
                }
                else {
                    this.open = false;
                }
            }
        }
    }
    /**
     * Opens a dialog.
     */
    openDialog() {
        this.open = true;
    }
    /**
     * Closes a dialog.
     */
    closeDialog() {
        if (this.warningOnClose || this.dirty) {
            this.openWarning = !this.openWarning;
        }
        else {
            this.open = false;
        }
    }
    /**
     * Closes all dialogs.
     */
    closeAllDialogs() {
        this.openWarning = false;
        this.open = false;
        this.dirty = false;
    }
    /**
     * Opens a warning dialog.
     */
    openWarningDialog() {
        this.openWarning = true;
    }
    /**
     * Closes a warning dialog.
     */
    closeWarningDialog() {
        this.openWarning = false;
    }
    /** @hidden */
    keyEvent(event) {
        if (event.key === 'Esc' || event.key === 'Escape') {
            this.closeDialog();
        }
    }
    /** @hidden */
    get openedClosed() {
        return this._open;
    }
    /** @hidden */
    ngOnInit() {
        if (this.complex != null && this.complex !== false) {
            this.complex = true;
        }
    }
};
AvlDialogComponent.ctorParameters = () => [
    { type: ConfigurableFocusTrapFactory }
];
__decorate([
    ContentChild(TemplateRef),
    __metadata("design:type", TemplateRef)
], AvlDialogComponent.prototype, "content", void 0);
__decorate([
    ViewChild('element', { static: true }),
    __metadata("design:type", ElementRef)
], AvlDialogComponent.prototype, "element", void 0);
__decorate([
    ViewChild('optionForm', { read: NgForm }),
    __metadata("design:type", Object)
], AvlDialogComponent.prototype, "optionForm", void 0);
__decorate([
    Input(),
    __metadata("design:type", Boolean)
], AvlDialogComponent.prototype, "closeOnScrimClick", void 0);
__decorate([
    Input(),
    __metadata("design:type", Boolean)
], AvlDialogComponent.prototype, "complex", void 0);
__decorate([
    Input(),
    __metadata("design:type", String),
    __metadata("design:paramtypes", [String])
], AvlDialogComponent.prototype, "warningHeaderText", null);
__decorate([
    Input(),
    __metadata("design:type", String),
    __metadata("design:paramtypes", [String])
], AvlDialogComponent.prototype, "warningDialogText", null);
__decorate([
    HostBinding('class.fullscreen'),
    Input(),
    __metadata("design:type", Object)
], AvlDialogComponent.prototype, "fullscreen", void 0);
__decorate([
    Input(),
    __metadata("design:type", Boolean),
    __metadata("design:paramtypes", [Boolean])
], AvlDialogComponent.prototype, "open", null);
__decorate([
    Input(),
    __metadata("design:type", Boolean),
    __metadata("design:paramtypes", [Boolean])
], AvlDialogComponent.prototype, "dirty", null);
__decorate([
    Input(),
    __metadata("design:type", Boolean),
    __metadata("design:paramtypes", [Boolean])
], AvlDialogComponent.prototype, "warningOnClose", null);
__decorate([
    Output(),
    __metadata("design:type", Object)
], AvlDialogComponent.prototype, "openChange", void 0);
__decorate([
    HostListener('keydown', ['$event']),
    __metadata("design:type", Function),
    __metadata("design:paramtypes", [KeyboardEvent]),
    __metadata("design:returntype", void 0)
], AvlDialogComponent.prototype, "keyEvent", null);
__decorate([
    HostBinding('class.opened'),
    __metadata("design:type", Object),
    __metadata("design:paramtypes", [])
], AvlDialogComponent.prototype, "openedClosed", null);
AvlDialogComponent = __decorate([
    Component({
        selector: 'avl-dialog',
        template: "<div class=\"scrim\" (click)=\"close($event)\">\r\n  <div #element class=\"dialog\" [class.complex]=\"complex\" tabindex=\"0\">\r\n    <div *ngIf=\"open; then content\"></div>\r\n  </div>\r\n\r\n  <div *ngIf=\"openWarning\" #element class=\"dialog warning-dialog\" [class.complex]=\"complex\" tabindex=\"0\">\r\n    <avl-dialog-header>\r\n      {{ warningHeaderText || 'Warning Header' }}\r\n    </avl-dialog-header>\r\n    <avl-dialog-content class=\"warning\">\r\n      <section class=\"supporting-text\">\r\n        <div class=\"column\">\r\n          <avl-icon icon=\"icons:warning\"></avl-icon>\r\n        </div>\r\n        <div class=\"column\">\r\n          <h3>All changes will be lost if you proceed without saving.</h3>\r\n          <p id=\"customText\">{{ warningDialogText }}</p>\r\n        </div>\r\n      </section>\r\n      <section class=\"warning-buttons\">\r\n        <avl-button contained (click)=\"closeAllDialogs()\">Proceed</avl-button>\r\n        <avl-button (click)=\"closeWarningDialog()\">Cancel</avl-button>\r\n      </section>\r\n    </avl-dialog-content>\r\n  </div>\r\n</div>\r\n",
        encapsulation: ViewEncapsulation.Emulated,
        styles: [":host(){font-family:var(--avl-font-family);--avl-dialog-background-color:var(--avl-background-color);--avl-dialog-header-title-color:var(--avl-foreground-color);--avl-dialog-text-color:var(--avl-emphasis-medium-color);--avl-dialog-close-icon-color:var(--avl-icon-default-color);--avl-dialog-separator-color:var(--avl-divider-color);--avl-dialog-close-icon-ink-pressed-color:var(--avl-ink-default-pressed-color);--avl-dialog-close-icon-ink-focus-color:var(--avl-ink-default-focus-color);--avl-dialog-close-icon-ink-hover-color:var(--avl-ink-default-hover-color);display:none}.supporting-text{display:flex}.column{display:flex;flex-direction:column;flex-wrap:nowrap;align-items:flex-start}.supporting-text p#customText{margin-top:-6px;margin-bottom:11px}.supporting-text h3{font-size:16px;margin-top:7px;font-weight:700}form{margin-bottom:24px;margin-left:24px}.supporting-text avl-icon{width:40px;height:40px;margin-right:15px;margin-top:6px;flex-shrink:0;--avl-icon-custom-color:var(--avl-warning-color)}.warning-buttons{display:flex;justify-content:flex-end;margin-bottom:16px}.warning-buttons>avl-button{margin-top:4px}.warning-buttons>avl-button:last-child{margin-left:-7px}:host(.opened){display:block}.scrim{position:fixed;z-index:50;left:0;top:0;width:100%;height:100%;background-color:var(--avl-scrim-color);display:flex;flex-flow:column nowrap;justify-content:center;align-items:center}.dialog{box-sizing:border-box;height:calc(var(--avl-dialog-height) - 2px);outline:0;display:flex;flex-direction:column;position:absolute;width:var(--avl-dialog-width);min-width:280px;min-height:230px;max-width:calc(100vw - 96px);max-height:calc(100vh - 96px);background-color:var(--avl-dialog-background-color);color:var(--avl-dialog-text-color);box-shadow:var(--avl-box-shadow-24dp);min-width:444px}.warning-dialog{min-height:211px!important}:host(.fullscreen)>div>.dialog{width:100%;height:100%;max-width:100%;max-height:100%}"]
    }),
    __metadata("design:paramtypes", [ConfigurableFocusTrapFactory])
], AvlDialogComponent);
export { AvlDialogComponent };
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiYXZsLWRpYWxvZy5jb21wb25lbnQuanMiLCJzb3VyY2VSb290Ijoibmc6Ly9AYXZsLW5nLWNvbnRyb2xzL2RpYWxvZy8iLCJzb3VyY2VzIjpbImxpYi9hdmwtZGlhbG9nL2F2bC1kaWFsb2cuY29tcG9uZW50LnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7Ozs7OztBQUFBLE9BQU8sRUFDTCxTQUFTLEVBQ1QsVUFBVSxFQUNWLEtBQUssRUFDTCxNQUFNLEVBQ04sWUFBWSxFQUNaLFNBQVMsRUFDVCxpQkFBaUIsRUFDakIsWUFBWSxFQUNaLFdBQVcsRUFDWCxXQUFXLEVBQ1gsWUFBWSxFQUViLE1BQU0sZUFBZSxDQUFDO0FBQ3ZCLE9BQU8sRUFBRSw0QkFBNEIsRUFBRSxNQUFNLG1CQUFtQixDQUFDO0FBQ2pFLE9BQU8sRUFBRSxNQUFNLEVBQUUsTUFBTSxnQkFBZ0IsQ0FBQztBQVF4QyxJQUFhLGtCQUFrQixHQUEvQixNQUFhLGtCQUFrQjtJQXVMN0IsWUFBb0IsU0FBdUM7UUFBdkMsY0FBUyxHQUFULFNBQVMsQ0FBOEI7UUF0TG5ELFVBQUssR0FBRyxLQUFLLENBQUM7UUFDZCxXQUFNLEdBQVksS0FBSyxDQUFDO1FBQ3hCLG9CQUFlLEdBQUcsS0FBSyxDQUFDO1FBQ3hCLHVCQUFrQixHQUFHLEVBQUUsQ0FBQztRQUN4Qix1QkFBa0IsR0FBRyxFQUFFLENBQUM7UUFDekIsZ0JBQVcsR0FBRyxLQUFLLENBQUM7UUFhM0I7O1dBRUc7UUFDTSxzQkFBaUIsR0FBWSxJQUFJLENBQUM7UUFFM0M7O1dBRUc7UUFDTSxZQUFPLEdBQVksS0FBSyxDQUFDO1FBNEJsQzs7V0FFRztRQUdILGVBQVUsR0FBRyxLQUFLLENBQUM7UUFnRFQsZUFBVSxHQUFHLElBQUksWUFBWSxFQUFXLENBQUM7SUEyRVcsQ0FBQztJQTFKL0Q7O09BRUc7SUFFSCxJQUFJLGlCQUFpQjtRQUNuQixPQUFPLElBQUksQ0FBQyxrQkFBa0IsQ0FBQztJQUNqQyxDQUFDO0lBQ0QsSUFBSSxpQkFBaUIsQ0FBQyxLQUFhO1FBQ2pDLElBQUksSUFBSSxDQUFDLGtCQUFrQixLQUFLLEtBQUssRUFBRTtZQUNyQyxJQUFJLENBQUMsa0JBQWtCLEdBQUcsS0FBSyxDQUFDO1NBQ2pDO0lBQ0gsQ0FBQztJQUVEOztPQUVHO0lBRUgsSUFBSSxpQkFBaUI7UUFDbkIsT0FBTyxJQUFJLENBQUMsa0JBQWtCLENBQUM7SUFDakMsQ0FBQztJQUNELElBQUksaUJBQWlCLENBQUMsS0FBYTtRQUNqQyxJQUFJLElBQUksQ0FBQyxrQkFBa0IsS0FBSyxLQUFLLEVBQUU7WUFDckMsSUFBSSxDQUFDLGtCQUFrQixHQUFHLEtBQUssQ0FBQztTQUNqQztJQUNILENBQUM7SUFTRDs7O09BR0c7SUFFSCxJQUFJLElBQUk7UUFDTixPQUFPLElBQUksQ0FBQyxLQUFLLENBQUM7SUFDcEIsQ0FBQztJQUNELElBQUksSUFBSSxDQUFDLEtBQWM7UUFDckIsSUFBSSxJQUFJLENBQUMsS0FBSyxLQUFLLEtBQUssRUFBRTtZQUN4QixJQUFJLENBQUMsS0FBSyxHQUFHLENBQUMsQ0FBQyxLQUFLLENBQUM7WUFDckIsSUFBSSxDQUFDLFVBQVUsQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLEtBQUssQ0FBQyxDQUFDO1lBQ2pDLElBQUksQ0FBQyxTQUFTLENBQUMsTUFBTSxDQUFDLElBQUksQ0FBQyxPQUFPLENBQUMsYUFBYSxDQUFDLENBQUMsa0NBQWtDLEVBQUUsQ0FBQztTQUN4RjtJQUNILENBQUM7SUFFRDs7O09BR0c7SUFFSCxJQUFJLEtBQUs7UUFDUCxPQUFPLENBQUMsQ0FBQyxJQUFJLENBQUMsTUFBTSxDQUFDO0lBQ3ZCLENBQUM7SUFDRCxJQUFJLEtBQUssQ0FBQyxLQUFjO1FBQ3RCLElBQUksSUFBSSxDQUFDLE1BQU0sS0FBSyxLQUFLLEVBQUU7WUFDekIsSUFBSSxDQUFDLE1BQU0sR0FBRyxDQUFDLENBQUMsS0FBSyxDQUFDO1lBQ3RCLElBQUksQ0FBQyxTQUFTLENBQUMsTUFBTSxDQUFDLElBQUksQ0FBQyxPQUFPLENBQUMsYUFBYSxDQUFDLENBQUMsa0NBQWtDLEVBQUUsQ0FBQztTQUN4RjtJQUNILENBQUM7SUFFRDs7O09BR0c7SUFFSCxJQUFJLGNBQWM7UUFDaEIsT0FBTyxDQUFDLENBQUMsSUFBSSxDQUFDLGVBQWUsQ0FBQztJQUNoQyxDQUFDO0lBQ0QsSUFBSSxjQUFjLENBQUMsS0FBYztRQUMvQixJQUFJLElBQUksQ0FBQyxlQUFlLEtBQUssS0FBSyxFQUFFO1lBQ2xDLElBQUksQ0FBQyxlQUFlLEdBQUcsQ0FBQyxDQUFDLEtBQUssQ0FBQztZQUMvQixJQUFJLENBQUMsU0FBUyxDQUFDLE1BQU0sQ0FBQyxJQUFJLENBQUMsT0FBTyxDQUFDLGFBQWEsQ0FBQyxDQUFDLGtDQUFrQyxFQUFFLENBQUM7U0FDeEY7SUFDSCxDQUFDO0lBSUQsY0FBYztJQUNkLEtBQUssQ0FBQyxLQUFpQjtRQUNyQixNQUFNLE1BQU0sR0FBRyxLQUFLLENBQUMsTUFBcUIsQ0FBQztRQUMzQyxJQUFJLElBQUksQ0FBQyxpQkFBaUIsSUFBSSxNQUFNLENBQUMsU0FBUyxDQUFDLFFBQVEsQ0FBQyxPQUFPLENBQUMsRUFBRTtZQUNoRSxJQUFJLElBQUksQ0FBQyxjQUFjLEVBQUU7Z0JBQ3ZCLElBQUksSUFBSSxDQUFDLFdBQVcsS0FBSyxLQUFLLEVBQUU7b0JBQzlCLElBQUksQ0FBQyxXQUFXLEdBQUcsSUFBSSxDQUFDO2lCQUN6QjthQUNGO2lCQUFNO2dCQUNMLElBQUksSUFBSSxDQUFDLEtBQUssS0FBSyxJQUFJLEVBQUU7b0JBQ3ZCLElBQUksQ0FBQyxXQUFXLEdBQUcsSUFBSSxDQUFDO2lCQUN6QjtxQkFBTTtvQkFDTCxJQUFJLENBQUMsSUFBSSxHQUFHLEtBQUssQ0FBQztpQkFDbkI7YUFDRjtTQUNGO0lBQ0gsQ0FBQztJQUVEOztPQUVHO0lBQ0gsVUFBVTtRQUNSLElBQUksQ0FBQyxJQUFJLEdBQUcsSUFBSSxDQUFDO0lBQ25CLENBQUM7SUFFRDs7T0FFRztJQUNILFdBQVc7UUFDVCxJQUFJLElBQUksQ0FBQyxjQUFjLElBQUksSUFBSSxDQUFDLEtBQUssRUFBRTtZQUNyQyxJQUFJLENBQUMsV0FBVyxHQUFHLENBQUMsSUFBSSxDQUFDLFdBQVcsQ0FBQztTQUN0QzthQUFNO1lBQ0wsSUFBSSxDQUFDLElBQUksR0FBRyxLQUFLLENBQUM7U0FDbkI7SUFDSCxDQUFDO0lBRUQ7O09BRUc7SUFDSCxlQUFlO1FBQ2IsSUFBSSxDQUFDLFdBQVcsR0FBRyxLQUFLLENBQUM7UUFDekIsSUFBSSxDQUFDLElBQUksR0FBRyxLQUFLLENBQUM7UUFDbEIsSUFBSSxDQUFDLEtBQUssR0FBRyxLQUFLLENBQUM7SUFDckIsQ0FBQztJQUVEOztPQUVHO0lBQ0gsaUJBQWlCO1FBQ2YsSUFBSSxDQUFDLFdBQVcsR0FBRyxJQUFJLENBQUM7SUFDMUIsQ0FBQztJQUVEOztPQUVHO0lBQ0gsa0JBQWtCO1FBQ2hCLElBQUksQ0FBQyxXQUFXLEdBQUcsS0FBSyxDQUFDO0lBQzNCLENBQUM7SUFFRCxjQUFjO0lBRWQsUUFBUSxDQUFDLEtBQW9CO1FBQzNCLElBQUksS0FBSyxDQUFDLEdBQUcsS0FBSyxLQUFLLElBQUksS0FBSyxDQUFDLEdBQUcsS0FBSyxRQUFRLEVBQUU7WUFDL0MsSUFBSSxDQUFDLFdBQVcsRUFBRSxDQUFDO1NBQ3RCO0lBQ0gsQ0FBQztJQUVELGNBQWM7SUFFZCxJQUFJLFlBQVk7UUFDZCxPQUFPLElBQUksQ0FBQyxLQUFLLENBQUM7SUFDcEIsQ0FBQztJQUlELGNBQWM7SUFDZCxRQUFRO1FBQ04sSUFBSSxJQUFJLENBQUMsT0FBTyxJQUFJLElBQUksSUFBSSxJQUFJLENBQUMsT0FBTyxLQUFLLEtBQUssRUFBRTtZQUNsRCxJQUFJLENBQUMsT0FBTyxHQUFHLElBQUksQ0FBQztTQUNyQjtJQUNILENBQUM7Q0FzQkYsQ0FBQTs7WUE3QmdDLDRCQUE0Qjs7QUE1S2hDO0lBQTFCLFlBQVksQ0FBQyxXQUFXLENBQUM7OEJBQVUsV0FBVzttREFBTTtBQUdiO0lBQXZDLFNBQVMsQ0FBQyxTQUFTLEVBQUUsRUFBRSxNQUFNLEVBQUUsSUFBSSxFQUFFLENBQUM7OEJBQVUsVUFBVTttREFBQztBQUdqQjtJQUExQyxTQUFTLENBQUMsWUFBWSxFQUFFLEVBQUUsSUFBSSxFQUFFLE1BQU0sRUFBRSxDQUFDOztzREFBaUI7QUFLbEQ7SUFBUixLQUFLLEVBQUU7OzZEQUFtQztBQUtsQztJQUFSLEtBQUssRUFBRTs7bURBQTBCO0FBTWxDO0lBREMsS0FBSyxFQUFFOzs7MkRBR1A7QUFXRDtJQURDLEtBQUssRUFBRTs7OzJEQUdQO0FBWUQ7SUFGQyxXQUFXLENBQUMsa0JBQWtCLENBQUM7SUFDL0IsS0FBSyxFQUFFOztzREFDVztBQU9uQjtJQURDLEtBQUssRUFBRTs7OzhDQUdQO0FBY0Q7SUFEQyxLQUFLLEVBQUU7OzsrQ0FHUDtBQWFEO0lBREMsS0FBSyxFQUFFOzs7d0RBR1A7QUFRUztJQUFULE1BQU0sRUFBRTs7c0RBQTBDO0FBK0RuRDtJQURDLFlBQVksQ0FBQyxTQUFTLEVBQUUsQ0FBQyxRQUFRLENBQUMsQ0FBQzs7cUNBQ3BCLGFBQWE7O2tEQUk1QjtBQUlEO0lBREMsV0FBVyxDQUFDLGNBQWMsQ0FBQzs7O3NEQUczQjtBQXJMVSxrQkFBa0I7SUFOOUIsU0FBUyxDQUFDO1FBQ1QsUUFBUSxFQUFFLFlBQVk7UUFDdEIsaW1DQUEwQztRQUUxQyxhQUFhLEVBQUUsaUJBQWlCLENBQUMsUUFBUTs7S0FDMUMsQ0FBQztxQ0F3TCtCLDRCQUE0QjtHQXZMaEQsa0JBQWtCLENBb045QjtTQXBOWSxrQkFBa0IiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQge1xyXG4gIENvbXBvbmVudCxcclxuICBFbGVtZW50UmVmLFxyXG4gIElucHV0LFxyXG4gIE91dHB1dCxcclxuICBFdmVudEVtaXR0ZXIsXHJcbiAgVmlld0NoaWxkLFxyXG4gIFZpZXdFbmNhcHN1bGF0aW9uLFxyXG4gIENvbnRlbnRDaGlsZCxcclxuICBUZW1wbGF0ZVJlZixcclxuICBIb3N0QmluZGluZyxcclxuICBIb3N0TGlzdGVuZXIsXHJcbiAgT25Jbml0XHJcbn0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XHJcbmltcG9ydCB7IENvbmZpZ3VyYWJsZUZvY3VzVHJhcEZhY3RvcnkgfSBmcm9tICdAYW5ndWxhci9jZGsvYTExeSc7XHJcbmltcG9ydCB7IE5nRm9ybSB9IGZyb20gJ0Bhbmd1bGFyL2Zvcm1zJztcclxuXHJcbkBDb21wb25lbnQoe1xyXG4gIHNlbGVjdG9yOiAnYXZsLWRpYWxvZycsXHJcbiAgdGVtcGxhdGVVcmw6ICcuL2F2bC1kaWFsb2cuY29tcG9uZW50Lmh0bWwnLFxyXG4gIHN0eWxlVXJsczogWycuL2F2bC1kaWFsb2cuY29tcG9uZW50LmNzcyddLFxyXG4gIGVuY2Fwc3VsYXRpb246IFZpZXdFbmNhcHN1bGF0aW9uLkVtdWxhdGVkXHJcbn0pXHJcbmV4cG9ydCBjbGFzcyBBdmxEaWFsb2dDb21wb25lbnQgaW1wbGVtZW50cyBPbkluaXQge1xyXG4gIHByaXZhdGUgX29wZW4gPSBmYWxzZTtcclxuICBwcml2YXRlIF9kaXJ0eTogYm9vbGVhbiA9IGZhbHNlO1xyXG4gIHByaXZhdGUgX3dhcm5pbmdPbkNsb3NlID0gZmFsc2U7XHJcbiAgcHJpdmF0ZSBfd2FybmluZ0hlYWRlclRleHQgPSAnJztcclxuICBwcml2YXRlIF93YXJuaW5nRGlhbG9nVGV4dCA9ICcnO1xyXG4gIHB1YmxpYyBvcGVuV2FybmluZyA9IGZhbHNlO1xyXG5cclxuICAvKipcclxuICAgKiBEaWFsb2cgY29udGVudFxyXG4gICAqL1xyXG4gIEBDb250ZW50Q2hpbGQoVGVtcGxhdGVSZWYpIGNvbnRlbnQ6IFRlbXBsYXRlUmVmPGFueT47XHJcblxyXG4gIC8qKiBAaGlkZGVuICovXHJcbiAgQFZpZXdDaGlsZCgnZWxlbWVudCcsIHsgc3RhdGljOiB0cnVlIH0pIGVsZW1lbnQ6IEVsZW1lbnRSZWY7XHJcblxyXG4gIC8qKiBAaGlkZGVuICovXHJcbiAgQFZpZXdDaGlsZCgnb3B0aW9uRm9ybScsIHsgcmVhZDogTmdGb3JtIH0pIG9wdGlvbkZvcm06IGFueTtcclxuXHJcbiAgLyoqXHJcbiAgICogSWYgdHJ1ZSwgdGhlIGRpYWxvZyBjYW4gYmUgY2xvc2VkIGJ5IGNsaWNraW5nIG9uIHNjcmltXHJcbiAgICovXHJcbiAgQElucHV0KCkgY2xvc2VPblNjcmltQ2xpY2s6IGJvb2xlYW4gPSB0cnVlO1xyXG5cclxuICAvKipcclxuICAgKiBJZiB0cnVlLCBuZXcgZGlhbG9nIGNhbiBvcGVuIGluc2lkZSBhIGRpYWxvZ1xyXG4gICAqL1xyXG4gIEBJbnB1dCgpIGNvbXBsZXg6IGJvb2xlYW4gPSBmYWxzZTtcclxuXHJcbiAgLyoqXHJcbiAgICogU2V0cyB0aGUgdGV4dCBmb3Igd2FybmluZyBkaWFsb2cgaGVhZGVyLlxyXG4gICAqL1xyXG4gIEBJbnB1dCgpXHJcbiAgZ2V0IHdhcm5pbmdIZWFkZXJUZXh0KCk6IHN0cmluZyB7XHJcbiAgICByZXR1cm4gdGhpcy5fd2FybmluZ0hlYWRlclRleHQ7XHJcbiAgfVxyXG4gIHNldCB3YXJuaW5nSGVhZGVyVGV4dCh2YWx1ZTogc3RyaW5nKSB7XHJcbiAgICBpZiAodGhpcy5fd2FybmluZ0hlYWRlclRleHQgIT09IHZhbHVlKSB7XHJcbiAgICAgIHRoaXMuX3dhcm5pbmdIZWFkZXJUZXh0ID0gdmFsdWU7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBTZXRzIHRoZSBtYWluIHdhcm5pbmcgZGlhbG9nIHRleHQuXHJcbiAgICovXHJcbiAgQElucHV0KClcclxuICBnZXQgd2FybmluZ0RpYWxvZ1RleHQoKTogc3RyaW5nIHtcclxuICAgIHJldHVybiB0aGlzLl93YXJuaW5nRGlhbG9nVGV4dDtcclxuICB9XHJcbiAgc2V0IHdhcm5pbmdEaWFsb2dUZXh0KHZhbHVlOiBzdHJpbmcpIHtcclxuICAgIGlmICh0aGlzLl93YXJuaW5nRGlhbG9nVGV4dCAhPT0gdmFsdWUpIHtcclxuICAgICAgdGhpcy5fd2FybmluZ0RpYWxvZ1RleHQgPSB2YWx1ZTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIFdoZW4gY2hlY2tlZCwgZGlhbG9nIG9wZW5zIGluIGZ1bGxzY3JlZW4gbW9kZVxyXG4gICAqL1xyXG4gIEBIb3N0QmluZGluZygnY2xhc3MuZnVsbHNjcmVlbicpXHJcbiAgQElucHV0KClcclxuICBmdWxsc2NyZWVuID0gZmFsc2U7XHJcblxyXG4gIC8qKlxyXG4gICAqIENhbiBiZSBzZXQgdG8gb3BlbiBvciBjbG9zZSB0aGUgZGlhbG9nLlxyXG4gICAqIFJldHVybnMgdGhlIGN1cnJlbnQgc3RhdGUgb2YgdGhlIGRpYWxvZy5cclxuICAgKi9cclxuICBASW5wdXQoKVxyXG4gIGdldCBvcGVuKCk6IGJvb2xlYW4ge1xyXG4gICAgcmV0dXJuIHRoaXMuX29wZW47XHJcbiAgfVxyXG4gIHNldCBvcGVuKHZhbHVlOiBib29sZWFuKSB7XHJcbiAgICBpZiAodGhpcy5fb3BlbiAhPT0gdmFsdWUpIHtcclxuICAgICAgdGhpcy5fb3BlbiA9ICEhdmFsdWU7XHJcbiAgICAgIHRoaXMub3BlbkNoYW5nZS5lbWl0KHRoaXMuX29wZW4pO1xyXG4gICAgICB0aGlzLmZvY3VzVHJhcC5jcmVhdGUodGhpcy5lbGVtZW50Lm5hdGl2ZUVsZW1lbnQpLmZvY3VzRmlyc3RUYWJiYWJsZUVsZW1lbnRXaGVuUmVhZHkoKTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIEluZGljYXRlcyBpZiB0aGUgZm9ybSBoYXMgYmVlbiB0b3VjaGVkLlxyXG4gICAqIFJldHVybnMgdGhlIGN1cnJlbnQgdmFsdWUgb2YgdGhlIGF0dHJpYnV0ZS5cclxuICAgKi9cclxuICBASW5wdXQoKVxyXG4gIGdldCBkaXJ0eSgpOiBib29sZWFuIHtcclxuICAgIHJldHVybiAhIXRoaXMuX2RpcnR5O1xyXG4gIH1cclxuICBzZXQgZGlydHkodmFsdWU6IGJvb2xlYW4pIHtcclxuICAgIGlmICh0aGlzLl9kaXJ0eSAhPT0gdmFsdWUpIHtcclxuICAgICAgdGhpcy5fZGlydHkgPSAhIXZhbHVlO1xyXG4gICAgICB0aGlzLmZvY3VzVHJhcC5jcmVhdGUodGhpcy5lbGVtZW50Lm5hdGl2ZUVsZW1lbnQpLmZvY3VzRmlyc3RUYWJiYWJsZUVsZW1lbnRXaGVuUmVhZHkoKTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIENhbiBiZSBzZXQgdG8gaW5kaWNhdGUgaWYgdGhlIHdhcm5pbmcgZGlhbG9nIHNob3VsZCBiZSBvcGVuZWQuXHJcbiAgICogUmV0dXJucyB0aGUgY3VycmVudCB2YWx1ZSBvZiB0aGUgYXR0cmlidXRlLlxyXG4gICAqL1xyXG4gIEBJbnB1dCgpXHJcbiAgZ2V0IHdhcm5pbmdPbkNsb3NlKCk6IGJvb2xlYW4ge1xyXG4gICAgcmV0dXJuICEhdGhpcy5fd2FybmluZ09uQ2xvc2U7XHJcbiAgfVxyXG4gIHNldCB3YXJuaW5nT25DbG9zZSh2YWx1ZTogYm9vbGVhbikge1xyXG4gICAgaWYgKHRoaXMuX3dhcm5pbmdPbkNsb3NlICE9PSB2YWx1ZSkge1xyXG4gICAgICB0aGlzLl93YXJuaW5nT25DbG9zZSA9ICEhdmFsdWU7XHJcbiAgICAgIHRoaXMuZm9jdXNUcmFwLmNyZWF0ZSh0aGlzLmVsZW1lbnQubmF0aXZlRWxlbWVudCkuZm9jdXNGaXJzdFRhYmJhYmxlRWxlbWVudFdoZW5SZWFkeSgpO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgQE91dHB1dCgpIG9wZW5DaGFuZ2UgPSBuZXcgRXZlbnRFbWl0dGVyPGJvb2xlYW4+KCk7XHJcblxyXG4gIC8qKiBAaGlkZGVuICovXHJcbiAgY2xvc2UoZXZlbnQ6IE1vdXNlRXZlbnQpIHtcclxuICAgIGNvbnN0IHRhcmdldCA9IGV2ZW50LnRhcmdldCBhcyBIVE1MRWxlbWVudDtcclxuICAgIGlmICh0aGlzLmNsb3NlT25TY3JpbUNsaWNrICYmIHRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoJ3NjcmltJykpIHtcclxuICAgICAgaWYgKHRoaXMud2FybmluZ09uQ2xvc2UpIHtcclxuICAgICAgICBpZiAodGhpcy5vcGVuV2FybmluZyA9PT0gZmFsc2UpIHtcclxuICAgICAgICAgIHRoaXMub3Blbldhcm5pbmcgPSB0cnVlO1xyXG4gICAgICAgIH1cclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICBpZiAodGhpcy5kaXJ0eSA9PT0gdHJ1ZSkge1xyXG4gICAgICAgICAgdGhpcy5vcGVuV2FybmluZyA9IHRydWU7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgIHRoaXMub3BlbiA9IGZhbHNlO1xyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogT3BlbnMgYSBkaWFsb2cuXHJcbiAgICovXHJcbiAgb3BlbkRpYWxvZygpIHtcclxuICAgIHRoaXMub3BlbiA9IHRydWU7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBDbG9zZXMgYSBkaWFsb2cuXHJcbiAgICovXHJcbiAgY2xvc2VEaWFsb2coKSB7XHJcbiAgICBpZiAodGhpcy53YXJuaW5nT25DbG9zZSB8fCB0aGlzLmRpcnR5KSB7XHJcbiAgICAgIHRoaXMub3Blbldhcm5pbmcgPSAhdGhpcy5vcGVuV2FybmluZztcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIHRoaXMub3BlbiA9IGZhbHNlO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogQ2xvc2VzIGFsbCBkaWFsb2dzLlxyXG4gICAqL1xyXG4gIGNsb3NlQWxsRGlhbG9ncygpIHtcclxuICAgIHRoaXMub3Blbldhcm5pbmcgPSBmYWxzZTtcclxuICAgIHRoaXMub3BlbiA9IGZhbHNlO1xyXG4gICAgdGhpcy5kaXJ0eSA9IGZhbHNlO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogT3BlbnMgYSB3YXJuaW5nIGRpYWxvZy5cclxuICAgKi9cclxuICBvcGVuV2FybmluZ0RpYWxvZygpIHtcclxuICAgIHRoaXMub3Blbldhcm5pbmcgPSB0cnVlO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogQ2xvc2VzIGEgd2FybmluZyBkaWFsb2cuXHJcbiAgICovXHJcbiAgY2xvc2VXYXJuaW5nRGlhbG9nKCkge1xyXG4gICAgdGhpcy5vcGVuV2FybmluZyA9IGZhbHNlO1xyXG4gIH1cclxuXHJcbiAgLyoqIEBoaWRkZW4gKi9cclxuICBASG9zdExpc3RlbmVyKCdrZXlkb3duJywgWyckZXZlbnQnXSlcclxuICBrZXlFdmVudChldmVudDogS2V5Ym9hcmRFdmVudCkge1xyXG4gICAgaWYgKGV2ZW50LmtleSA9PT0gJ0VzYycgfHwgZXZlbnQua2V5ID09PSAnRXNjYXBlJykge1xyXG4gICAgICAgIHRoaXMuY2xvc2VEaWFsb2coKTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIC8qKiBAaGlkZGVuICovXHJcbiAgQEhvc3RCaW5kaW5nKCdjbGFzcy5vcGVuZWQnKVxyXG4gIGdldCBvcGVuZWRDbG9zZWQoKSB7XHJcbiAgICByZXR1cm4gdGhpcy5fb3BlbjtcclxuICB9XHJcblxyXG4gIGNvbnN0cnVjdG9yKHByaXZhdGUgZm9jdXNUcmFwOiBDb25maWd1cmFibGVGb2N1c1RyYXBGYWN0b3J5KSB7fVxyXG5cclxuICAvKiogQGhpZGRlbiAqL1xyXG4gIG5nT25Jbml0KCkge1xyXG4gICAgaWYgKHRoaXMuY29tcGxleCAhPSBudWxsICYmIHRoaXMuY29tcGxleCAhPT0gZmFsc2UpIHtcclxuICAgICAgdGhpcy5jb21wbGV4ID0gdHJ1ZTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqXHJcbiAgICogIyMjIFN0eWxpbmdcclxuICAgKiBUaGUgZm9sbG93aW5nIGN1c3RvbSBwcm9wZXJ0aWVzIGFyZSBhdmFpbGFibGUgZm9yIHN0eWxpbmc6XHJcbiAgICpcclxuICAgKiBDdXN0b20gcHJvcGVydHkgICAgICAgICAgICAgICAgICAgICB8IERlc2NyaXB0aW9uICAgICAgICAgICAgICAgICAgICAgICB8IERlZmF1bHRcclxuICAgKiA6LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tfDotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLXw6LS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG4gICAqIGAtLWF2bC1kaWFsb2ctYmFja2dyb3VuZC1jb2xvcmAgICAgIHwgQmFja2dyb3VuZCBjb2xvciBvZiBkaWFsb2cgICAgICAgIHwgYC0tYXZsLWJhY2tncm91bmQtY29sb3JgXHJcbiAgICogYC0tYXZsLWRpYWxvZy10ZXh0LWNvbG9yYCAgICAgICAgICAgfCBDb2xvciBvZiB0ZXh0IGluIGNvbnRlbnQgICAgICAgICAgfCBgLS1hdmwtZW1waGFzaXMtbWVkaXVtLWNvbG9yYFxyXG4gICAqIGAtLWF2bC1kaWFsb2ctaGVhZGVyLXRpdGxlLWNvbG9yYCAgIHwgQ29sb3Igb2YgdGV4dCBpbiBoZWFkZXIgICAgICAgICAgIHwgYC0tYXZsLWZvcmVncm91bmQtY29sb3JgXHJcbiAgICogYC0tYXZsLWRpYWxvZy1jbG9zZS1pY29uLWNvbG9yYCAgICAgfCBDb2xvciBvZiBjbG9zZSBpY29uIGluIGhlYWRlciAgICAgfCBgLS1hdmwtaWNvbi1kZWZhdWx0LWNvbG9yYFxyXG4gICAqIGAtLWF2bC1kaWFsb2ctd2lkdGhgICAgICAgICAgICAgICAgIHwgRGlhbG9nIHdpZHRoICAgICAgICAgICAgICAgICAgICAgIHwgYDI4MCBweGBcclxuICAgKiBgLS1hdmwtZGlhbG9nLWhlaWdodGAgICAgICAgICAgICAgICB8IERpYWxvZyBoZWlnaHQgICAgICAgICAgICAgICAgICAgICB8IGAxMDAlIC0gOTZweGBcclxuICAgKiBgLS1hdmwtZGlhbG9nLXNlcGFyYXRvci1jb2xvcmAgICAgICB8IENvbG9yIG9mIHNlcGFyYXRvciBvZiBkaWFsb2cgcGFydHN8IGAtLWF2bC1kaXZpZGVyLWNvbG9yYFxyXG4gICAqIGAtLWF2bC1kaWFsb2ctY2xvc2UtaWNvbi1pbmstcHJlc3NlZC1jb2xvcmB8IENvbG9yIG9mIHByZXNzZWQgY2xvc2UgaWNvbiBpbiBoZWFkZXIgfCBgLS1hdmwtaW5rLWRlZmF1bHQtcHJlc3NlZC1jb2xvcmBcclxuICAgKiBgLS1hdmwtZGlhbG9nLWNsb3NlLWljb24taW5rLWZvY3VzLWNvbG9yYCAgfCBDb2xvciBvZiBmb2N1c2VkIGNsb3NlIGljb24gaW4gaGVhZGVyIHwgYC0tYXZsLWluay1kZWZhdWx0LWZvY3VzLWNvbG9yYFxyXG4gICAqIGAtLWF2bC1kaWFsb2ctY2xvc2UtaWNvbi1pbmstaG92ZXItY29sb3JgICB8IENvbG9yIG9mIGhvdmVyZWQgY2xvc2UgaWNvbiBpbiBoZWFkZXIgfCBgLS1hdmwtaW5rLWRlZmF1bHQtaG92ZXItY29sb3JgXHJcbiAgICpcclxuICAgKi9cclxuICBfc3R5bGluZzogYW55O1xyXG59XHJcbiJdfQ==