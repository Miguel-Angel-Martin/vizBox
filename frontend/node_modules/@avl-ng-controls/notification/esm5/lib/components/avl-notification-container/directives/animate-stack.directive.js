import * as ɵngcc0 from '@angular/core';
import * as ɵngcc1 from '@angular/animations';
var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};
var __metadata = (this && this.__metadata) || function (k, v) {
    if (typeof Reflect === "object" && typeof Reflect.metadata === "function") return Reflect.metadata(k, v);
};
import { Directive, ElementRef, Input, OnChanges, SimpleChanges } from '@angular/core';
import { animate, AnimationBuilder, AnimationMetadata, AnimationPlayer, AnimationStyleMetadata, style } from '@angular/animations';
import { ANIMATION_DURATION, MARGIN } from '../avl-notification-container.consts';
import { SnackbarMethodDescription } from './show-hide-snackbar.directive';
var AnimateStack = /** @class */ (function () {
    function AnimateStack(builder, el) {
        var _this = this;
        this.builder = builder;
        this.getAnimation = function (animationName, initialStyle) {
            var allStyle = style('*');
            switch (animationName) {
                case 2 /* ToBottom */: {
                    return [
                        allStyle,
                        animate(ANIMATION_DURATION + 'ms ease-in', style({
                            top: _this.styleTop + 'px',
                            zIndex: 0
                        }))
                    ];
                }
                case 1 /* ToTop */: {
                    return [allStyle, animate(ANIMATION_DURATION + 'ms ease-in', initialStyle)];
                }
                default:
                    return [initialStyle, animate('0ms', initialStyle)];
            }
        };
        this.element = el;
    }
    AnimateStack.prototype.ngOnChanges = function (changes) {
        var _a;
        if (changes.animateStack) {
            this.move(this.previousStackHeight);
        }
        else if (changes.previousStackHeight) {
            this.move(changes === null || changes === void 0 ? void 0 : changes.previousStackHeight.currentValue);
        }
        else if (changes.snackbarMethodDescription) {
            if (((_a = changes.snackbarMethodDescription.currentValue) === null || _a === void 0 ? void 0 : _a.method) === 'show') {
                this.move(this.previousStackHeight);
            }
        }
    };
    AnimateStack.prototype.show = function (metadata) {
        if (this.player) {
            this.player.destroy();
        }
        if (metadata) {
            var factory = this.builder.build(metadata);
            var player = factory.create(this.element.nativeElement);
            player.play();
        }
    };
    AnimateStack.prototype.move = function (height) {
        if (this.animateStack === 2 /* ToBottom */) {
            this.styleTop = height + MARGIN * 2;
        }
        var animationMetadata = this.animate();
        this.show(animationMetadata);
    };
    AnimateStack.prototype.animate = function () {
        var initialStyle = style({
            top: '0',
            width: '100%',
            left: '0',
            zIndex: 1
        });
        return this.getAnimation(this.animateStack, initialStyle);
    };
    AnimateStack.ctorParameters = function () { return [
        { type: AnimationBuilder },
        { type: ElementRef }
    ]; };
    __decorate([
        Input(),
        __metadata("design:type", Number)
    ], AnimateStack.prototype, "animateStack", void 0);
    __decorate([
        Input(),
        __metadata("design:type", Object)
    ], AnimateStack.prototype, "notification", void 0);
    __decorate([
        Input(),
        __metadata("design:type", Number)
    ], AnimateStack.prototype, "previousStackHeight", void 0);
    __decorate([
        Input(),
        __metadata("design:type", SnackbarMethodDescription)
    ], AnimateStack.prototype, "snackbarMethodDescription", void 0);
    __decorate([
        Input(),
        __metadata("design:type", Boolean)
    ], AnimateStack.prototype, "reopen", void 0);
    AnimateStack = __decorate([ __metadata("design:paramtypes", [AnimationBuilder, ElementRef])
    ], AnimateStack);
AnimateStack.ɵfac = function AnimateStack_Factory(t) { return new (t || AnimateStack)(ɵngcc0.ɵɵdirectiveInject(ɵngcc1.AnimationBuilder), ɵngcc0.ɵɵdirectiveInject(ɵngcc0.ElementRef)); };
AnimateStack.ɵdir = ɵngcc0.ɵɵdefineDirective({ type: AnimateStack, selectors: [["", "animateStack", ""]], inputs: { animateStack: "animateStack", notification: "notification", previousStackHeight: "previousStackHeight", snackbarMethodDescription: "snackbarMethodDescription", reopen: "reopen" }, features: [ɵngcc0.ɵɵNgOnChangesFeature] });
/*@__PURE__*/ (function () { ɵngcc0.ɵsetClassMetadata(AnimateStack, [{
        type: Directive,
        args: [{ selector: '[animateStack]' }]
    }], function () { return [{ type: ɵngcc1.AnimationBuilder }, { type: ɵngcc0.ElementRef }]; }, { animateStack: [{
            type: Input
        }], notification: [{
            type: Input
        }], previousStackHeight: [{
            type: Input
        }], snackbarMethodDescription: [{
            type: Input
        }], reopen: [{
            type: Input
        }] }); })();
    return AnimateStack;
}());
export { AnimateStack };
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiYW5pbWF0ZS1zdGFjay5kaXJlY3RpdmUuanMiLCJzb3VyY2VzIjpbIm5nOi9AYXZsLW5nLWNvbnRyb2xzL25vdGlmaWNhdGlvbi9saWIvY29tcG9uZW50cy9hdmwtbm90aWZpY2F0aW9uLWNvbnRhaW5lci9kaXJlY3RpdmVzL2FuaW1hdGUtc3RhY2suZGlyZWN0aXZlLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7O0FBQUEsT0FBTyxFQUFFLFNBQVMsRUFBRSxVQUFVLEVBQUUsS0FBSyxFQUFFLFNBQVMsRUFBRSxhQUFhLEVBQUUsTUFBTSxlQUFlLENBQUM7QUFDdkYsT0FBTyxFQUNMLE9BQU8sRUFDUCxnQkFBZ0IsRUFDaEIsaUJBQWlCLEVBQ2pCLGVBQWUsRUFDZixzQkFBc0IsRUFDdEIsS0FBSyxFQUNOLE1BQU0scUJBQXFCLENBQUM7QUFFN0IsT0FBTyxFQUFFLGtCQUFrQixFQUFFLE1BQU0sRUFBRSxNQUFNLHNDQUFzQyxDQUFDO0FBQ2xGLE9BQU8sRUFBRSx5QkFBeUIsRUFBRSxNQUFNLGdDQUFnQyxDQUFDO0FBVTNFO0FBQWdELElBb0I5QyxzQkFBcUIsT0FBeUIsRUFBRSxFQUFjO0FBQ2hFLFFBREUsaUJBRUM7QUFDSCxRQUh1QixZQUFPLEdBQVAsT0FBTyxDQUFrQjtBQUFDLFFBMkN2QyxpQkFBWSxHQUFHLFVBQ3JCLGFBQWdDLEVBQ2hDLFlBQW9DO0FBQ3JDLFlBQ0MsSUFBTSxRQUFRLEdBQUcsS0FBSyxDQUFDLEdBQUcsQ0FBQyxDQUFDO0FBQ2hDLFlBQ0ksUUFBUSxhQUFhLEVBQUU7QUFDM0IsZ0JBQU0scUJBQStCLENBQUMsQ0FBQztBQUN2QyxvQkFBUSxPQUFPO0FBQ2Ysd0JBQVUsUUFBUTtBQUNsQix3QkFBVSxPQUFPLENBQ0wsa0JBQWtCLEdBQUcsWUFBWSxFQUNqQyxLQUFLLENBQUM7QUFDbEIsNEJBQWMsR0FBRyxFQUFFLEtBQUksQ0FBQyxRQUFRLEdBQUcsSUFBSTtBQUN2Qyw0QkFBYyxNQUFNLEVBQUUsQ0FBQztB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QUFBQSxBQUNBLEFBQUEsQUFBQSxBQUNBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFDQSxBQUFBLEFBQUEsQUFBQSxBQUNBLEFBQUEsQUFDQSxBQUNBLEFBQUEsQUFDQSxBQUNBLEFBQUEsQUFBQSxBQUFBLEFBQ0EsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQ0EsQUFDQSxBQUNBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQ0EsQUFDQSxBQUFBLEFBQUEsQUFuRUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFDQSxBQUFBLEFBRUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUNBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUNBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQ0EsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFDQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUNBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQ0EsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFDQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUNBLEFBQ0EsQUFDQSxBQUFBLEFBRUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUNBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUNBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFDQSxBQUNBLEFBQUEsQUFBQSxBQUFBLEFBQ0EsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFDQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFDQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFDQSxBQUNBLEFBQUEsQUFDQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQ0EsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFDQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQ0EsQUFDQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFDQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQ0EsQUFBQSxBQUNBLEFBQUEsQUFBQSxBQUNBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUNBLEFBQUEsQUFBQSxBQUFBLEFBQ0EsQUFBQSxBQUFBLEFBQUEsQUFDQSxBQUFBLEFBQUEsQUFBQSxBQUNBLEFBQUEsQUFBQSxBQUFBLEFBQ0EsQUFBQSxBQUFBLEFBQ0EsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFDQSxBQUFBLEFBekNBLEFBQUEsQUFBQSxBQUFBLEFBbEJBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFHQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBR0EsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUdBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBR0EsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQWRBLEFBQUEsQUFEQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFxQkEsQUFBQSxBQUFBLEFBQUEsQUFwQkEsQUFBQSxBQXlGQSxBQUFBLEFBQUEsQUFBQSxBQXpGQSxBQXlGQSxBQXpGQSxBQUFBIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgRGlyZWN0aXZlLCBFbGVtZW50UmVmLCBJbnB1dCwgT25DaGFuZ2VzLCBTaW1wbGVDaGFuZ2VzIH0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XHJcbmltcG9ydCB7XHJcbiAgYW5pbWF0ZSxcclxuICBBbmltYXRpb25CdWlsZGVyLFxyXG4gIEFuaW1hdGlvbk1ldGFkYXRhLFxyXG4gIEFuaW1hdGlvblBsYXllcixcclxuICBBbmltYXRpb25TdHlsZU1ldGFkYXRhLFxyXG4gIHN0eWxlXHJcbn0gZnJvbSAnQGFuZ3VsYXIvYW5pbWF0aW9ucyc7XHJcbmltcG9ydCB7IEF2bE5vdGlmaWNhdGlvbiB9IGZyb20gJ0BhdmwtY29udHJvbHMvaW50ZXJmYWNlcyc7XHJcbmltcG9ydCB7IEFOSU1BVElPTl9EVVJBVElPTiwgTUFSR0lOIH0gZnJvbSAnLi4vYXZsLW5vdGlmaWNhdGlvbi1jb250YWluZXIuY29uc3RzJztcclxuaW1wb3J0IHsgU25hY2tiYXJNZXRob2REZXNjcmlwdGlvbiB9IGZyb20gJy4vc2hvdy1oaWRlLXNuYWNrYmFyLmRpcmVjdGl2ZSc7XHJcbi8qKiBAaGlkZGVuICovXHJcbmV4cG9ydCBjb25zdCBlbnVtIFBvc2l0aW9uQW5pbWF0aW9uIHtcclxuICBUb0xvd2VyU3RhY2ssXHJcbiAgVG9Ub3AsXHJcbiAgVG9Cb3R0b20sXHJcbiAgVG9TdGFjayxcclxuICBGcm9tU3RhY2tcclxufVxyXG5ARGlyZWN0aXZlKHsgc2VsZWN0b3I6ICdbYW5pbWF0ZVN0YWNrXScgfSlcclxuZXhwb3J0IGNsYXNzIEFuaW1hdGVTdGFjayBpbXBsZW1lbnRzIE9uQ2hhbmdlcyB7XHJcbiAgLyoqIEBoaWRkZW4gKi9cclxuICBASW5wdXQoKSByZWFkb25seSBhbmltYXRlU3RhY2s6IFBvc2l0aW9uQW5pbWF0aW9uO1xyXG5cclxuICAvKiogQGhpZGRlbiAqL1xyXG4gIEBJbnB1dCgpIHJlYWRvbmx5IG5vdGlmaWNhdGlvbjogQXZsTm90aWZpY2F0aW9uO1xyXG5cclxuICAvKiogQGhpZGRlbiAqL1xyXG4gIEBJbnB1dCgpIHJlYWRvbmx5IHByZXZpb3VzU3RhY2tIZWlnaHQ6IG51bWJlcjtcclxuXHJcbiAgLyoqIEBoaWRkZW4gKi9cclxuICBASW5wdXQoKSByZWFkb25seSBzbmFja2Jhck1ldGhvZERlc2NyaXB0aW9uOiBTbmFja2Jhck1ldGhvZERlc2NyaXB0aW9uO1xyXG5cclxuICAvKiogQGhpZGRlbiAqL1xyXG4gIEBJbnB1dCgpIHJlYWRvbmx5IHJlb3BlbjogYm9vbGVhbjtcclxuXHJcbiAgcHJpdmF0ZSBzdHlsZVRvcDogbnVtYmVyO1xyXG4gIHByaXZhdGUgZWxlbWVudDogRWxlbWVudFJlZjtcclxuICBwcml2YXRlIHBsYXllcjogQW5pbWF0aW9uUGxheWVyO1xyXG5cclxuICBjb25zdHJ1Y3RvcihyZWFkb25seSBidWlsZGVyOiBBbmltYXRpb25CdWlsZGVyLCBlbDogRWxlbWVudFJlZikge1xyXG4gICAgdGhpcy5lbGVtZW50ID0gZWw7XHJcbiAgfVxyXG5cclxuICBuZ09uQ2hhbmdlcyhjaGFuZ2VzOiBTaW1wbGVDaGFuZ2VzKTogdm9pZCB7XHJcbiAgICBpZiAoY2hhbmdlcy5hbmltYXRlU3RhY2spIHtcclxuICAgICAgdGhpcy5tb3ZlKHRoaXMucHJldmlvdXNTdGFja0hlaWdodCk7XHJcbiAgICB9IGVsc2UgaWYgKGNoYW5nZXMucHJldmlvdXNTdGFja0hlaWdodCkge1xyXG4gICAgICB0aGlzLm1vdmUoY2hhbmdlcz8ucHJldmlvdXNTdGFja0hlaWdodC5jdXJyZW50VmFsdWUpO1xyXG4gICAgfSBlbHNlIGlmIChjaGFuZ2VzLnNuYWNrYmFyTWV0aG9kRGVzY3JpcHRpb24pIHtcclxuICAgICAgaWYgKGNoYW5nZXMuc25hY2tiYXJNZXRob2REZXNjcmlwdGlvbi5jdXJyZW50VmFsdWU/Lm1ldGhvZCA9PT0gJ3Nob3cnKSB7XHJcbiAgICAgICAgdGhpcy5tb3ZlKHRoaXMucHJldmlvdXNTdGFja0hlaWdodCk7XHJcbiAgICAgIH1cclxuICAgIH1cclxuICB9XHJcblxyXG4gIHByaXZhdGUgc2hvdyhtZXRhZGF0YTogQW5pbWF0aW9uTWV0YWRhdGFbXSkge1xyXG4gICAgaWYgKHRoaXMucGxheWVyKSB7XHJcbiAgICAgIHRoaXMucGxheWVyLmRlc3Ryb3koKTtcclxuICAgIH1cclxuICAgIGlmIChtZXRhZGF0YSkge1xyXG4gICAgICBjb25zdCBmYWN0b3J5ID0gdGhpcy5idWlsZGVyLmJ1aWxkKG1ldGFkYXRhKTtcclxuICAgICAgY29uc3QgcGxheWVyID0gZmFjdG9yeS5jcmVhdGUodGhpcy5lbGVtZW50Lm5hdGl2ZUVsZW1lbnQpO1xyXG4gICAgICBwbGF5ZXIucGxheSgpO1xyXG4gICAgfVxyXG4gIH1cclxuICBwcml2YXRlIG1vdmUoaGVpZ2h0OiBudW1iZXIpIHtcclxuICAgIGlmICh0aGlzLmFuaW1hdGVTdGFjayA9PT0gUG9zaXRpb25BbmltYXRpb24uVG9Cb3R0b20pIHtcclxuICAgICAgdGhpcy5zdHlsZVRvcCA9IGhlaWdodCArIE1BUkdJTiAqIDI7XHJcbiAgICB9XHJcbiAgICBjb25zdCBhbmltYXRpb25NZXRhZGF0YTogQW5pbWF0aW9uTWV0YWRhdGFbXSA9IHRoaXMuYW5pbWF0ZSgpO1xyXG4gICAgdGhpcy5zaG93KGFuaW1hdGlvbk1ldGFkYXRhKTtcclxuICB9XHJcbiAgcHJpdmF0ZSBhbmltYXRlKCk6IEFuaW1hdGlvbk1ldGFkYXRhW10ge1xyXG4gICAgY29uc3QgaW5pdGlhbFN0eWxlID0gc3R5bGUoe1xyXG4gICAgICB0b3A6ICcwJyxcclxuICAgICAgd2lkdGg6ICcxMDAlJyxcclxuICAgICAgbGVmdDogJzAnLFxyXG4gICAgICB6SW5kZXg6IDFcclxuICAgIH0pO1xyXG4gICAgcmV0dXJuIHRoaXMuZ2V0QW5pbWF0aW9uKHRoaXMuYW5pbWF0ZVN0YWNrLCBpbml0aWFsU3R5bGUpO1xyXG4gIH1cclxuXHJcbiAgcHJpdmF0ZSBnZXRBbmltYXRpb24gPSAoXHJcbiAgICBhbmltYXRpb25OYW1lOiBQb3NpdGlvbkFuaW1hdGlvbixcclxuICAgIGluaXRpYWxTdHlsZTogQW5pbWF0aW9uU3R5bGVNZXRhZGF0YVxyXG4gICk6IEFuaW1hdGlvbk1ldGFkYXRhW10gPT4ge1xyXG4gICAgY29uc3QgYWxsU3R5bGUgPSBzdHlsZSgnKicpO1xyXG5cclxuICAgIHN3aXRjaCAoYW5pbWF0aW9uTmFtZSkge1xyXG4gICAgICBjYXNlIFBvc2l0aW9uQW5pbWF0aW9uLlRvQm90dG9tOiB7XHJcbiAgICAgICAgcmV0dXJuIFtcclxuICAgICAgICAgIGFsbFN0eWxlLFxyXG4gICAgICAgICAgYW5pbWF0ZShcclxuICAgICAgICAgICAgQU5JTUFUSU9OX0RVUkFUSU9OICsgJ21zIGVhc2UtaW4nLFxyXG4gICAgICAgICAgICBzdHlsZSh7XHJcbiAgICAgICAgICAgICAgdG9wOiB0aGlzLnN0eWxlVG9wICsgJ3B4JyxcclxuICAgICAgICAgICAgICB6SW5kZXg6IDBcclxuICAgICAgICAgICAgfSlcclxuICAgICAgICAgIClcclxuICAgICAgICBdO1xyXG4gICAgICB9XHJcbiAgICAgIGNhc2UgUG9zaXRpb25BbmltYXRpb24uVG9Ub3A6IHtcclxuICAgICAgICByZXR1cm4gW2FsbFN0eWxlLCBhbmltYXRlKEFOSU1BVElPTl9EVVJBVElPTiArICdtcyBlYXNlLWluJywgaW5pdGlhbFN0eWxlKV07XHJcbiAgICAgIH1cclxuICAgICAgZGVmYXVsdDpcclxuICAgICAgICByZXR1cm4gW2luaXRpYWxTdHlsZSwgYW5pbWF0ZSgnMG1zJywgaW5pdGlhbFN0eWxlKV07XHJcbiAgICB9XHJcbiAgfTtcclxufVxyXG4iXX0=