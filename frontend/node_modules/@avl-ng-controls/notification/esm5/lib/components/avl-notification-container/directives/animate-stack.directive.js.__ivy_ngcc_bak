var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};
var __metadata = (this && this.__metadata) || function (k, v) {
    if (typeof Reflect === "object" && typeof Reflect.metadata === "function") return Reflect.metadata(k, v);
};
import { Directive, ElementRef, Input, OnChanges, SimpleChanges } from '@angular/core';
import { animate, AnimationBuilder, AnimationMetadata, AnimationPlayer, AnimationStyleMetadata, style } from '@angular/animations';
import { ANIMATION_DURATION, MARGIN } from '../avl-notification-container.consts';
import { SnackbarMethodDescription } from './show-hide-snackbar.directive';
var AnimateStack = /** @class */ (function () {
    function AnimateStack(builder, el) {
        var _this = this;
        this.builder = builder;
        this.getAnimation = function (animationName, initialStyle) {
            var allStyle = style('*');
            switch (animationName) {
                case 2 /* ToBottom */: {
                    return [
                        allStyle,
                        animate(ANIMATION_DURATION + 'ms ease-in', style({
                            top: _this.styleTop + 'px',
                            zIndex: 0
                        }))
                    ];
                }
                case 1 /* ToTop */: {
                    return [allStyle, animate(ANIMATION_DURATION + 'ms ease-in', initialStyle)];
                }
                default:
                    return [initialStyle, animate('0ms', initialStyle)];
            }
        };
        this.element = el;
    }
    AnimateStack.prototype.ngOnChanges = function (changes) {
        var _a;
        if (changes.animateStack) {
            this.move(this.previousStackHeight);
        }
        else if (changes.previousStackHeight) {
            this.move(changes === null || changes === void 0 ? void 0 : changes.previousStackHeight.currentValue);
        }
        else if (changes.snackbarMethodDescription) {
            if (((_a = changes.snackbarMethodDescription.currentValue) === null || _a === void 0 ? void 0 : _a.method) === 'show') {
                this.move(this.previousStackHeight);
            }
        }
    };
    AnimateStack.prototype.show = function (metadata) {
        if (this.player) {
            this.player.destroy();
        }
        if (metadata) {
            var factory = this.builder.build(metadata);
            var player = factory.create(this.element.nativeElement);
            player.play();
        }
    };
    AnimateStack.prototype.move = function (height) {
        if (this.animateStack === 2 /* ToBottom */) {
            this.styleTop = height + MARGIN * 2;
        }
        var animationMetadata = this.animate();
        this.show(animationMetadata);
    };
    AnimateStack.prototype.animate = function () {
        var initialStyle = style({
            top: '0',
            width: '100%',
            left: '0',
            zIndex: 1
        });
        return this.getAnimation(this.animateStack, initialStyle);
    };
    AnimateStack.ctorParameters = function () { return [
        { type: AnimationBuilder },
        { type: ElementRef }
    ]; };
    __decorate([
        Input(),
        __metadata("design:type", Number)
    ], AnimateStack.prototype, "animateStack", void 0);
    __decorate([
        Input(),
        __metadata("design:type", Object)
    ], AnimateStack.prototype, "notification", void 0);
    __decorate([
        Input(),
        __metadata("design:type", Number)
    ], AnimateStack.prototype, "previousStackHeight", void 0);
    __decorate([
        Input(),
        __metadata("design:type", SnackbarMethodDescription)
    ], AnimateStack.prototype, "snackbarMethodDescription", void 0);
    __decorate([
        Input(),
        __metadata("design:type", Boolean)
    ], AnimateStack.prototype, "reopen", void 0);
    AnimateStack = __decorate([
        Directive({ selector: '[animateStack]' }),
        __metadata("design:paramtypes", [AnimationBuilder, ElementRef])
    ], AnimateStack);
    return AnimateStack;
}());
export { AnimateStack };
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiYW5pbWF0ZS1zdGFjay5kaXJlY3RpdmUuanMiLCJzb3VyY2VSb290Ijoibmc6Ly9AYXZsLW5nLWNvbnRyb2xzL25vdGlmaWNhdGlvbi8iLCJzb3VyY2VzIjpbImxpYi9jb21wb25lbnRzL2F2bC1ub3RpZmljYXRpb24tY29udGFpbmVyL2RpcmVjdGl2ZXMvYW5pbWF0ZS1zdGFjay5kaXJlY3RpdmUudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7O0FBQUEsT0FBTyxFQUFFLFNBQVMsRUFBRSxVQUFVLEVBQUUsS0FBSyxFQUFFLFNBQVMsRUFBRSxhQUFhLEVBQUUsTUFBTSxlQUFlLENBQUM7QUFDdkYsT0FBTyxFQUNMLE9BQU8sRUFDUCxnQkFBZ0IsRUFDaEIsaUJBQWlCLEVBQ2pCLGVBQWUsRUFDZixzQkFBc0IsRUFDdEIsS0FBSyxFQUNOLE1BQU0scUJBQXFCLENBQUM7QUFFN0IsT0FBTyxFQUFFLGtCQUFrQixFQUFFLE1BQU0sRUFBRSxNQUFNLHNDQUFzQyxDQUFDO0FBQ2xGLE9BQU8sRUFBRSx5QkFBeUIsRUFBRSxNQUFNLGdDQUFnQyxDQUFDO0FBVTNFO0lBb0JFLHNCQUFxQixPQUF5QixFQUFFLEVBQWM7UUFBOUQsaUJBRUM7UUFGb0IsWUFBTyxHQUFQLE9BQU8sQ0FBa0I7UUEyQ3RDLGlCQUFZLEdBQUcsVUFDckIsYUFBZ0MsRUFDaEMsWUFBb0M7WUFFcEMsSUFBTSxRQUFRLEdBQUcsS0FBSyxDQUFDLEdBQUcsQ0FBQyxDQUFDO1lBRTVCLFFBQVEsYUFBYSxFQUFFO2dCQUNyQixxQkFBK0IsQ0FBQyxDQUFDO29CQUMvQixPQUFPO3dCQUNMLFFBQVE7d0JBQ1IsT0FBTyxDQUNMLGtCQUFrQixHQUFHLFlBQVksRUFDakMsS0FBSyxDQUFDOzRCQUNKLEdBQUcsRUFBRSxLQUFJLENBQUMsUUFBUSxHQUFHLElBQUk7NEJBQ3pCLE1BQU0sRUFBRSxDQUFDO3lCQUNWLENBQUMsQ0FDSDtxQkFDRixDQUFDO2lCQUNIO2dCQUNELGtCQUE0QixDQUFD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LCBTaW1wbGVDaGFuZ2VzIH0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XHJcbmltcG9ydCB7XHJcbiAgYW5pbWF0ZSxcclxuICBBbmltYXRpb25CdWlsZGVyLFxyXG4gIEFuaW1hdGlvbk1ldGFkYXRhLFxyXG4gIEFuaW1hdGlvblBsYXllcixcclxuICBBbmltYXRpb25TdHlsZU1ldGFkYXRhLFxyXG4gIHN0eWxlXHJcbn0gZnJvbSAnQGFuZ3VsYXIvYW5pbWF0aW9ucyc7XHJcbmltcG9ydCB7IEF2bE5vdGlmaWNhdGlvbiB9IGZyb20gJ0BhdmwtY29udHJvbHMvaW50ZXJmYWNlcyc7XHJcbmltcG9ydCB7IEFOSU1BVElPTl9EVVJBVElPTiwgTUFSR0lOIH0gZnJvbSAnLi4vYXZsLW5vdGlmaWNhdGlvbi1jb250YWluZXIuY29uc3RzJztcclxuaW1wb3J0IHsgU25hY2tiYXJNZXRob2REZXNjcmlwdGlvbiB9IGZyb20gJy4vc2hvdy1oaWRlLXNuYWNrYmFyLmRpcmVjdGl2ZSc7XHJcbi8qKiBAaGlkZGVuICovXHJcbmV4cG9ydCBjb25zdCBlbnVtIFBvc2l0aW9uQW5pbWF0aW9uIHtcclxuICBUb0xvd2VyU3RhY2ssXHJcbiAgVG9Ub3AsXHJcbiAgVG9Cb3R0b20sXHJcbiAgVG9TdGFjayxcclxuICBGcm9tU3RhY2tcclxufVxyXG5ARGlyZWN0aXZlKHsgc2VsZWN0b3I6ICdbYW5pbWF0ZVN0YWNrXScgfSlcclxuZXhwb3J0IGNsYXNzIEFuaW1hdGVTdGFjayBpbXBsZW1lbnRzIE9uQ2hhbmdlcyB7XHJcbiAgLyoqIEBoaWRkZW4gKi9cclxuICBASW5wdXQoKSByZWFkb25seSBhbmltYXRlU3RhY2s6IFBvc2l0aW9uQW5pbWF0aW9uO1xyXG5cclxuICAvKiogQGhpZGRlbiAqL1xyXG4gIEBJbnB1dCgpIHJlYWRvbmx5IG5vdGlmaWNhdGlvbjogQXZsTm90aWZpY2F0aW9uO1xyXG5cclxuICAvKiogQGhpZGRlbiAqL1xyXG4gIEBJbnB1dCgpIHJlYWRvbmx5IHByZXZpb3VzU3RhY2tIZWlnaHQ6IG51bWJlcjtcclxuXHJcbiAgLyoqIEBoaWRkZW4gKi9cclxuICBASW5wdXQoKSByZWFkb25seSBzbmFja2Jhck1ldGhvZERlc2NyaXB0aW9uOiBTbmFja2Jhck1ldGhvZERlc2NyaXB0aW9uO1xyXG5cclxuICAvKiogQGhpZGRlbiAqL1xyXG4gIEBJbnB1dCgpIHJlYWRvbmx5IHJlb3BlbjogYm9vbGVhbjtcclxuXHJcbiAgcHJpdmF0ZSBzdHlsZVRvcDogbnVtYmVyO1xyXG4gIHByaXZhdGUgZWxlbWVudDogRWxlbWVudFJlZjtcclxuICBwcml2YXRlIHBsYXllcjogQW5pbWF0aW9uUGxheWVyO1xyXG5cclxuICBjb25zdHJ1Y3RvcihyZWFkb25seSBidWlsZGVyOiBBbmltYXRpb25CdWlsZGVyLCBlbDogRWxlbWVudFJlZikge1xyXG4gICAgdGhpcy5lbGVtZW50ID0gZWw7XHJcbiAgfVxyXG5cclxuICBuZ09uQ2hhbmdlcyhjaGFuZ2VzOiBTaW1wbGVDaGFuZ2VzKTogdm9pZCB7XHJcbiAgICBpZiAoY2hhbmdlcy5hbmltYXRlU3RhY2spIHtcclxuICAgICAgdGhpcy5tb3ZlKHRoaXMucHJldmlvdXNTdGFja0hlaWdodCk7XHJcbiAgICB9IGVsc2UgaWYgKGNoYW5nZXMucHJldmlvdXNTdGFja0hlaWdodCkge1xyXG4gICAgICB0aGlzLm1vdmUoY2hhbmdlcz8ucHJldmlvdXNTdGFja0hlaWdodC5jdXJyZW50VmFsdWUpO1xyXG4gICAgfSBlbHNlIGlmIChjaGFuZ2VzLnNuYWNrYmFyTWV0aG9kRGVzY3JpcHRpb24pIHtcclxuICAgICAgaWYgKGNoYW5nZXMuc25hY2tiYXJNZXRob2REZXNjcmlwdGlvbi5jdXJyZW50VmFsdWU/Lm1ldGhvZCA9PT0gJ3Nob3cnKSB7XHJcbiAgICAgICAgdGhpcy5tb3ZlKHRoaXMucHJldmlvdXNTdGFja0hlaWdodCk7XHJcbiAgICAgIH1cclxuICAgIH1cclxuICB9XHJcblxyXG4gIHByaXZhdGUgc2hvdyhtZXRhZGF0YTogQW5pbWF0aW9uTWV0YWRhdGFbXSkge1xyXG4gICAgaWYgKHRoaXMucGxheWVyKSB7XHJcbiAgICAgIHRoaXMucGxheWVyLmRlc3Ryb3koKTtcclxuICAgIH1cclxuICAgIGlmIChtZXRhZGF0YSkge1xyXG4gICAgICBjb25zdCBmYWN0b3J5ID0gdGhpcy5idWlsZGVyLmJ1aWxkKG1ldGFkYXRhKTtcclxuICAgICAgY29uc3QgcGxheWVyID0gZmFjdG9yeS5jcmVhdGUodGhpcy5lbGVtZW50Lm5hdGl2ZUVsZW1lbnQpO1xyXG4gICAgICBwbGF5ZXIucGxheSgpO1xyXG4gICAgfVxyXG4gIH1cclxuICBwcml2YXRlIG1vdmUoaGVpZ2h0OiBudW1iZXIpIHtcclxuICAgIGlmICh0aGlzLmFuaW1hdGVTdGFjayA9PT0gUG9zaXRpb25BbmltYXRpb24uVG9Cb3R0b20pIHtcclxuICAgICAgdGhpcy5zdHlsZVRvcCA9IGhlaWdodCArIE1BUkdJTiAqIDI7XHJcbiAgICB9XHJcbiAgICBjb25zdCBhbmltYXRpb25NZXRhZGF0YTogQW5pbWF0aW9uTWV0YWRhdGFbXSA9IHRoaXMuYW5pbWF0ZSgpO1xyXG4gICAgdGhpcy5zaG93KGFuaW1hdGlvbk1ldGFkYXRhKTtcclxuICB9XHJcbiAgcHJpdmF0ZSBhbmltYXRlKCk6IEFuaW1hdGlvbk1ldGFkYXRhW10ge1xyXG4gICAgY29uc3QgaW5pdGlhbFN0eWxlID0gc3R5bGUoe1xyXG4gICAgICB0b3A6ICcwJyxcclxuICAgICAgd2lkdGg6ICcxMDAlJyxcclxuICAgICAgbGVmdDogJzAnLFxyXG4gICAgICB6SW5kZXg6IDFcclxuICAgIH0pO1xyXG4gICAgcmV0dXJuIHRoaXMuZ2V0QW5pbWF0aW9uKHRoaXMuYW5pbWF0ZVN0YWNrLCBpbml0aWFsU3R5bGUpO1xyXG4gIH1cclxuXHJcbiAgcHJpdmF0ZSBnZXRBbmltYXRpb24gPSAoXHJcbiAgICBhbmltYXRpb25OYW1lOiBQb3NpdGlvbkFuaW1hdGlvbixcclxuICAgIGluaXRpYWxTdHlsZTogQW5pbWF0aW9uU3R5bGVNZXRhZGF0YVxyXG4gICk6IEFuaW1hdGlvbk1ldGFkYXRhW10gPT4ge1xyXG4gICAgY29uc3QgYWxsU3R5bGUgPSBzdHlsZSgnKicpO1xyXG5cclxuICAgIHN3aXRjaCAoYW5pbWF0aW9uTmFtZSkge1xyXG4gICAgICBjYXNlIFBvc2l0aW9uQW5pbWF0aW9uLlRvQm90dG9tOiB7XHJcbiAgICAgICAgcmV0dXJuIFtcclxuICAgICAgICAgIGFsbFN0eWxlLFxyXG4gICAgICAgICAgYW5pbWF0ZShcclxuICAgICAgICAgICAgQU5JTUFUSU9OX0RVUkFUSU9OICsgJ21zIGVhc2UtaW4nLFxyXG4gICAgICAgICAgICBzdHlsZSh7XHJcbiAgICAgICAgICAgICAgdG9wOiB0aGlzLnN0eWxlVG9wICsgJ3B4JyxcclxuICAgICAgICAgICAgICB6SW5kZXg6IDBcclxuICAgICAgICAgICAgfSlcclxuICAgICAgICAgIClcclxuICAgICAgICBdO1xyXG4gICAgICB9XHJcbiAgICAgIGNhc2UgUG9zaXRpb25BbmltYXRpb24uVG9Ub3A6IHtcclxuICAgICAgICByZXR1cm4gW2FsbFN0eWxlLCBhbmltYXRlKEFOSU1BVElPTl9EVVJBVElPTiArICdtcyBlYXNlLWluJywgaW5pdGlhbFN0eWxlKV07XHJcbiAgICAgIH1cclxuICAgICAgZGVmYXVsdDpcclxuICAgICAgICByZXR1cm4gW2luaXRpYWxTdHlsZSwgYW5pbWF0ZSgnMG1zJywgaW5pdGlhbFN0eWxlKV07XHJcbiAgICB9XHJcbiAgfTtcclxufVxyXG4iXX0=