import * as ɵngcc0 from '@angular/core';
import * as ɵngcc1 from '@angular/animations';
var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};
var __metadata = (this && this.__metadata) || function (k, v) {
    if (typeof Reflect === "object" && typeof Reflect.metadata === "function") return Reflect.metadata(k, v);
};
import { Directive, ElementRef, Input, OnChanges, SimpleChanges } from '@angular/core';
import { animate, AnimationBuilder, AnimationMetadata, AnimationPlayer, AnimationStyleMetadata, style } from '@angular/animations';
import { ANIMATION_DURATION, MARGIN } from '../avl-notification-container.consts';
import { SnackbarMethodDescription } from './show-hide-snackbar.directive';
let AnimateStack = class AnimateStack {
    constructor(builder, el) {
        this.builder = builder;
        this.getAnimation = (animationName, initialStyle) => {
            const allStyle = style('*');
            switch (animationName) {
                case 2 /* ToBottom */: {
                    return [
                        allStyle,
                        animate(ANIMATION_DURATION + 'ms ease-in', style({
                            top: this.styleTop + 'px',
                            zIndex: 0
                        }))
                    ];
                }
                case 1 /* ToTop */: {
                    return [allStyle, animate(ANIMATION_DURATION + 'ms ease-in', initialStyle)];
                }
                default:
                    return [initialStyle, animate('0ms', initialStyle)];
            }
        };
        this.element = el;
    }
    ngOnChanges(changes) {
        var _a;
        if (changes.animateStack) {
            this.move(this.previousStackHeight);
        }
        else if (changes.previousStackHeight) {
            this.move(changes === null || changes === void 0 ? void 0 : changes.previousStackHeight.currentValue);
        }
        else if (changes.snackbarMethodDescription) {
            if (((_a = changes.snackbarMethodDescription.currentValue) === null || _a === void 0 ? void 0 : _a.method) === 'show') {
                this.move(this.previousStackHeight);
            }
        }
    }
    show(metadata) {
        if (this.player) {
            this.player.destroy();
        }
        if (metadata) {
            const factory = this.builder.build(metadata);
            const player = factory.create(this.element.nativeElement);
            player.play();
        }
    }
    move(height) {
        if (this.animateStack === 2 /* ToBottom */) {
            this.styleTop = height + MARGIN * 2;
        }
        const animationMetadata = this.animate();
        this.show(animationMetadata);
    }
    animate() {
        const initialStyle = style({
            top: '0',
            width: '100%',
            left: '0',
            zIndex: 1
        });
        return this.getAnimation(this.animateStack, initialStyle);
    }
};
AnimateStack.ɵfac = function AnimateStack_Factory(t) { return new (t || AnimateStack)(ɵngcc0.ɵɵdirectiveInject(ɵngcc1.AnimationBuilder), ɵngcc0.ɵɵdirectiveInject(ɵngcc0.ElementRef)); };
AnimateStack.ɵdir = ɵngcc0.ɵɵdefineDirective({ type: AnimateStack, selectors: [["", "animateStack", ""]], inputs: { animateStack: "animateStack", notification: "notification", previousStackHeight: "previousStackHeight", snackbarMethodDescription: "snackbarMethodDescription", reopen: "reopen" }, features: [ɵngcc0.ɵɵNgOnChangesFeature] });
AnimateStack.ctorParameters = () => [
    { type: AnimationBuilder },
    { type: ElementRef }
];
__decorate([
    Input(),
    __metadata("design:type", Number)
], AnimateStack.prototype, "animateStack", void 0);
__decorate([
    Input(),
    __metadata("design:type", Object)
], AnimateStack.prototype, "notification", void 0);
__decorate([
    Input(),
    __metadata("design:type", Number)
], AnimateStack.prototype, "previousStackHeight", void 0);
__decorate([
    Input(),
    __metadata("design:type", SnackbarMethodDescription)
], AnimateStack.prototype, "snackbarMethodDescription", void 0);
__decorate([
    Input(),
    __metadata("design:type", Boolean)
], AnimateStack.prototype, "reopen", void 0);
AnimateStack = __decorate([ __metadata("design:paramtypes", [AnimationBuilder, ElementRef])
], AnimateStack);
/*@__PURE__*/ (function () { ɵngcc0.ɵsetClassMetadata(AnimateStack, [{
        type: Directive,
        args: [{ selector: '[animateStack]' }]
    }], function () { return [{ type: ɵngcc1.AnimationBuilder }, { type: ɵngcc0.ElementRef }]; }, { animateStack: [{
            type: Input
        }], notification: [{
            type: Input
        }], previousStackHeight: [{
            type: Input
        }], snackbarMethodDescription: [{
            type: Input
        }], reopen: [{
            type: Input
        }] }); })();
export { AnimateStack };
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiYW5pbWF0ZS1zdGFjay5kaXJlY3RpdmUuanMiLCJzb3VyY2VzIjpbIm5nOi9AYXZsLW5nLWNvbnRyb2xzL25vdGlmaWNhdGlvbi9saWIvY29tcG9uZW50cy9hdmwtbm90aWZpY2F0aW9uLWNvbnRhaW5lci9kaXJlY3RpdmVzL2FuaW1hdGUtc3RhY2suZGlyZWN0aXZlLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7O0FBQUEsT0FBTyxFQUFFLFNBQVMsRUFBRSxVQUFVLEVBQUUsS0FBSyxFQUFFLFNBQVMsRUFBRSxhQUFhLEVBQUUsTUFBTSxlQUFlLENBQUM7QUFDdkYsT0FBTyxFQUNMLE9BQU8sRUFDUCxnQkFBZ0IsRUFDaEIsaUJBQWlCLEVBQ2pCLGVBQWUsRUFDZixzQkFBc0IsRUFDdEIsS0FBSyxFQUNOLE1BQU0scUJBQXFCLENBQUM7QUFFN0IsT0FBTyxFQUFFLGtCQUFrQixFQUFFLE1BQU0sRUFBRSxNQUFNLHNDQUFzQyxDQUFDO0FBQ2xGLE9BQU8sRUFBRSx5QkFBeUIsRUFBRSxNQUFNLGdDQUFnQyxDQUFDO0FBVTNFLElBQWEsWUFBWSxHQUF6QixNQUFhLFlBQVk7QUFBRyxJQW9CMUIsWUFBcUIsT0FBeUIsRUFBRSxFQUFjO0FBQ2hFLFFBRHVCLFlBQU8sR0FBUCxPQUFPLENBQWtCO0FBQUMsUUEyQ3ZDLGlCQUFZLEdBQUcsQ0FDckIsYUFBZ0MsRUFDaEMsWUFBb0MsRUFDZixFQUFFO0FBQzNCLFlBQUksTUFBTSxRQUFRLEdBQUcsS0FBSyxDQUFDLEdBQUcsQ0FBQyxDQUFDO0FBQ2hDLFlBQ0ksUUFBUSxhQUFhLEVBQUU7QUFDM0IsZ0JBQU0scUJBQStCLENBQUMsQ0FBQztBQUN2QyxvQkFBUSxPQUFPO0FBQ2Ysd0JBQVUsUUFBUTtBQUNsQix3QkFBVSxPQUFPLENBQ0wsa0JBQWtCLEdBQUcsWUFBWSxFQUNqQyxLQUFLLENBQUM7QUFDbEIsNEJBQWMsR0FBRyxFQUFFLElBQUksQ0FBQyxRQUFRLEdBQUcsSUFBSTtBQUN2Qyw0QkFB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QUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQ0EsQUFBQSxBQUFBLEFBQUEsQUFDQSxBQUFBLEFBQ0EsQUFDQSxBQUFBLEFBQ0EsQUFDQSxBQUFBLEFBQUEsQUFBQSxBQUNBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUNBLEFBQ0EsQUFDQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUNBLEFBQ0EsQUFBQSxBQUFBLEFBbkVBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQ0EsQUFBQSxBQUVBLEFBQUEsQUFBQSxBQUFBLEFBQ0EsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQ0EsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFDQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUNBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQ0EsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFDQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUNBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQ0EsQUFDQSxBQUNBLEFBQUEsQUFFQSxBQUFBLEFBQUEsQUFBQSxBQUNBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUNBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFDQSxBQUNBLEFBQUEsQUFBQSxBQUFBLEFBQ0EsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFDQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFDQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFDQSxBQUNBLEFBQUEsQUFDQSxBQUFBLEFBQUEsQUFBQSxBQUNBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQ0EsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUNBLEFBQ0EsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQ0EsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUNBLEFBQUEsQUFDQSxBQUFBLEFBQ0EsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQ0EsQUFBQSxBQUFBLEFBQUEsQUFDQSxBQUFBLEFBQUEsQUFBQSxBQUNBLEFBQUEsQUFBQSxBQUFBLEFBQ0EsQUFBQSxBQUFBLEFBQUEsQUFDQSxBQUFBLEFBQUEsQUFDQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUNBLEFBQUEsQUE0QkEsQUFBQSxBQXJFQSxBQUFBLEFBQUEsQUFBQSxBQWxCQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBR0EsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUdBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFHQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUdBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFkQSxBQUFBLEFBREEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBcUJBLEFBQUEsQUFBQSxBQUFBLEFBcEJBLEFBQUEsQUF5RkEsQUF6RkEsQUFBQSIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IERpcmVjdGl2ZSwgRWxlbWVudFJlZiwgSW5wdXQsIE9uQ2hhbmdlcywgU2ltcGxlQ2hhbmdlcyB9IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xyXG5pbXBvcnQge1xyXG4gIGFuaW1hdGUsXHJcbiAgQW5pbWF0aW9uQnVpbGRlcixcclxuICBBbmltYXRpb25NZXRhZGF0YSxcclxuICBBbmltYXRpb25QbGF5ZXIsXHJcbiAgQW5pbWF0aW9uU3R5bGVNZXRhZGF0YSxcclxuICBzdHlsZVxyXG59IGZyb20gJ0Bhbmd1bGFyL2FuaW1hdGlvbnMnO1xyXG5pbXBvcnQgeyBBdmxOb3RpZmljYXRpb24gfSBmcm9tICdAYXZsLWNvbnRyb2xzL2ludGVyZmFjZXMnO1xyXG5pbXBvcnQgeyBBTklNQVRJT05fRFVSQVRJT04sIE1BUkdJTiB9IGZyb20gJy4uL2F2bC1ub3RpZmljYXRpb24tY29udGFpbmVyLmNvbnN0cyc7XHJcbmltcG9ydCB7IFNuYWNrYmFyTWV0aG9kRGVzY3JpcHRpb24gfSBmcm9tICcuL3Nob3ctaGlkZS1zbmFja2Jhci5kaXJlY3RpdmUnO1xyXG4vKiogQGhpZGRlbiAqL1xyXG5leHBvcnQgY29uc3QgZW51bSBQb3NpdGlvbkFuaW1hdGlvbiB7XHJcbiAgVG9Mb3dlclN0YWNrLFxyXG4gIFRvVG9wLFxyXG4gIFRvQm90dG9tLFxyXG4gIFRvU3RhY2ssXHJcbiAgRnJvbVN0YWNrXHJcbn1cclxuQERpcmVjdGl2ZSh7IHNlbGVjdG9yOiAnW2FuaW1hdGVTdGFja10nIH0pXHJcbmV4cG9ydCBjbGFzcyBBbmltYXRlU3RhY2sgaW1wbGVtZW50cyBPbkNoYW5nZXMge1xyXG4gIC8qKiBAaGlkZGVuICovXHJcbiAgQElucHV0KCkgcmVhZG9ubHkgYW5pbWF0ZVN0YWNrOiBQb3NpdGlvbkFuaW1hdGlvbjtcclxuXHJcbiAgLyoqIEBoaWRkZW4gKi9cclxuICBASW5wdXQoKSByZWFkb25seSBub3RpZmljYXRpb246IEF2bE5vdGlmaWNhdGlvbjtcclxuXHJcbiAgLyoqIEBoaWRkZW4gKi9cclxuICBASW5wdXQoKSByZWFkb25seSBwcmV2aW91c1N0YWNrSGVpZ2h0OiBudW1iZXI7XHJcblxyXG4gIC8qKiBAaGlkZGVuICovXHJcbiAgQElucHV0KCkgcmVhZG9ubHkgc25hY2tiYXJNZXRob2REZXNjcmlwdGlvbjogU25hY2tiYXJNZXRob2REZXNjcmlwdGlvbjtcclxuXHJcbiAgLyoqIEBoaWRkZW4gKi9cclxuICBASW5wdXQoKSByZWFkb25seSByZW9wZW46IGJvb2xlYW47XHJcblxyXG4gIHByaXZhdGUgc3R5bGVUb3A6IG51bWJlcjtcclxuICBwcml2YXRlIGVsZW1lbnQ6IEVsZW1lbnRSZWY7XHJcbiAgcHJpdmF0ZSBwbGF5ZXI6IEFuaW1hdGlvblBsYXllcjtcclxuXHJcbiAgY29uc3RydWN0b3IocmVhZG9ubHkgYnVpbGRlcjogQW5pbWF0aW9uQnVpbGRlciwgZWw6IEVsZW1lbnRSZWYpIHtcclxuICAgIHRoaXMuZWxlbWVudCA9IGVsO1xyXG4gIH1cclxuXHJcbiAgbmdPbkNoYW5nZXMoY2hhbmdlczogU2ltcGxlQ2hhbmdlcyk6IHZvaWQge1xyXG4gICAgaWYgKGNoYW5nZXMuYW5pbWF0ZVN0YWNrKSB7XHJcbiAgICAgIHRoaXMubW92ZSh0aGlzLnByZXZpb3VzU3RhY2tIZWlnaHQpO1xyXG4gICAgfSBlbHNlIGlmIChjaGFuZ2VzLnByZXZpb3VzU3RhY2tIZWlnaHQpIHtcclxuICAgICAgdGhpcy5tb3ZlKGNoYW5nZXM/LnByZXZpb3VzU3RhY2tIZWlnaHQuY3VycmVudFZhbHVlKTtcclxuICAgIH0gZWxzZSBpZiAoY2hhbmdlcy5zbmFja2Jhck1ldGhvZERlc2NyaXB0aW9uKSB7XHJcbiAgICAgIGlmIChjaGFuZ2VzLnNuYWNrYmFyTWV0aG9kRGVzY3JpcHRpb24uY3VycmVudFZhbHVlPy5tZXRob2QgPT09ICdzaG93Jykge1xyXG4gICAgICAgIHRoaXMubW92ZSh0aGlzLnByZXZpb3VzU3RhY2tIZWlnaHQpO1xyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBwcml2YXRlIHNob3cobWV0YWRhdGE6IEFuaW1hdGlvbk1ldGFkYXRhW10pIHtcclxuICAgIGlmICh0aGlzLnBsYXllcikge1xyXG4gICAgICB0aGlzLnBsYXllci5kZXN0cm95KCk7XHJcbiAgICB9XHJcbiAgICBpZiAobWV0YWRhdGEpIHtcclxuICAgICAgY29uc3QgZmFjdG9yeSA9IHRoaXMuYnVpbGRlci5idWlsZChtZXRhZGF0YSk7XHJcbiAgICAgIGNvbnN0IHBsYXllciA9IGZhY3RvcnkuY3JlYXRlKHRoaXMuZWxlbWVudC5uYXRpdmVFbGVtZW50KTtcclxuICAgICAgcGxheWVyLnBsYXkoKTtcclxuICAgIH1cclxuICB9XHJcbiAgcHJpdmF0ZSBtb3ZlKGhlaWdodDogbnVtYmVyKSB7XHJcbiAgICBpZiAodGhpcy5hbmltYXRlU3RhY2sgPT09IFBvc2l0aW9uQW5pbWF0aW9uLlRvQm90dG9tKSB7XHJcbiAgICAgIHRoaXMuc3R5bGVUb3AgPSBoZWlnaHQgKyBNQVJHSU4gKiAyO1xyXG4gICAgfVxyXG4gICAgY29uc3QgYW5pbWF0aW9uTWV0YWRhdGE6IEFuaW1hdGlvbk1ldGFkYXRhW10gPSB0aGlzLmFuaW1hdGUoKTtcclxuICAgIHRoaXMuc2hvdyhhbmltYXRpb25NZXRhZGF0YSk7XHJcbiAgfVxyXG4gIHByaXZhdGUgYW5pbWF0ZSgpOiBBbmltYXRpb25NZXRhZGF0YVtdIHtcclxuICAgIGNvbnN0IGluaXRpYWxTdHlsZSA9IHN0eWxlKHtcclxuICAgICAgdG9wOiAnMCcsXHJcbiAgICAgIHdpZHRoOiAnMTAwJScsXHJcbiAgICAgIGxlZnQ6ICcwJyxcclxuICAgICAgekluZGV4OiAxXHJcbiAgICB9KTtcclxuICAgIHJldHVybiB0aGlzLmdldEFuaW1hdGlvbih0aGlzLmFuaW1hdGVTdGFjaywgaW5pdGlhbFN0eWxlKTtcclxuICB9XHJcblxyXG4gIHByaXZhdGUgZ2V0QW5pbWF0aW9uID0gKFxyXG4gICAgYW5pbWF0aW9uTmFtZTogUG9zaXRpb25BbmltYXRpb24sXHJcbiAgICBpbml0aWFsU3R5bGU6IEFuaW1hdGlvblN0eWxlTWV0YWRhdGFcclxuICApOiBBbmltYXRpb25NZXRhZGF0YVtdID0+IHtcclxuICAgIGNvbnN0IGFsbFN0eWxlID0gc3R5bGUoJyonKTtcclxuXHJcbiAgICBzd2l0Y2ggKGFuaW1hdGlvbk5hbWUpIHtcclxuICAgICAgY2FzZSBQb3NpdGlvbkFuaW1hdGlvbi5Ub0JvdHRvbToge1xyXG4gICAgICAgIHJldHVybiBbXHJcbiAgICAgICAgICBhbGxTdHlsZSxcclxuICAgICAgICAgIGFuaW1hdGUoXHJcbiAgICAgICAgICAgIEFOSU1BVElPTl9EVVJBVElPTiArICdtcyBlYXNlLWluJyxcclxuICAgICAgICAgICAgc3R5bGUoe1xyXG4gICAgICAgICAgICAgIHRvcDogdGhpcy5zdHlsZVRvcCArICdweCcsXHJcbiAgICAgICAgICAgICAgekluZGV4OiAwXHJcbiAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICApXHJcbiAgICAgICAgXTtcclxuICAgICAgfVxyXG4gICAgICBjYXNlIFBvc2l0aW9uQW5pbWF0aW9uLlRvVG9wOiB7XHJcbiAgICAgICAgcmV0dXJuIFthbGxTdHlsZSwgYW5pbWF0ZShBTklNQVRJT05fRFVSQVRJT04gKyAnbXMgZWFzZS1pbicsIGluaXRpYWxTdHlsZSldO1xyXG4gICAgICB9XHJcbiAgICAgIGRlZmF1bHQ6XHJcbiAgICAgICAgcmV0dXJuIFtpbml0aWFsU3R5bGUsIGFuaW1hdGUoJzBtcycsIGluaXRpYWxTdHlsZSldO1xyXG4gICAgfVxyXG4gIH07XHJcbn1cclxuIl19