import * as ɵngcc0 from '@angular/core';
import * as ɵngcc1 from '@angular/animations';
var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};
var __metadata = (this && this.__metadata) || function (k, v) {
    if (typeof Reflect === "object" && typeof Reflect.metadata === "function") return Reflect.metadata(k, v);
};
import { Directive, ElementRef, HostBinding, Input, OnChanges, SimpleChanges } from '@angular/core';
import { animate, AnimationBuilder, AnimationMetadata, AnimationPlayer, AnimationStyleMetadata, style } from '@angular/animations';
import { ANIMATION_DURATION, MARGIN } from '../avl-notification-container.consts';
/** @hidden */
let AnimateSnackbar = class AnimateSnackbar {
    constructor(builder, el) {
        this.builder = builder;
        /** @hidden */
        this.defaultClass = true;
        this.getAnimation = (animationName, initialStyle) => {
            const elementWidth = this.element.nativeElement.offsetWidth - 3 * MARGIN;
            const inStackStyle = style({
                marginTop: MARGIN + 'px',
                marginLeft: MARGIN + 'px',
                marginRight: MARGIN + 'px',
                width: elementWidth + 'px'
            });
            switch (animationName) {
                case 4 /* FromStack */:
                    return [animate(ANIMATION_DURATION + 'ms ease-in', inStackStyle), initialStyle];
                case 3 /* ToStack */: {
                    return [initialStyle, animate(ANIMATION_DURATION + 'ms ease-in', inStackStyle)];
                }
                default:
                    return [initialStyle, animate('1ms ease-in', initialStyle)];
            }
        };
        this.element = el;
    }
    ngOnChanges(changes) {
        if (changes.animateSnackbar) {
            const isInStack = changes.animateSnackbar.currentValue === 3 /* ToStack */;
            if (isInStack) {
                this.move();
            }
            else if (changes.animateSnackbar.previousValue === 3 /* ToStack */) {
                this.move();
            }
        }
    }
    show(metadata) {
        if (this.player) {
            this.player.destroy();
        }
        if (metadata) {
            const factory = this.builder.build(metadata);
            const player = factory.create(this.element.nativeElement);
            player.play();
        }
    }
    move() {
        const animationMetadata = this.animate();
        this.show(animationMetadata);
    }
    animate() {
        const initialStyle = style({
            marginTop: '0',
            width: '100%',
            marginLeft: '0',
            marginRight: '0'
        });
        return this.getAnimation(this.animateSnackbar, initialStyle);
    }
};
AnimateSnackbar.ɵfac = function AnimateSnackbar_Factory(t) { return new (t || AnimateSnackbar)(ɵngcc0.ɵɵdirectiveInject(ɵngcc1.AnimationBuilder), ɵngcc0.ɵɵdirectiveInject(ɵngcc0.ElementRef)); };
AnimateSnackbar.ɵdir = ɵngcc0.ɵɵdefineDirective({ type: AnimateSnackbar, selectors: [["", "animateSnackbar", ""]], hostVars: 6, hostBindings: function AnimateSnackbar_HostBindings(rf, ctx) { if (rf & 2) {
        ɵngcc0.ɵɵclassProp("snackbar-container", ctx.defaultClass)("in-stack", ctx.inStack)("no-animation", ctx.noAnimation);
    } }, inputs: { animateSnackbar: "animateSnackbar", positionAnimation: "positionAnimation", notification: "notification", reopen: "reopen" }, features: [ɵngcc0.ɵɵNgOnChangesFeature] });
AnimateSnackbar.ctorParameters = () => [
    { type: AnimationBuilder },
    { type: ElementRef }
];
__decorate([
    Input(),
    __metadata("design:type", Number)
], AnimateSnackbar.prototype, "animateSnackbar", void 0);
__decorate([
    Input(),
    __metadata("design:type", Number)
], AnimateSnackbar.prototype, "positionAnimation", void 0);
__decorate([
    Input('notification'),
    __metadata("design:type", Object)
], AnimateSnackbar.prototype, "notification", void 0);
__decorate([
    Input('reopen'),
    __metadata("design:type", Boolean)
], AnimateSnackbar.prototype, "reopen", void 0);
__decorate([
    HostBinding('class.in-stack'),
    __metadata("design:type", Boolean)
], AnimateSnackbar.prototype, "inStack", void 0);
__decorate([
    HostBinding('class.no-animation'),
    __metadata("design:type", Boolean)
], AnimateSnackbar.prototype, "noAnimation", void 0);
__decorate([
    HostBinding('class.snackbar-container'),
    __metadata("design:type", Object)
], AnimateSnackbar.prototype, "defaultClass", void 0);
AnimateSnackbar = __decorate([ __metadata("design:paramtypes", [AnimationBuilder, ElementRef])
], AnimateSnackbar);
/*@__PURE__*/ (function () { ɵngcc0.ɵsetClassMetadata(AnimateSnackbar, [{
        type: Directive,
        args: [{ selector: '[animateSnackbar]' }]
    }], function () { return [{ type: ɵngcc1.AnimationBuilder }, { type: ɵngcc0.ElementRef }]; }, { defaultClass: [{
            type: HostBinding,
            args: ['class.snackbar-container']
        }], animateSnackbar: [{
            type: Input
        }], positionAnimation: [{
            type: Input
        }], notification: [{
            type: Input,
            args: ['notification']
        }], reopen: [{
            type: Input,
            args: ['reopen']
        }], inStack: [{
            type: HostBinding,
            args: ['class.in-stack']
        }], noAnimation: [{
            type: HostBinding,
            args: ['class.no-animation']
        }] }); })();
export { AnimateSnackbar };
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiYW5pbWF0ZS1zbmFja2Jhci5kaXJlY3RpdmUuanMiLCJzb3VyY2VzIjpbIm5nOi9AYXZsLW5nLWNvbnRyb2xzL25vdGlmaWNhdGlvbi9saWIvY29tcG9uZW50cy9hdmwtbm90aWZpY2F0aW9uLWNvbnRhaW5lci9kaXJlY3RpdmVzL2FuaW1hdGUtc25hY2tiYXIuZGlyZWN0aXZlLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7O0FBQUEsT0FBTyxFQUFFLFNBQVMsRUFBRSxVQUFVLEVBQUUsV0FBVyxFQUFFLEtBQUssRUFBRSxTQUFTLEVBQUUsYUFBYSxFQUFFLE1BQU0sZUFBZSxDQUFDO0FBQ3BHLE9BQU8sRUFDTCxPQUFPLEVBQ1AsZ0JBQWdCLEVBQ2hCLGlCQUFpQixFQUNqQixlQUFlLEVBQ2Ysc0JBQXNCLEVBQ3RCLEtBQUssRUFDTixNQUFNLHFCQUFxQixDQUFDO0FBRzdCLE9BQU8sRUFBRSxrQkFBa0IsRUFBRSxNQUFNLEVBQUUsTUFBTSxzQ0FBc0MsQ0FBQztBQUNsRixjQUFjO0FBR2QsSUFBYSxlQUFlLEdBQTVCLE1BQWEsZUFBZTtBQUFHLElBeUI3QixZQUFxQixPQUF5QixFQUFFLEVBQWM7QUFDaEUsUUFEdUIsWUFBTyxHQUFQLE9BQU8sQ0FBa0I7QUFBQyxRQU4vQyxjQUFjO0FBQ2hCLFFBQTJDLGlCQUFZLEdBQUcsSUFBSSxDQUFDO0FBQy9ELFFBMkNVLGlCQUFZLEdBQUcsQ0FDckIsYUFBZ0MsRUFDaEMsWUFBb0MsRUFDZixFQUFFO0FBQzNCLFlBQUksTUFBTSxZQUFZLEdBQUcsSUFBSSxDQUFDLE9BQU8sQ0FBQyxhQUFhLENBQUMsV0FBVyxHQUFHLENBQUMsR0FBRyxNQUFNLENBQUM7QUFDN0UsWUFBSSxNQUFNLFlBQVksR0FBRyxLQUFLLENBQUM7QUFDL0IsZ0JBQU0sU0FBUyxFQUFFLE1BQU0sR0FBRyxJQUFJO0FBQzlCLGdCQUFNLFVBQVUsRUFBRSxNQUFNLEdBQUcsSUFBSTtBQUMvQixnQkFBTSxXQUFXLEVBQUUsTUFBTSxHQUFHLElBQUk7QUFDaEMsZ0JBQU0sS0FBSyxFQUFFLFlBQVksR0FBRyxJQUFJO0FBQ2hDLGFBQUssQ0FBQyxDQUFDO0FBQ1AsWUFBSSxRQUFRLGFBQWEsRUFBRTtBQUMzQixnQkFBTTtBQUF3QixvQkFDdEIsT0FBTyxDQUFDLE9BQU8sQ0FBQyxrQkFBa0IsR0FBRyxZQUFZLEVBQUUsWUFBWSxDQUFDLEVBQUUsWUFBWSxDQUFDLENBQUM7QUFDeEYsZ0JBQ00sb0JBQThCLENBQUMsQ0FBQztBQUN0QyxvQkFBUSxPQUFPLENBQUMsWUFBWSxFQUFFLE9BQU8sQ0FBQyxrQkFBa0IsR0FBRyxZQUFZLEVBQUUsWUFBWSxDQUFDLENBQUMsQ0FBQztBQUN4RixpQkFBTztBQUNQLGdCQUFNO0FBQ04sb0JBQVEsT0FBTyxDQUFDLFlBQVksRUFBRSxPQUFPLENBQUMsYUFBYSxFQUFFLFlBQVksQ0FBQyxDQUFDLENBQUM7QUFDcEUsYUFBSztBQUNMLFFBQUUsQ0FBQyxDQUFDO0FBQ0osUUE1REksSUFBSSxDQUFDLE9BQU8sR0FBRyxFQUFFLENBQUM7QUFDdEIsSUFBRSxDQUFDO0FBQ0gsSUFDRSxXQUFXLENBQUMsT0FBc0I7QUFBSSxRQUNwQyxJQUFJLE9BQU8sQ0FBQyxlQUFlLEVBQUU7QUFDakMsWUFBTSxNQUFNLFNBQVMsR0FBRyxPQUFPLENBQUMsZUFBZSxDQUFDLFlBQVksb0JBQThCLENBQUM7QUFDM0YsWUFBTSxJQUFJLFNBQVMsRUFBRTtBQUNyQixnQkFBUSxJQUFJLENBQUMsSUFBSSxFQUFFLENBQUM7QUFDcEIsYUFBTztBQUFDLGlCQUFLLElBQUksT0FBTyxDQUFDLGVBQWUsQ0FBQyxhQUFhLG9CQUE4QixFQUFFO0FBQ3RGLGdCQUFRLElBQUksQ0FBQyxJQUFJLEVBQUUsQ0FBQztBQUNwQixhQUFPO0FBQ1AsU0FBSztBQUNMLElBQUUsQ0FBQztBQUNILElBQ1UsSUFBSSxDQUFDLFFBQTZCO0FBQzVDLFFBQUksSUFBSSxJQUFJLENBQUMsTUFBTSxFQUFFO0FBQ3JCLFlBQU0sSUFBSSxDQUFDLE1BQU0sQ0FBQyxPQUFPLEVBQUUsQ0FBQztBQUM1QixTQUFLO0FBQ0wsUUFBSSxJQUFJLFFBQVEsRUFBRTtBQUNsQixZQUFNLE1BQU0sT0FBTyxHQUFHLElBQUksQ0FBQyxPQUFPLENBQUMsS0FBSyxDQUFDLFFBQVEsQ0FBQyxDQUFDO0FBQ25ELFlBQU0sTUFBTSxNQUFNLEdBQUcsT0FBTyxDQUFDLE1BQU0sQ0FBQyxJQUFJLENBQUMsT0FBTyxDQUFDLGFBQWEsQ0FBQyxDQUFDO0FBQ2hFLFlBQU0sTUFBTSxDQUFDLElBQUksRUFBRSxDQUFDO0FBQ3BCLFNBQUs7QUFDTCxJQUFFLENBQUM7QUFDSCxJQUFVLElBQUk7QUFDZCxRQUFJLE1BQU0saUJBQWlCLEdBQXdCLElBQUksQ0FBQyxPQUFPLEVBQUUsQ0FBQztBQUNsRSxRQUFJLElBQUksQ0FBQyxJQUFJLENBQUMsaUJBQWlCLENBQUMsQ0FBQztBQUNqQyxJQUFFLENBQUM7QUFDSCxJQUFVLE9BQU87QUFBSyxRQUNsQixNQUFNLFlBQVksR0FBRyxLQUFLLENBQUM7QUFDL0IsWUFBTSxTQUFTLEVBQUUsR0FBRztBQUNwQixZQUFNLEtBQUssRUFBRSxNQUFNO0FBQ25CLFlBQU0sVUFBVSxFQUFFLEdBQUc7QUFDckIsWUFBTSxXQUFXLEVBQUUsR0FBRztBQUN0QixTQUFLLENBQUMsQ0FBQztBQUNQLFFBQUksT0FBTyxJQUFJLENBQUMsWUFBWSxDQUFDLElBQUksQ0FBQyxlQUFlLEVBQUUsWUFBWSxDQUFDLENBQUM7QUFDakUsSUFBRSxDQUFDO0FBQ0gsQ0F1QkM7Ozs7NExBQUE7QUFDRDtBQUF5QyxZQTlEVCxnQkFBZ0I7QUFBSSxZQUFFLFVBQVU7QUFBRztBQXZCeEQ7QUFBYSxJQUFyQixLQUFLLEVBQUU7QUFBRTtBQUFzQyx3REFBSztBQUc1QztBQUFhLElBQXJCLEtBQUssRUFBRTtBQUFFO0FBQXNDLDBEQUFPO0FBR2hDO0FBQWEsSUFBbkMsS0FBSyxDQUFDLGNBQWMsQ0FBQztBQUFFO0FBQXNDLHFEQUFBO0FBRzdDO0FBQWEsSUFBN0IsS0FBSyxDQUFDLFFBQVEsQ0FBQztBQUFFO0FBRVAsK0NBRitCO0FBR1g7QUFBYSxJQUEzQyxXQUFXLENBQUMsZ0JBQWdCLENBQUM7QUFBRTtBQUc5QixnREFIOEM7QUFHYjtBQUFhLElBQS9DLFdBQVcsQ0FBQyxvQkFBb0IsQ0FBQztBQUFFO0FBR3RDLG9EQUgwRDtBQUdmO0FBQWEsSUFBckQsV0FBVyxDQUFDLDBCQUEwQixDQUFDO0FBQUU7QUFFM0IscURBRjhDO0FBcEJsRCxlQUFlLG9CQUQzQixTQUFTLENBQUMsRUFBRSxRQUFRLEVBQUUsbUJBQW1CLEVBQUUsQ0FBQyxqREFDekMsa0NBeUI0QixnQkFBZ0IsRUFBTSxVQUFVO0FBQUcsR0F6QnRELGVBQWUsQ0FzRjNCOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztvQkFDRDs7QUF0R0EsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQ0EsQUFBQSxBQUNBLEFBQUEsQUFDQSxBQUFBLEFBQ0EsQUFBQSxBQUNBLEFBQUEsQUFDQSxBQUFBLEFBQ0EsQUFBQSxBQUNBLEFBQUEsQUFBQSxBQUFBLEFBR0EsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFDQSxBQUFBLEFBR0EsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBeUJBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBTkEsQUFBQSxBQUNBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUE0Q0EsQUFBQSxBQUFBLEFBQ0EsQUFBQSxBQUNBLEFBQUEsQUFDQSxBQUFBLEFBQ0EsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFDQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFDQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFDQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFDQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFDQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFDQSxBQUFBLEFBQUEsQUFDQSxBQUFBLEFBQUEsQUFBQSxBQUNBLEFBQ0EsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBRUEsQUFBQSxBQUFBLEFBQUEsQUFDQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFDQSxBQUNBLEFBQ0EsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFDQSxBQUNBLEFBQUEsQUFBQSxBQTNEQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUNBLEFBQUEsQUFFQSxBQUFBLEFBQUEsQUFBQSxBQUNBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUNBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFDQSxBQUFBLEFBQUEsQUFBQSxBQUNBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUNBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQ0EsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQ0EsQUFDQSxBQUNBLEFBQUEsQUFFQSxBQUFBLEFBQUEsQUFBQSxBQUNBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUNBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFDQSxBQUNBLEFBQUEsQUFBQSxBQUFBLEFBQ0EsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFDQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFDQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFDQSxBQUNBLEFBQUEsQUFDQSxBQUFBLEFBQ0EsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQ0EsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUNBLEFBQUEsQUFDQSxBQUFBLEFBQ0EsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQ0EsQUFBQSxBQUFBLEFBQUEsQUFDQSxBQUFBLEFBQUEsQUFBQSxBQUNBLEFBQUEsQUFBQSxBQUFBLEFBQ0EsQUFBQSxBQUFBLEFBQUEsQUFDQSxBQUFBLEFBQUEsQUFDQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUNBLEFBQUEsQUF3QkEsQUFBQSxBQTdEQSxBQUFBLEFBQUEsQUFBQSxBQXZCQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBR0EsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUdBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBR0EsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFHQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUdBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBR0EsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFwQkEsQUFBQSxBQURBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQTBCQSxBQUFBLEFBQUEsQUFBQSxBQXpCQSxBQUFBLEFBc0ZBLEFBdEZBLEFBQUEiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBEaXJlY3RpdmUsIEVsZW1lbnRSZWYsIEhvc3RCaW5kaW5nLCBJbnB1dCwgT25DaGFuZ2VzLCBTaW1wbGVDaGFuZ2VzIH0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XHJcbmltcG9ydCB7XHJcbiAgYW5pbWF0ZSxcclxuICBBbmltYXRpb25CdWlsZGVyLFxyXG4gIEFuaW1hdGlvbk1ldGFkYXRhLFxyXG4gIEFuaW1hdGlvblBsYXllcixcclxuICBBbmltYXRpb25TdHlsZU1ldGFkYXRhLFxyXG4gIHN0eWxlXHJcbn0gZnJvbSAnQGFuZ3VsYXIvYW5pbWF0aW9ucyc7XHJcbmltcG9ydCB7IEF2bE5vdGlmaWNhdGlvbiB9IGZyb20gJ0BhdmwtY29udHJvbHMvaW50ZXJmYWNlcyc7XHJcbmltcG9ydCB7IFBvc2l0aW9uQW5pbWF0aW9uIH0gZnJvbSAnLi9hbmltYXRlLXN0YWNrLmRpcmVjdGl2ZSc7XHJcbmltcG9ydCB7IEFOSU1BVElPTl9EVVJBVElPTiwgTUFSR0lOIH0gZnJvbSAnLi4vYXZsLW5vdGlmaWNhdGlvbi1jb250YWluZXIuY29uc3RzJztcclxuLyoqIEBoaWRkZW4gKi9cclxuXHJcbkBEaXJlY3RpdmUoeyBzZWxlY3RvcjogJ1thbmltYXRlU25hY2tiYXJdJyB9KVxyXG5leHBvcnQgY2xhc3MgQW5pbWF0ZVNuYWNrYmFyIGltcGxlbWVudHMgT25DaGFuZ2VzIHtcclxuICAvKiogQGhpZGRlbiAqL1xyXG4gIEBJbnB1dCgpIHJlYWRvbmx5IGFuaW1hdGVTbmFja2JhcjogUG9zaXRpb25BbmltYXRpb247XHJcblxyXG4gIC8qKiBAaGlkZGVuICovXHJcbiAgQElucHV0KCkgcmVhZG9ubHkgcG9zaXRpb25BbmltYXRpb246IFBvc2l0aW9uQW5pbWF0aW9uO1xyXG5cclxuICAvKiogQGhpZGRlbiAqL1xyXG4gIEBJbnB1dCgnbm90aWZpY2F0aW9uJykgcmVhZG9ubHkgbm90aWZpY2F0aW9uOiBBdmxOb3RpZmljYXRpb247XHJcblxyXG4gIC8qKiBAaGlkZGVuICovXHJcbiAgQElucHV0KCdyZW9wZW4nKSByZWFkb25seSByZW9wZW46IGJvb2xlYW47XHJcblxyXG4gIC8qKiBAaGlkZGVuICovXHJcbiAgQEhvc3RCaW5kaW5nKCdjbGFzcy5pbi1zdGFjaycpIGluU3RhY2s6IGJvb2xlYW47XHJcblxyXG4gIC8qKiBAaGlkZGVuICovXHJcbiAgQEhvc3RCaW5kaW5nKCdjbGFzcy5uby1hbmltYXRpb24nKSBub0FuaW1hdGlvbjogYm9vbGVhbjtcclxuXHJcbiAgLyoqIEBoaWRkZW4gKi9cclxuICBASG9zdEJpbmRpbmcoJ2NsYXNzLnNuYWNrYmFyLWNvbnRhaW5lcicpIGRlZmF1bHRDbGFzcyA9IHRydWU7XHJcblxyXG4gIHByaXZhdGUgZWxlbWVudDogRWxlbWVudFJlZjtcclxuICBwcml2YXRlIHBsYXllcjogQW5pbWF0aW9uUGxheWVyO1xyXG5cclxuICBjb25zdHJ1Y3RvcihyZWFkb25seSBidWlsZGVyOiBBbmltYXRpb25CdWlsZGVyLCBlbDogRWxlbWVudFJlZikge1xyXG4gICAgdGhpcy5lbGVtZW50ID0gZWw7XHJcbiAgfVxyXG5cclxuICBuZ09uQ2hhbmdlcyhjaGFuZ2VzOiBTaW1wbGVDaGFuZ2VzKTogdm9pZCB7XHJcbiAgICBpZiAoY2hhbmdlcy5hbmltYXRlU25hY2tiYXIpIHtcclxuICAgICAgY29uc3QgaXNJblN0YWNrID0gY2hhbmdlcy5hbmltYXRlU25hY2tiYXIuY3VycmVudFZhbHVlID09PSBQb3NpdGlvbkFuaW1hdGlvbi5Ub1N0YWNrO1xyXG4gICAgICBpZiAoaXNJblN0YWNrKSB7XHJcbiAgICAgICAgdGhpcy5tb3ZlKCk7XHJcbiAgICAgIH0gZWxzZSBpZiAoY2hhbmdlcy5hbmltYXRlU25hY2tiYXIucHJldmlvdXNWYWx1ZSA9PT0gUG9zaXRpb25BbmltYXRpb24uVG9TdGFjaykge1xyXG4gICAgICAgIHRoaXMubW92ZSgpO1xyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBwcml2YXRlIHNob3cobWV0YWRhdGE6IEFuaW1hdGlvbk1ldGFkYXRhW10pIHtcclxuICAgIGlmICh0aGlzLnBsYXllcikge1xyXG4gICAgICB0aGlzLnBsYXllci5kZXN0cm95KCk7XHJcbiAgICB9XHJcbiAgICBpZiAobWV0YWRhdGEpIHtcclxuICAgICAgY29uc3QgZmFjdG9yeSA9IHRoaXMuYnVpbGRlci5idWlsZChtZXRhZGF0YSk7XHJcbiAgICAgIGNvbnN0IHBsYXllciA9IGZhY3RvcnkuY3JlYXRlKHRoaXMuZWxlbWVudC5uYXRpdmVFbGVtZW50KTtcclxuICAgICAgcGxheWVyLnBsYXkoKTtcclxuICAgIH1cclxuICB9XHJcbiAgcHJpdmF0ZSBtb3ZlKCkge1xyXG4gICAgY29uc3QgYW5pbWF0aW9uTWV0YWRhdGE6IEFuaW1hdGlvbk1ldGFkYXRhW10gPSB0aGlzLmFuaW1hdGUoKTtcclxuICAgIHRoaXMuc2hvdyhhbmltYXRpb25NZXRhZGF0YSk7XHJcbiAgfVxyXG4gIHByaXZhdGUgYW5pbWF0ZSgpOiBBbmltYXRpb25NZXRhZGF0YVtdIHtcclxuICAgIGNvbnN0IGluaXRpYWxTdHlsZSA9IHN0eWxlKHtcclxuICAgICAgbWFyZ2luVG9wOiAnMCcsXHJcbiAgICAgIHdpZHRoOiAnMTAwJScsXHJcbiAgICAgIG1hcmdpbkxlZnQ6ICcwJyxcclxuICAgICAgbWFyZ2luUmlnaHQ6ICcwJ1xyXG4gICAgfSk7XHJcbiAgICByZXR1cm4gdGhpcy5nZXRBbmltYXRpb24odGhpcy5hbmltYXRlU25hY2tiYXIsIGluaXRpYWxTdHlsZSk7XHJcbiAgfVxyXG5cclxuICBwcml2YXRlIGdldEFuaW1hdGlvbiA9IChcclxuICAgIGFuaW1hdGlvbk5hbWU6IFBvc2l0aW9uQW5pbWF0aW9uLFxyXG4gICAgaW5pdGlhbFN0eWxlOiBBbmltYXRpb25TdHlsZU1ldGFkYXRhXHJcbiAgKTogQW5pbWF0aW9uTWV0YWRhdGFbXSA9PiB7XHJcbiAgICBjb25zdCBlbGVtZW50V2lkdGggPSB0aGlzLmVsZW1lbnQubmF0aXZlRWxlbWVudC5vZmZzZXRXaWR0aCAtIDMgKiBNQVJHSU47XHJcbiAgICBjb25zdCBpblN0YWNrU3R5bGUgPSBzdHlsZSh7XHJcbiAgICAgIG1hcmdpblRvcDogTUFSR0lOICsgJ3B4JyxcclxuICAgICAgbWFyZ2luTGVmdDogTUFSR0lOICsgJ3B4JyxcclxuICAgICAgbWFyZ2luUmlnaHQ6IE1BUkdJTiArICdweCcsXHJcbiAgICAgIHdpZHRoOiBlbGVtZW50V2lkdGggKyAncHgnXHJcbiAgICB9KTtcclxuICAgIHN3aXRjaCAoYW5pbWF0aW9uTmFtZSkge1xyXG4gICAgICBjYXNlIFBvc2l0aW9uQW5pbWF0aW9uLkZyb21TdGFjazpcclxuICAgICAgICByZXR1cm4gW2FuaW1hdGUoQU5JTUFUSU9OX0RVUkFUSU9OICsgJ21zIGVhc2UtaW4nLCBpblN0YWNrU3R5bGUpLCBpbml0aWFsU3R5bGVdO1xyXG5cclxuICAgICAgY2FzZSBQb3NpdGlvbkFuaW1hdGlvbi5Ub1N0YWNrOiB7XHJcbiAgICAgICAgcmV0dXJuIFtpbml0aWFsU3R5bGUsIGFuaW1hdGUoQU5JTUFUSU9OX0RVUkFUSU9OICsgJ21zIGVhc2UtaW4nLCBpblN0YWNrU3R5bGUpXTtcclxuICAgICAgfVxyXG4gICAgICBkZWZhdWx0OlxyXG4gICAgICAgIHJldHVybiBbaW5pdGlhbFN0eWxlLCBhbmltYXRlKCcxbXMgZWFzZS1pbicsIGluaXRpYWxTdHlsZSldO1xyXG4gICAgfVxyXG4gIH07XHJcbn1cclxuIl19