var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};
var __metadata = (this && this.__metadata) || function (k, v) {
    if (typeof Reflect === "object" && typeof Reflect.metadata === "function") return Reflect.metadata(k, v);
};
import { Directive, ElementRef, Input, OnChanges, SimpleChanges } from '@angular/core';
import { animate, AnimationBuilder, AnimationMetadata, AnimationPlayer, AnimationStyleMetadata, style } from '@angular/animations';
import { ANIMATION_DURATION, MARGIN } from '../avl-notification-container.consts';
import { SnackbarMethodDescription } from './show-hide-snackbar.directive';
let AnimateStack = class AnimateStack {
    constructor(builder, el) {
        this.builder = builder;
        this.getAnimation = (animationName, initialStyle) => {
            const allStyle = style('*');
            switch (animationName) {
                case 2 /* ToBottom */: {
                    return [
                        allStyle,
                        animate(ANIMATION_DURATION + 'ms ease-in', style({
                            top: this.styleTop + 'px',
                            zIndex: 0
                        }))
                    ];
                }
                case 1 /* ToTop */: {
                    return [allStyle, animate(ANIMATION_DURATION + 'ms ease-in', initialStyle)];
                }
                default:
                    return [initialStyle, animate('0ms', initialStyle)];
            }
        };
        this.element = el;
    }
    ngOnChanges(changes) {
        var _a;
        if (changes.animateStack) {
            this.move(this.previousStackHeight);
        }
        else if (changes.previousStackHeight) {
            this.move(changes === null || changes === void 0 ? void 0 : changes.previousStackHeight.currentValue);
        }
        else if (changes.snackbarMethodDescription) {
            if (((_a = changes.snackbarMethodDescription.currentValue) === null || _a === void 0 ? void 0 : _a.method) === 'show') {
                this.move(this.previousStackHeight);
            }
        }
    }
    show(metadata) {
        if (this.player) {
            this.player.destroy();
        }
        if (metadata) {
            const factory = this.builder.build(metadata);
            const player = factory.create(this.element.nativeElement);
            player.play();
        }
    }
    move(height) {
        if (this.animateStack === 2 /* ToBottom */) {
            this.styleTop = height + MARGIN * 2;
        }
        const animationMetadata = this.animate();
        this.show(animationMetadata);
    }
    animate() {
        const initialStyle = style({
            top: '0',
            width: '100%',
            left: '0',
            zIndex: 1
        });
        return this.getAnimation(this.animateStack, initialStyle);
    }
};
AnimateStack.ctorParameters = () => [
    { type: AnimationBuilder },
    { type: ElementRef }
];
__decorate([
    Input(),
    __metadata("design:type", Number)
], AnimateStack.prototype, "animateStack", void 0);
__decorate([
    Input(),
    __metadata("design:type", Object)
], AnimateStack.prototype, "notification", void 0);
__decorate([
    Input(),
    __metadata("design:type", Number)
], AnimateStack.prototype, "previousStackHeight", void 0);
__decorate([
    Input(),
    __metadata("design:type", SnackbarMethodDescription)
], AnimateStack.prototype, "snackbarMethodDescription", void 0);
__decorate([
    Input(),
    __metadata("design:type", Boolean)
], AnimateStack.prototype, "reopen", void 0);
AnimateStack = __decorate([
    Directive({ selector: '[animateStack]' }),
    __metadata("design:paramtypes", [AnimationBuilder, ElementRef])
], AnimateStack);
export { AnimateStack };
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiYW5pbWF0ZS1zdGFjay5kaXJlY3RpdmUuanMiLCJzb3VyY2VSb290Ijoibmc6Ly9AYXZsLW5nLWNvbnRyb2xzL25vdGlmaWNhdGlvbi8iLCJzb3VyY2VzIjpbImxpYi9jb21wb25lbnRzL2F2bC1ub3RpZmljYXRpb24tY29udGFpbmVyL2RpcmVjdGl2ZXMvYW5pbWF0ZS1zdGFjay5kaXJlY3RpdmUudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7O0FBQUEsT0FBTyxFQUFFLFNBQVMsRUFBRSxVQUFVLEVBQUUsS0FBSyxFQUFFLFNBQVMsRUFBRSxhQUFhLEVBQUUsTUFBTSxlQUFlLENBQUM7QUFDdkYsT0FBTyxFQUNMLE9BQU8sRUFDUCxnQkFBZ0IsRUFDaEIsaUJBQWlCLEVBQ2pCLGVBQWUsRUFDZixzQkFBc0IsRUFDdEIsS0FBSyxFQUNOLE1BQU0scUJBQXFCLENBQUM7QUFFN0IsT0FBTyxFQUFFLGtCQUFrQixFQUFFLE1BQU0sRUFBRSxNQUFNLHNDQUFzQyxDQUFDO0FBQ2xGLE9BQU8sRUFBRSx5QkFBeUIsRUFBRSxNQUFNLGdDQUFnQyxDQUFDO0FBVTNFLElBQWEsWUFBWSxHQUF6QixNQUFhLFlBQVk7SUFvQnZCLFlBQXFCLE9BQXlCLEVBQUUsRUFBYztRQUF6QyxZQUFPLEdBQVAsT0FBTyxDQUFrQjtRQTJDdEMsaUJBQVksR0FBRyxDQUNyQixhQUFnQyxFQUNoQyxZQUFvQyxFQUNmLEVBQUU7WUFDdkIsTUFBTSxRQUFRLEdBQUcsS0FBSyxDQUFDLEdBQUcsQ0FBQyxDQUFDO1lBRTVCLFFBQVEsYUFBYSxFQUFFO2dCQUNyQixxQkFBK0IsQ0FBQyxDQUFDO29CQUMvQixPQUFPO3dCQUNMLFFBQVE7d0JBQ1IsT0FBTyxDQUNMLGtCQUFrQixHQUFHLFlBQVksRUFDakMsS0FBSyxDQUFDOzRCQUNKLEdBQUcsRUFBRSxJQUFJLENBQUMsUUFBUSxHQUFHLElBQUk7NEJBQ3pCLE1BQU0sRUFBRSxDQUFDO3lCQUNWLENBQUMsQ0FDSDtxQkFDRixDQUFDO2lCQUNIO2dCQUNELGtCQUE0QixDQUFDLENBQUM7b0JBQzVCLE9BQU8sQ0FBQyxRQUFRLEVBQUUsT0FBTyxDQUFDLGtCQUFrQixHQUFHLFlBQVksRUFBRSxZQUFZLENBQUMsQ0FBQyxDQUFDO2lCQUM3RTtnQkFDRDtvQkFDRSxPQUFPLENBQUMsWUFBWSxFQUFFLE9BQU8sQ0FBQyxLQUFLLEVBQUUsWUFBWSxDQUFDLENBQUMsQ0FBQzthQUN2RDtRQUNILENBQUMsQ0FBQztRQW5FQSxJQUFJLENBQUMsT0FBTyxHQUFHLEVBQUUsQ0FBQztJQUNwQixDQUFDO0lBRUQsV0FBVyxDQUFDLE9BQXNCOztRQUNoQyxJQUFJLE9BQU8sQ0FBQyxZQUFZLEVBQUU7WUFDeEIsSUFBSSxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsbUJBQW1CLENBQUMsQ0FBQztTQUNyQzthQUFNLElBQUksT0FBTyxDQUFDLG1CQUFtQixFQUFFO1lBQ3RDLElBQUksQ0FBQyxJQUFJLENBQUMsT0FBTyxhQUFQLE9BQU8sdUJBQVAsT0FBTyxDQUFFLG1CQUFtQixDQUFDLFlBQVksQ0FBQyxDQUFDO1NBQ3REO2FBQU0sSUFBSSxPQUFPLENBQUMseUJBQXlCLEVBQUU7WUFDNUMsSUFBSSxPQUFBLE9BQU8sQ0FBQyx5QkFBeUIsQ0FBQyxZQUFZLDBDQUFFLE1BQU0sTUFBSyxNQUFNLEVBQUU7Z0JBQ3JFLElBQUksQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLG1CQUFtQixDQUFDLENBQUM7YUFDckM7U0FDRjtJQUNILENBQUM7SUFFTyxJQUFJLENBQUMsUUFBNkI7UUFDeEMsSUFBSSxJQUFJLENBQUMsTUFBTSxFQUFFO1lBQ2YsSUFBSSxDQUFDLE1BQU0sQ0FBQyxPQUFPLEVBQUUsQ0FBQztTQUN2QjtRQUNELElBQUksUUFBUSxFQUFFO1lBQ1osTUFBTSxPQUFPLEdBQUcsSUFBSSxDQUFDLE9BQU8sQ0FBQyxLQUFLLENBQUMsUUFBUSxDQUFDLENBQUM7WUFDN0MsTUFBTSxNQUFNLEdBQUcsT0FBTyxDQUFDLE1BQU0sQ0FBQyxJQUFJLENBQUMsT0FBTyxDQUFDLGFBQWEsQ0FBQyxDQUFDO1lBQzFELE1BQU0sQ0FBQyxJQUFJLEVBQUUsQ0FBQztTQUNmO0lBQ0gsQ0FBQztJQUNPLElBQUksQ0FBQyxNQUFjO1FBQ3pCLElBQUksSUFBSSxDQUFDLFlBQVkscUJBQStCLEVBQUU7WUFDcEQsSUFBSSxDQUFDLFFBQVEsR0FBRyxNQUFNLEdBQUcsTUFBTSxHQUFHLENBQUMsQ0FBQztTQUNyQztRQUNELE1BQU0saUJBQWlCLEdBQXdCLElBQUksQ0FBQyxPQUFPLEVBQUUsQ0FBQztRQUM5RCxJQUFJLENBQUMsSUFBSSxDQUFDLGlCQUFpQixDQUFDLENBQUM7SUFDL0IsQ0FBQztJQUNPLE9BQU87UUFDYixNQUFNLFlBQVksR0FBRyxLQUFLLENBQUM7WUFDekIsR0FBRyxFQUFFLEdBQUc7WUFDUixLQUFLLEVBQUUsTUFBTTtZQUNiLElBQUksRUFBRSxHQUFHO1lBQ1QsTUFBTSxFQUFFLENBQUM7U0FDVixDQUFDLENBQUM7UUFDSCxPQUFPLElBQUksQ0FBQyxZQUFZLENBQUMsSUFBSSxDQUFDLFlBQVksRUFBRSxZQUFZLENBQUMsQ0FBQztJQUM1RCxDQUFDO0NBNEJGLENBQUE7O1lBckUrQixnQkFBZ0I7WUFBTSxVQUFVOztBQWxCckQ7SUFBUixLQUFLLEVBQUU7O2tEQUEwQztBQUd6QztJQUFSLEtBQUssRUFBRTs7a0RBQXdDO0FBR3ZDO0lBQVIsS0FBSyxFQUFFOzt5REFBc0M7QUFHckM7SUFBUixLQUFLLEVBQUU7OEJBQXFDLHlCQUF5QjsrREFBQztBQUc5RDtJQUFSLEtBQUssRUFBRTs7NENBQTBCO0FBZHZCLFlBQVk7SUFEeEIsU0FBUyxDQUFDLEVBQUUsUUFBUSxFQUFFLGdCQUFnQixFQUFFLENBQUM7cUNBcUJWLGdCQUFnQixFQUFNLFVBQVU7R0FwQm5ELFlBQVksQ0F5RnhCO1NBekZZLFlBQVkiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBEaXJlY3RpdmUsIEVsZW1lbnRSZWYsIElucHV0LCBPbkNoYW5nZXMsIFNpbXBsZUNoYW5nZXMgfSBmcm9tICdAYW5ndWxhci9jb3JlJztcclxuaW1wb3J0IHtcclxuICBhbmltYXRlLFxyXG4gIEFuaW1hdGlvbkJ1aWxkZXIsXHJcbiAgQW5pbWF0aW9uTWV0YWRhdGEsXHJcbiAgQW5pbWF0aW9uUGxheWVyLFxyXG4gIEFuaW1hdGlvblN0eWxlTWV0YWRhdGEsXHJcbiAgc3R5bGVcclxufSBmcm9tICdAYW5ndWxhci9hbmltYXRpb25zJztcclxuaW1wb3J0IHsgQXZsTm90aWZpY2F0aW9uIH0gZnJvbSAnQGF2bC1jb250cm9scy9pbnRlcmZhY2VzJztcclxuaW1wb3J0IHsgQU5JTUFUSU9OX0RVUkFUSU9OLCBNQVJHSU4gfSBmcm9tICcuLi9hdmwtbm90aWZpY2F0aW9uLWNvbnRhaW5lci5jb25zdHMnO1xyXG5pbXBvcnQgeyBTbmFja2Jhck1ldGhvZERlc2NyaXB0aW9uIH0gZnJvbSAnLi9zaG93LWhpZGUtc25hY2tiYXIuZGlyZWN0aXZlJztcclxuLyoqIEBoaWRkZW4gKi9cclxuZXhwb3J0IGNvbnN0IGVudW0gUG9zaXRpb25BbmltYXRpb24ge1xyXG4gIFRvTG93ZXJTdGFjayxcclxuICBUb1RvcCxcclxuICBUb0JvdHRvbSxcclxuICBUb1N0YWNrLFxyXG4gIEZyb21TdGFja1xyXG59XHJcbkBEaXJlY3RpdmUoeyBzZWxlY3RvcjogJ1thbmltYXRlU3RhY2tdJyB9KVxyXG5leHBvcnQgY2xhc3MgQW5pbWF0ZVN0YWNrIGltcGxlbWVudHMgT25DaGFuZ2VzIHtcclxuICAvKiogQGhpZGRlbiAqL1xyXG4gIEBJbnB1dCgpIHJlYWRvbmx5IGFuaW1hdGVTdGFjazogUG9zaXRpb25BbmltYXRpb247XHJcblxyXG4gIC8qKiBAaGlkZGVuICovXHJcbiAgQElucHV0KCkgcmVhZG9ubHkgbm90aWZpY2F0aW9uOiBBdmxOb3RpZmljYXRpb247XHJcblxyXG4gIC8qKiBAaGlkZGVuICovXHJcbiAgQElucHV0KCkgcmVhZG9ubHkgcHJldmlvdXNTdGFja0hlaWdodDogbnVtYmVyO1xyXG5cclxuICAvKiogQGhpZGRlbiAqL1xyXG4gIEBJbnB1dCgpIHJlYWRvbmx5IHNuYWNrYmFyTWV0aG9kRGVzY3JpcHRpb246IFNuYWNrYmFyTWV0aG9kRGVzY3JpcHRpb247XHJcblxyXG4gIC8qKiBAaGlkZGVuICovXHJcbiAgQElucHV0KCkgcmVhZG9ubHkgcmVvcGVuOiBib29sZWFuO1xyXG5cclxuICBwcml2YXRlIHN0eWxlVG9wOiBudW1iZXI7XHJcbiAgcHJpdmF0ZSBlbGVtZW50OiBFbGVtZW50UmVmO1xyXG4gIHByaXZhdGUgcGxheWVyOiBBbmltYXRpb25QbGF5ZXI7XHJcblxyXG4gIGNvbnN0cnVjdG9yKHJlYWRvbmx5IGJ1aWxkZXI6IEFuaW1hdGlvbkJ1aWxkZXIsIGVsOiBFbGVtZW50UmVmKSB7XHJcbiAgICB0aGlzLmVsZW1lbnQgPSBlbDtcclxuICB9XHJcblxyXG4gIG5nT25DaGFuZ2VzKGNoYW5nZXM6IFNpbXBsZUNoYW5nZXMpOiB2b2lkIHtcclxuICAgIGlmIChjaGFuZ2VzLmFuaW1hdGVTdGFjaykge1xyXG4gICAgICB0aGlzLm1vdmUodGhpcy5wcmV2aW91c1N0YWNrSGVpZ2h0KTtcclxuICAgIH0gZWxzZSBpZiAoY2hhbmdlcy5wcmV2aW91c1N0YWNrSGVpZ2h0KSB7XHJcbiAgICAgIHRoaXMubW92ZShjaGFuZ2VzPy5wcmV2aW91c1N0YWNrSGVpZ2h0LmN1cnJlbnRWYWx1ZSk7XHJcbiAgICB9IGVsc2UgaWYgKGNoYW5nZXMuc25hY2tiYXJNZXRob2REZXNjcmlwdGlvbikge1xyXG4gICAgICBpZiAoY2hhbmdlcy5zbmFja2Jhck1ldGhvZERlc2NyaXB0aW9uLmN1cnJlbnRWYWx1ZT8ubWV0aG9kID09PSAnc2hvdycpIHtcclxuICAgICAgICB0aGlzLm1vdmUodGhpcy5wcmV2aW91c1N0YWNrSGVpZ2h0KTtcclxuICAgICAgfVxyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgcHJpdmF0ZSBzaG93KG1ldGFkYXRhOiBBbmltYXRpb25NZXRhZGF0YVtdKSB7XHJcbiAgICBpZiAodGhpcy5wbGF5ZXIpIHtcclxuICAgICAgdGhpcy5wbGF5ZXIuZGVzdHJveSgpO1xyXG4gICAgfVxyXG4gICAgaWYgKG1ldGFkYXRhKSB7XHJcbiAgICAgIGNvbnN0IGZhY3RvcnkgPSB0aGlzLmJ1aWxkZXIuYnVpbGQobWV0YWRhdGEpO1xyXG4gICAgICBjb25zdCBwbGF5ZXIgPSBmYWN0b3J5LmNyZWF0ZSh0aGlzLmVsZW1lbnQubmF0aXZlRWxlbWVudCk7XHJcbiAgICAgIHBsYXllci5wbGF5KCk7XHJcbiAgICB9XHJcbiAgfVxyXG4gIHByaXZhdGUgbW92ZShoZWlnaHQ6IG51bWJlcikge1xyXG4gICAgaWYgKHRoaXMuYW5pbWF0ZVN0YWNrID09PSBQb3NpdGlvbkFuaW1hdGlvbi5Ub0JvdHRvbSkge1xyXG4gICAgICB0aGlzLnN0eWxlVG9wID0gaGVpZ2h0ICsgTUFSR0lOICogMjtcclxuICAgIH1cclxuICAgIGNvbnN0IGFuaW1hdGlvbk1ldGFkYXRhOiBBbmltYXRpb25NZXRhZGF0YVtdID0gdGhpcy5hbmltYXRlKCk7XHJcbiAgICB0aGlzLnNob3coYW5pbWF0aW9uTWV0YWRhdGEpO1xyXG4gIH1cclxuICBwcml2YXRlIGFuaW1hdGUoKTogQW5pbWF0aW9uTWV0YWRhdGFbXSB7XHJcbiAgICBjb25zdCBpbml0aWFsU3R5bGUgPSBzdHlsZSh7XHJcbiAgICAgIHRvcDogJzAnLFxyXG4gICAgICB3aWR0aDogJzEwMCUnLFxyXG4gICAgICBsZWZ0OiAnMCcsXHJcbiAgICAgIHpJbmRleDogMVxyXG4gICAgfSk7XHJcbiAgICByZXR1cm4gdGhpcy5nZXRBbmltYXRpb24odGhpcy5hbmltYXRlU3RhY2ssIGluaXRpYWxTdHlsZSk7XHJcbiAgfVxyXG5cclxuICBwcml2YXRlIGdldEFuaW1hdGlvbiA9IChcclxuICAgIGFuaW1hdGlvbk5hbWU6IFBvc2l0aW9uQW5pbWF0aW9uLFxyXG4gICAgaW5pdGlhbFN0eWxlOiBBbmltYXRpb25TdHlsZU1ldGFkYXRhXHJcbiAgKTogQW5pbWF0aW9uTWV0YWRhdGFbXSA9PiB7XHJcbiAgICBjb25zdCBhbGxTdHlsZSA9IHN0eWxlKCcqJyk7XHJcblxyXG4gICAgc3dpdGNoIChhbmltYXRpb25OYW1lKSB7XHJcbiAgICAgIGNhc2UgUG9zaXRpb25BbmltYXRpb24uVG9Cb3R0b206IHtcclxuICAgICAgICByZXR1cm4gW1xyXG4gICAgICAgICAgYWxsU3R5bGUsXHJcbiAgICAgICAgICBhbmltYXRlKFxyXG4gICAgICAgICAgICBBTklNQVRJT05fRFVSQVRJT04gKyAnbXMgZWFzZS1pbicsXHJcbiAgICAgICAgICAgIHN0eWxlKHtcclxuICAgICAgICAgICAgICB0b3A6IHRoaXMuc3R5bGVUb3AgKyAncHgnLFxyXG4gICAgICAgICAgICAgIHpJbmRleDogMFxyXG4gICAgICAgICAgICB9KVxyXG4gICAgICAgICAgKVxyXG4gICAgICAgIF07XHJcbiAgICAgIH1cclxuICAgICAgY2FzZSBQb3NpdGlvbkFuaW1hdGlvbi5Ub1RvcDoge1xyXG4gICAgICAgIHJldHVybiBbYWxsU3R5bGUsIGFuaW1hdGUoQU5JTUFUSU9OX0RVUkFUSU9OICsgJ21zIGVhc2UtaW4nLCBpbml0aWFsU3R5bGUpXTtcclxuICAgICAgfVxyXG4gICAgICBkZWZhdWx0OlxyXG4gICAgICAgIHJldHVybiBbaW5pdGlhbFN0eWxlLCBhbmltYXRlKCcwbXMnLCBpbml0aWFsU3R5bGUpXTtcclxuICAgIH1cclxuICB9O1xyXG59XHJcbiJdfQ==