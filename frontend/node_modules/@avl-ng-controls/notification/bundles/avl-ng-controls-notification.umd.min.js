!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("@angular/common"),require("@angular/core"),require("@ngx-translate/core"),require("@avl-controls/ng-binders"),require("@angular/forms"),require("@angular/animations"),require("rxjs"),require("@avl-controls/core/dist/avl-snackbar/avl-snackbar"),require("rxjs/operators"),require("@avl-controls/datatable/dist/avl-datatable/avl-datatable"),require("@avl-controls/core/dist/avl-icon-button/avl-icon-button"),require("@avl-controls/core/dist/avl-icon/avl-icon"),require("@avl-controls/core/dist/avl-side-sheet/avl-side-sheet"),require("@avl-controls/core/dist/avl-checkbox/avl-checkbox"),require("@avl-controls/core/dist/avl-tooltip/avl-tooltip"),require("@avl-controls/core/dist/avl-date/avl-date"),require("@avl-controls/datatable/dist/avl-datatable/column-definitions"),require("@avl-ng-controls/dialog"),require("@avl-ng-controls/navigation")):"function"==typeof define&&define.amd?define("@avl-ng-controls/notification",["exports","@angular/common","@angular/core","@ngx-translate/core","@avl-controls/ng-binders","@angular/forms","@angular/animations","rxjs","@avl-controls/core/dist/avl-snackbar/avl-snackbar","rxjs/operators","@avl-controls/datatable/dist/avl-datatable/avl-datatable","@avl-controls/core/dist/avl-icon-button/avl-icon-button","@avl-controls/core/dist/avl-icon/avl-icon","@avl-controls/core/dist/avl-side-sheet/avl-side-sheet","@avl-controls/core/dist/avl-checkbox/avl-checkbox","@avl-controls/core/dist/avl-tooltip/avl-tooltip","@avl-controls/core/dist/avl-date/avl-date","@avl-controls/datatable/dist/avl-datatable/column-definitions","@avl-ng-controls/dialog","@avl-ng-controls/navigation"],e):e(((t=t||self)["avl-ng-controls"]=t["avl-ng-controls"]||{},t["avl-ng-controls"].notification={}),t.ng.common,t.ng.core,t.core$1,t.ngBinders,t.ng.forms,t.ng.animations,t.rxjs,null,t.rxjs.operators,null,null,null,null,null,null,null,t.columnDefinitions,t.dialog,t.navigation)}(this,(function(t,e,n,i,o,a,r,c,l,s,d,u,f,p,v,h,g,m,y,b){"use strict";var k,w,S,x,D=[{items:[{label:"VizBox.NotificationMenu.MarkAllAsRead",action:"markAllAsRead"},{label:"VizBox.NotificationMenu.MarkAllAsUnread",action:"markAllAsUnread"}]}],N=((k={})[0]="cancel",k[1]="warning",k[2]="info-outline",k[3]="check",k),I=this&&this.__assign||function(){return(I=Object.assign||function(t){for(var e,n=1,i=arguments.length;n<i;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},O=this&&this.__decorate||function(t,e,n,i){var o,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,n,i);else for(var c=t.length-1;c>=0;c--)(o=t[c])&&(r=(a<3?o(r):a>3?o(e,n,r):o(e,n))||r);return a>3&&r&&Object.defineProperty(e,n,r),r},C=this&&this.__metadata||function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},E=this&&this.__awaiter||function(t,e,n,i){return new(n||(n=Promise))((function(o,a){function r(t){try{l(i.next(t))}catch(t){a(t)}}function c(t){try{l(i.throw(t))}catch(t){a(t)}}function l(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(r,c)}l((i=i.apply(t,e||[])).next())}))},R=this&&this.__generator||function(t,e){var n,i,o,a,r={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function c(a){return function(c){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,i&&(o=2&a[0]?i.return:a[0]?i.throw||((o=i.return)&&o.call(i),0):i.next)&&!(o=o.call(i,a[1])).done)return o;switch(i=0,o&&(a=[2&a[0],o.value]),a[0]){case 0:case 1:o=a;break;case 4:return r.label++,{value:a[1],done:!1};case 5:r.label++,i=a[1],a=[0];continue;case 7:a=r.ops.pop(),r.trys.pop();continue;default:if(!(o=r.trys,(o=o.length>0&&o[o.length-1])||6!==a[0]&&2!==a[0])){r=0;continue}if(3===a[0]&&(!o||a[1]>o[0]&&a[1]<o[3])){r.label=a[1];break}if(6===a[0]&&r.label<o[1]){r.label=o[1],o=a;break}if(o&&r.label<o[2]){r.label=o[2],r.ops.push(a);break}o[2]&&r.ops.pop(),r.trys.pop();continue}a=e.call(t,r)}catch(t){a=[6,t],i=0}finally{n=o=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,c])}}},A=this&&this.__read||function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var i,o,a=n.call(t),r=[];try{for(;(void 0===e||e-- >0)&&!(i=a.next()).done;)r.push(i.value)}catch(t){o={error:t}}finally{try{i&&!i.done&&(n=a.return)&&n.call(a)}finally{if(o)throw o.error}}return r},L=this&&this.__spread||function(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(A(arguments[e]));return t},T=function(){function t(){var t=this;this.open=!1,this.openChange=new n.EventEmitter,this.openDetails=new n.EventEmitter,this.notificationStateChanged=new n.EventEmitter,this.markAllAsRead=new n.EventEmitter,this.markAllAsUnread=new n.EventEmitter,this.overflowMenuItems=[],this.notificationList=[],this.numberOfUnreadNotifications=0,this.overflowMenuHandlers={markAllAsRead:function(){t.markAllAsRead.emit(),t.numberOfUnreadNotifications=0},markAllAsUnread:function(){t.markAllAsUnread.emit(),t.numberOfUnreadNotifications=t.notificationList.length},undefined:function(){}},this.translateLabels()}return Object.defineProperty(t.prototype,"notifications",{set:function(t){this.notificationList=this.prepareNotifications(t),this.numberOfUnreadNotifications=t.filter((function(t){return!t.read})).length},enumerable:!0,configurable:!0}),t.prototype.ngAfterViewInit=function(){this.list.nativeElement.revertedList=!0},t.prototype.onNotificationStateChanged=function(t){var e=I({},t.detail.value),n=I(I({},e),{read:e.iconToggleValue});n.read?this.numberOfUnreadNotifications--:this.numberOfUnreadNotifications++,this.notificationStateChanged.emit(n),this.list.nativeElement.removeFocus()},t.prototype.onItemClicked=function(t){this.overflowMenuHandlers[t.action]()},t.prototype.onOpenChanged=function(t){t.detail.value?this.notificationList=L(this.notificationList):this.openChange.emit(!1)},t.prototype.onOverflowMenuClicked=function(){this.list.nativeElement.removeFocus()},t.prototype.onDetailsClicked=function(){this.open=!1,this.openDetails.emit(),this.openChange.emit(!1)},t.prototype.prepareNotifications=function(t){var e=this;return t.map((function(t){return I(I({},t),{label:t.messageText,sublabel:e.formatDateTime(t.timestamp),icon:N[t.type],iconToggleUnchecked:"mail",iconToggleChecked:"communication:mail-outline",iconToggleValue:t.read})}))},t.prototype.formatDateTime=function(t){return null===t?"":AvlLocalizationService.formatDateTime(t,{format:"date-short"})+" "+AvlLocalizationService.formatDateTime(t,{format:"time-long"})},t.prototype.translateLabels=function(){return E(this,void 0,void 0,(function(){var t;return R(this,(function(e){switch(e.label){case 0:return AvlLocalizationService&&AvlLocalizationService.translationService?(t=this,[4,this.translateMenu(D)]):[2];case 1:return t.overflowMenuItems=e.sent(),[2]}}))}))},t.prototype.translateMenu=function(t){return E(this,void 0,void 0,(function(){var e=this;return R(this,(function(n){switch(n.label){case 0:return[4,Promise.all(t.map((function(t){return E(e,void 0,void 0,(function(){return R(this,(function(e){switch(e.label){case 0:return[4,this.translateMenuGroup(t)];case 1:return[2,e.sent()]}}))}))})))];case 1:return[2,n.sent()]}}))}))},t.prototype.translateMenuGroup=function(t){return E(this,void 0,void 0,(function(){var e,n=this;return R(this,(function(i){switch(i.label){case 0:return e={},[4,Promise.all(t.items.map((function(t){return E(n,void 0,void 0,(function(){return R(this,(function(e){switch(e.label){case 0:return[4,this.translateMenuItem(t)];case 1:return[2,e.sent()]}}))}))})))];case 1:return[2,(e.items=i.sent(),e)]}}))}))},t.prototype.translateMenuItem=function(t){return E(this,void 0,void 0,(function(){var e,n,i,o;return R(this,(function(a){switch(a.label){case 0:return e=AvlLocalizationService.translationService,n=[I({},t)],i={},[4,e.translate(t.label)];case 1:return i.label=a.sent(),t.sublabel?[4,e.translate(t.sublabel)]:[3,3];case 2:return o=a.sent(),[3,4];case 3:o=null,a.label=4;case 4:return[2,I.apply(void 0,n.concat([(i.sublabel=o,i)]))]}}))}))},O([n.Input(),C("design:type",Boolean)],t.prototype,"open",void 0),O([n.Input(),C("design:type",HTMLElement)],t.prototype,"trigger",void 0),O([n.Input(),C("design:type",Array),C("design:paramtypes",[Array])],t.prototype,"notifications",null),O([n.Output(),C("design:type",Object)],t.prototype,"openChange",void 0),O([n.Output(),C("design:type",Object)],t.prototype,"openDetails",void 0),O([n.Output(),C("design:type",Object)],t.prototype,"notificationStateChanged",void 0),O([n.Output(),C("design:type",Object)],t.prototype,"markAllAsRead",void 0),O([n.Output(),C("design:type",Object)],t.prototype,"markAllAsUnread",void 0),O([n.ViewChild("list"),C("design:type",n.ElementRef)],t.prototype,"list",void 0),t=O([n.Component({selector:"avl-notification-menu",template:'<avl-popup\r\n  [noCloseOnInsideClick]="true"\r\n  [open]="open"\r\n  [trigger]="trigger"\r\n  (open-changed)="onOpenChanged($event)"\r\n>\r\n  <div id="header">\r\n    <div id="headerText">\r\n      <span>{{ \'VizBox.NotificationMenu.Notifications\' | translate }}</span>\r\n      <span *ngIf="numberOfUnreadNotifications"> ({{ numberOfUnreadNotifications }}) </span>\r\n    </div>\r\n    <avl-overflow-menu (itemClicked)="onItemClicked($event)" [items]="overflowMenuItems">\r\n      <avl-icon-button\r\n        icon="more-vert"\r\n        slot="trigger"\r\n        (click)="onOverflowMenuClicked()"\r\n      ></avl-icon-button>\r\n    </avl-overflow-menu>\r\n  </div>\r\n  <avl-list\r\n    #list\r\n    [rows]="notificationList"\r\n    (row-changed)="onNotificationStateChanged($event)"\r\n  ></avl-list>\r\n  <div id="footer">\r\n    <avl-button (click)="onDetailsClicked()">{{ \'VizBox.NotificationMenu.Details\' | translate }}</avl-button>\r\n  </div>\r\n</avl-popup>\r\n',styles:["avl-popup{width:40%}avl-list{width:100%;height:250px;padding-top:8px;--avl-item-padding-left:16px;--avl-item-padding-right:16px;--notification-item-height:48px}#header{display:flex;align-items:center;justify-content:space-between;box-sizing:border-box;height:56px;padding:0 16px;border-bottom:1px solid var(--avl-overflow-menu-divider-color,var(--avl-divider-color))}#footer{display:flex;align-items:center;box-sizing:border-box;height:56px;border-top:1px solid var(--avl-overflow-menu-divider-color,var(--avl-divider-color))}#headerText{font-size:20px;color:var(--avl-primary-text-color);overflow:hidden;white-space:nowrap;text-overflow:ellipsis}"]}),C("design:paramtypes",[])],t)}(),B=this&&this.__decorate||function(t,e,n,i){var o,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,n,i);else for(var c=t.length-1;c>=0;c--)(o=t[c])&&(r=(a<3?o(r):a>3?o(e,n,r):o(e,n))||r);return a>3&&r&&Object.defineProperty(e,n,r),r},_=this&&this.__metadata||function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},z=function(){function t(){var t=this;this.getInfoHeight=function(){return t.infoStackHeight>t.infoStackIndicatorHeight?t.infoStackHeight:t.infoStackIndicatorHeight},this.getWarningHeight=function(){return t.warningStackHeight>t.warningStackIndicatorHeight?t.warningStackHeight:t.warningStackIndicatorHeight},this.getOffsetHeight=function(t){return t?t+24:0}}return t.prototype.ngOnChanges=function(t){var e=this.getOffsetHeight(this.getInfoHeight()),n=this.getOffsetHeight(this.getWarningHeight());this.styleTop=e+n+"px"},B([n.Input(),_("design:type",Number)],t.prototype,"increment",void 0),B([n.Input(),_("design:type",Number)],t.prototype,"infoStackHeight",void 0),B([n.Input(),_("design:type",Number)],t.prototype,"warningStackHeight",void 0),B([n.Input(),_("design:type",Number)],t.prototype,"infoStackIndicatorHeight",void 0),B([n.Input(),_("design:type",Number)],t.prototype,"warningStackIndicatorHeight",void 0),B([n.HostBinding("style.top"),_("design:type",String)],t.prototype,"styleTop",void 0),t=B([n.Directive({selector:"[animateButton]"}),_("design:paramtypes",[])],t)}(),j=this&&this.__decorate||function(t,e,n,i){var o,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,n,i);else for(var c=t.length-1;c>=0;c--)(o=t[c])&&(r=(a<3?o(r):a>3?o(e,n,r):o(e,n))||r);return a>3&&r&&Object.defineProperty(e,n,r),r},V=this&&this.__metadata||function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},M=function(){function t(t,e){var n=this;this.builder=t,this.defaultClass=!0,this.getAnimation=function(t,e){var i=n.element.nativeElement.offsetWidth-36,o=r.style({marginTop:"12px",marginLeft:"12px",marginRight:"12px",width:i+"px"});switch(t){case 4:return[r.animate("400ms ease-in",o),e];case 3:return[e,r.animate("400ms ease-in",o)];default:return[e,r.animate("1ms ease-in",e)]}},this.element=e}return t.prototype.ngOnChanges=function(t){t.animateSnackbar&&((3===t.animateSnackbar.currentValue||3===t.animateSnackbar.previousValue)&&this.move())},t.prototype.show=function(t){(this.player&&this.player.destroy(),t)&&this.builder.build(t).create(this.element.nativeElement).play()},t.prototype.move=function(){var t=this.animate();this.show(t)},t.prototype.animate=function(){var t=r.style({marginTop:"0",width:"100%",marginLeft:"0",marginRight:"0"});return this.getAnimation(this.animateSnackbar,t)},t.ctorParameters=function(){return[{type:r.AnimationBuilder},{type:n.ElementRef}]},j([n.Input(),V("design:type",Number)],t.prototype,"animateSnackbar",void 0),j([n.Input(),V("design:type",Number)],t.prototype,"positionAnimation",void 0),j([n.Input("notification"),V("design:type",Object)],t.prototype,"notification",void 0),j([n.Input("reopen"),V("design:type",Boolean)],t.prototype,"reopen",void 0),j([n.HostBinding("class.in-stack"),V("design:type",Boolean)],t.prototype,"inStack",void 0),j([n.HostBinding("class.no-animation"),V("design:type",Boolean)],t.prototype,"noAnimation",void 0),j([n.HostBinding("class.snackbar-container"),V("design:type",Object)],t.prototype,"defaultClass",void 0),t=j([n.Directive({selector:"[animateSnackbar]"}),V("design:paramtypes",[r.AnimationBuilder,n.ElementRef])],t)}(),H=this&&this.__decorate||function(t,e,n,i){var o,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,n,i);else for(var c=t.length-1;c>=0;c--)(o=t[c])&&(r=(a<3?o(r):a>3?o(e,n,r):o(e,n))||r);return a>3&&r&&Object.defineProperty(e,n,r),r},F=this&&this.__metadata||function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},P=function(t,e){this.method=t,this.animate=e},$=function(){function t(t){this.element=t}return t.prototype.ngOnChanges=function(t){var e,n,i,o,a=this;t.methodDescription&&("show"===(null===(e=t.methodDescription.currentValue)||void 0===e?void 0:e.method)?setTimeout((function(){var e,n;return null===(e=a.element.nativeElement)||void 0===e?void 0:e.showSnackbar("relative",!(null===(n=t.methodDescription.currentValue)||void 0===n?void 0:n.animate))}),0):"hide"===(null===(n=t.methodDescription.currentValue)||void 0===n?void 0:n.method)&&(null===(i=this.element.nativeElement)||void 0===i||i.hideSnackbar(null===(o=t.methodDescription.currentValue)||void 0===o?void 0:o.animate)))},t.ctorParameters=function(){return[{type:n.ElementRef}]},H([n.Input(),F("design:type",P)],t.prototype,"methodDescription",void 0),t=H([n.Directive({selector:"[showHideSnackbar]"}),F("design:paramtypes",[n.ElementRef])],t)}(),U=this&&this.__decorate||function(t,e,n,i){var o,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,n,i);else for(var c=t.length-1;c>=0;c--)(o=t[c])&&(r=(a<3?o(r):a>3?o(e,n,r):o(e,n))||r);return a>3&&r&&Object.defineProperty(e,n,r),r},G=this&&this.__metadata||function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},q=function(){function t(t,e){var n=this;this.builder=t,this.getAnimation=function(t,e){var i=r.style("*");switch(t){case 2:return[i,r.animate("400ms ease-in",r.style({top:n.styleTop+"px",zIndex:0}))];case 1:return[i,r.animate("400ms ease-in",e)];default:return[e,r.animate("0ms",e)]}},this.element=e}return t.prototype.ngOnChanges=function(t){var e;t.animateStack?this.move(this.previousStackHeight):t.previousStackHeight?this.move(null==t?void 0:t.previousStackHeight.currentValue):t.snackbarMethodDescription&&"show"===(null===(e=t.snackbarMethodDescription.currentValue)||void 0===e?void 0:e.method)&&this.move(this.previousStackHeight)},t.prototype.show=function(t){(this.player&&this.player.destroy(),t)&&this.builder.build(t).create(this.element.nativeElement).play()},t.prototype.move=function(t){2===this.animateStack&&(this.styleTop=t+24);var e=this.animate();this.show(e)},t.prototype.animate=function(){var t=r.style({top:"0",width:"100%",left:"0",zIndex:1});return this.getAnimation(this.animateStack,t)},t.ctorParameters=function(){return[{type:r.AnimationBuilder},{type:n.ElementRef}]},U([n.Input(),G("design:type",Number)],t.prototype,"animateStack",void 0),U([n.Input(),G("design:type",Object)],t.prototype,"notification",void 0),U([n.Input(),G("design:type",Number)],t.prototype,"previousStackHeight",void 0),U([n.Input(),G("design:type",P)],t.prototype,"snackbarMethodDescription",void 0),U([n.Input(),G("design:type",Boolean)],t.prototype,"reopen",void 0),t=U([n.Directive({selector:"[animateStack]"}),G("design:paramtypes",[r.AnimationBuilder,n.ElementRef])],t)}(),W=this&&this.__decorate||function(t,e,n,i){var o,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,n,i);else for(var c=t.length-1;c>=0;c--)(o=t[c])&&(r=(a<3?o(r):a>3?o(e,n,r):o(e,n))||r);return a>3&&r&&Object.defineProperty(e,n,r),r},X=this&&this.__metadata||function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},Y=function(){function t(){this.notificationClicked=new n.EventEmitter,this.buttonClicked=new n.EventEmitter,this.notificationDismissed=new n.EventEmitter}return t.prototype.onNotificationClicked=function(t){this.notificationClicked.emit(t)},t.prototype.onButtonClicked=function(t){t instanceof Event&&this.buttonClicked.emit(t)},t.prototype.onNotificationDismissed=function(t){t instanceof Event&&this.notificationDismissed.emit(t)},W([n.Output(),X("design:type",n.EventEmitter)],t.prototype,"notificationClicked",void 0),W([n.Output(),X("design:type",n.EventEmitter)],t.prototype,"buttonClicked",void 0),W([n.Output(),X("design:type",n.EventEmitter)],t.prototype,"notificationDismissed",void 0),W([n.HostListener("notification-clicked",["$event"]),X("design:type",Function),X("design:paramtypes",[Event]),X("design:returntype",void 0)],t.prototype,"onNotificationClicked",null),W([n.HostListener("button-clicked",["$event"]),X("design:type",Function),X("design:paramtypes",[Event]),X("design:returntype",void 0)],t.prototype,"onButtonClicked",null),W([n.HostListener("notification-dismissed",["$event"]),X("design:type",Function),X("design:paramtypes",[Event]),X("design:returntype",void 0)],t.prototype,"onNotificationDismissed",null),t=W([n.Directive({selector:"[snackbarListener]"})],t)}(),K=this&&this.__awaiter||function(t,e,n,i){return new(n||(n=Promise))((function(o,a){function r(t){try{l(i.next(t))}catch(t){a(t)}}function c(t){try{l(i.throw(t))}catch(t){a(t)}}function l(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(r,c)}l((i=i.apply(t,e||[])).next())}))},J=this&&this.__generator||function(t,e){var n,i,o,a,r={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function c(a){return function(c){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,i&&(o=2&a[0]?i.return:a[0]?i.throw||((o=i.return)&&o.call(i),0):i.next)&&!(o=o.call(i,a[1])).done)return o;switch(i=0,o&&(a=[2&a[0],o.value]),a[0]){case 0:case 1:o=a;break;case 4:return r.label++,{value:a[1],done:!1};case 5:r.label++,i=a[1],a=[0];continue;case 7:a=r.ops.pop(),r.trys.pop();continue;default:if(!(o=r.trys,(o=o.length>0&&o[o.length-1])||6!==a[0]&&2!==a[0])){r=0;continue}if(3===a[0]&&(!o||a[1]>o[0]&&a[1]<o[3])){r.label=a[1];break}if(6===a[0]&&r.label<o[1]){r.label=o[1],o=a;break}if(o&&r.label<o[2]){r.label=o[2],r.ops.push(a);break}o[2]&&r.ops.pop(),r.trys.pop();continue}a=e.call(t,r)}catch(t){a=[6,t],i=0}finally{n=o=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,c])}}},Q=function(){function t(t){var e=this;this.notificationList=[],this.activeNotification$=new c.BehaviorSubject(void 0),this.stackIndicator=!1,this.actionButtonMessage="_X more _TYPE notifications",this.openNextNotification=function(t){e.methodDescription=new P("show",!e.reopen),e.reopen?e.stackAnimation=4:e.stackAnimation=1,e.setStackIndicatorProperties(t),e.reopen=!1,e.dismissedSilently=!1},this.resetValues=function(){e.notificationList=[],e.previousNotification=void 0,e.stackIndicator=void 0},this.setStackIndicatorProperties=function(t){var n=e.notificationList.length;e.stackIndicator=n>1;var i=setTimeout((function(){e.previousNotification=e.notificationList[n-1],e.buttonLabel=e.setButtonLabel(n,t),e.stackIndicatorButtonLabel=e.setButtonLabel(n-1,t),clearTimeout(i)}),e.previousNotification?400:0)},this.setButtonLabel=function(t,n){return t>0?e.actionButtonMessage.replace("_TYPE ","info"===n?"":n+" ").replace("_X",String(t)):null},this.translateLabels(),this.methodDescription=new P(void 0,void 0),this.activeNotification$.pipe(s.skipWhile((function(t){return void 0===t}))).subscribe((function(n){if(n)if(e.notificationList.length>0)var i=setTimeout((function(){e.openNextNotification(t),clearTimeout(i)}),e.previousNotification?400:0);else e.openNextNotification(t);else e.resetValues()}))}return t.prototype.translateLabels=function(){return K(this,void 0,void 0,(function(){var t,e;return J(this,(function(n){switch(n.label){case 0:return AvlLocalizationService&&AvlLocalizationService.translationService?(t=AvlLocalizationService.translationService,e=this,[4,t.translate("VizBox.NotificationContainer._X_more_TYPE_notifications")]):[2];case 1:return e.actionButtonMessage=n.sent(),[2]}}))}))},t}(),Z=this&&this.__decorate||function(t,e,n,i){var o,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,n,i);else for(var c=t.length-1;c>=0;c--)(o=t[c])&&(r=(a<3?o(r):a>3?o(e,n,r):o(e,n))||r);return a>3&&r&&Object.defineProperty(e,n,r),r},tt=this&&this.__metadata||function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},et=new Map([[0,"Error"],[1,"Warning"],[2,"Info"],[3,"OK"]]),nt=function(){function t(t){var e=this;this.cdRef=t,this.notification$=new c.Observable((function(t){var e=0,n=setInterval((function(){var n=Math.round(Math.random());t.next({id:e++,module:"notification-container",timestamp:new Date,type:n?1:2,messageText:"Snackbar with notification"+(new Date).toTimeString(),read:!1,link:"https://vizbox.avl.com"})}),3e3);setTimeout((function(){clearInterval(n)}),1e5)})),this.openMenu=new n.EventEmitter,this.stackHeight={},this.notificationList=[],this.destroyed$=new c.Subject,this.onButtonClicked=function(t){t&&(e.openMenu.emit(),e.dismissAll())},this.onNotificationDismissed=function(t,n){var i,o;if(t){var a=null===(o=null===(i=t.target)||void 0===i?void 0:i.id)||void 0===o?void 0:o.replace("Snackbar","");e.removeNotification(n,a)}},this.openFromStack=function(t){var n=e.getStackName(t.type);e[n].methodDescription=new P("hide",!0)},this.dismissAll=function(){e.notificationList=[],e.warningStack.activeNotification$.next(void 0),e.infoStack.activeNotification$.next(void 0)},this.handleNotification=function(t){e.previousNotification=e.notificationList[e.notificationList.length-1],e.notificationList.push(t),e.updateStackActiveNotification(t),e.setStackAnimation(t.type)},this.updateStackActiveNotification=function(t){var n,i=e.getStack(null==t?void 0:t.type);if(e.updateStackNotificationList(t.type),e.activeNotification=t,e[i].notificationList.length>1)if(e.reopen=!0,(null===(n=e.previousNotification)||void 0===n?void 0:n.type)===t.type){e[i].snackbarAnimation=3;var o=setTimeout((function(){e.silentlyDismissNotification(i),e[i].snackbarAnimation=null,clearTimeout(o)}),400)}else e.silentlyDismissNotification(i);else e[i].activeNotification$.next(t)},this.updateStackNotificationList=function(t){var n=e[e.getStack(t)];return n&&(n.notificationList=e.notificationList.filter((function(e){return e.type===t}))),n.notificationList},this.silentlyDismissNotification=function(t){e[t].dismissedSilently=!0,e[t].methodDescription=new P("hide",!1)},this.setStackAnimation=function(t,n){var i,o,a,r=e.getStack(t),c=e.getStack(t,!0);(null===(o=null===(i=e[c])||void 0===i?void 0:i.notificationList)||void 0===o?void 0:o.length)>0&&(null===(a=e.previousNotification)||void 0===a?void 0:a.type)!==t&&(e[c].stackAnimation=n||2,e[r].stackAnimation=1===n?2:1)},this.removeNotification=function(t,n){var i,o=e.getStack(null==t?void 0:t.type);if(e[o].dismissedSilently){var a=e.getStack(null===(i=e.activeNotification)||void 0===i?void 0:i.type);e[a].activeNotification$.next(e.activeNotification),e.reopen=!1}else e.notificationList=e.notificationList.filter((function(e){return e.id!==t.id})),e.reopenLastNotification(t,o)},this.reopenLastNotification=function(t,n){var i,o=null===(i=e[n])||void 0===i?void 0:i.notificationList;if(e.isLastNotificationDismissed(t,e[n])&&(null==o?void 0:o.length)>0){e[n].reopen=!0;var a=(o=e.updateStackNotificationList(t.type))[o.length-1];a?e[n].activeNotification$.next(a):(e[n].stackIndicator=!1,e[n].reopen=!1,e[n].animateStack=2,e.setStackAnimation(t.type,1))}},this.isLastNotificationDismissed=function(t,e){var n=e.notificationList[e.notificationList.length-1];return(null==n?void 0:n.id)===(null==t?void 0:t.id)},this.getStackName=function(t){return 1===t?"warningStack":"infoStack"},this.warningStack=new Q(String(et.get(1)).toLowerCase()),this.infoStack=new Q(String(et.get(2)).toLowerCase())}return t.prototype.ngOnDestroy=function(){this.destroyed$.next(),this.destroyed$.complete()},t.prototype.ngAfterViewChecked=function(){this.cdRef.detectChanges()},t.prototype.ngOnInit=function(){var t,e,n=this;this.positionTop=(null===(t=document.querySelector("main"))||void 0===t?void 0:t.offsetTop)+12+"px",null===(e=this.notification$)||void 0===e||e.pipe(s.takeUntil(this.destroyed$)).subscribe((function(t){n.handleNotification(t)}))},t.prototype.getStack=function(t,e){var n;return n=1===t||0===t?e?2:1:e?1:2,this.getStackName(n)},t.ctorParameters=function(){return[{type:n.ChangeDetectorRef}]},Z([n.HostBinding("style.top"),tt("design:type",String)],t.prototype,"positionTop",void 0),Z([n.ViewChild("warningStackElement"),tt("design:type",n.ElementRef)],t.prototype,"warningStackElement",void 0),Z([n.ViewChild("infoStackElement"),tt("design:type",n.ElementRef)],t.prototype,"infoStackElement",void 0),Z([n.ViewChild("infoStackIndicatorElement"),tt("design:type",n.ElementRef)],t.prototype,"infoStackIndicatorElement",void 0),Z([n.ViewChild("infoStackIndicatorElement"),tt("design:type",n.ElementRef)],t.prototype,"warningStackIndicatorElement",void 0),Z([n.Input("display-icon"),tt("design:type",Boolean)],t.prototype,"displayIcon",void 0),Z([n.Input("notification$"),tt("design:type",c.Observable)],t.prototype,"notification$",void 0),Z([n.Output(),tt("design:type",n.EventEmitter)],t.prototype,"openMenu",void 0),t=Z([n.Component({selector:"avl-notification-container",template:'<div class="snackbar" *ngIf="notification$ | async as notification">\r\n  <div\r\n    [animateStack]="warningStack?.stackAnimation"\r\n    [previousStackHeight] = "infoStack.notificationList.length>0 ? infoSnackElement.offsetHeight : 0"\r\n    [snackbarMethodDescription] = "warningStack.methodDescription"\r\n    class="snackbar-stack"\r\n    id="warningStack"\r\n    #warningStackElement\r\n  >\r\n    <div [animateSnackbar]="warningStack.snackbarAnimation" id="warningSnack" #warningSnackElement>\r\n      <avl-snackbar\r\n        *ngIf="warningStack.activeNotification$ | async as activeWarningNotification"\r\n        id="warningSnackbar"\r\n        [message]="activeWarningNotification?.messageText"\r\n        [actionButtonLabel]="warningStack.stackIndicatorButtonLabel"\r\n        [link]="activeWarningNotification.link"\r\n        [messageType]="activeWarningNotification.type"\r\n        sliding\r\n        (buttonClicked)="onButtonClicked($event)"\r\n        (notificationDismissed)="onNotificationDismissed($event, activeWarningNotification)"\r\n        snackbarListener\r\n        #warningSnackbar\r\n        showHideSnackbar="warningSnackbar"\r\n        [methodDescription]="warningStack.methodDescription"\r\n      ></avl-snackbar>\r\n    </div>\r\n\r\n    <div class="stack-indicator-container" *ngIf="warningStack.notificationList.length>1" #warningStackIndicator>\r\n      <div class="stack-indicator">\r\n        <div class="notification-container">\r\n          <div [ngClass]="{\'notification\': true, \'has-action\': warningStack.stackIndicatorButtonLabel}">\r\n            <avl-icon icon="icons:warning" id="warningIcon" class="warning"></avl-icon>\r\n            <p id="snackbarMessage">{{ warningStack.previousNotification?.messageText }}</p>\r\n            <avl-icon-button id="closeButton" icon="icons:close"></avl-icon-button>\r\n          </div>\r\n          <button id="actionButton" *ngIf="warningStack.stackIndicatorButtonLabel" (click)="openFromStack(warningStack.previousNotification)">\r\n            <div class="button-label">{{ warningStack.stackIndicatorButtonLabel }}</div>\r\n          </button>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n  <div\r\n    class="snackbar-stack"\r\n    id="infoStack"\r\n    [animateStack]="infoStack?.stackAnimation"\r\n    [previousStackHeight] = "infoStack.notificationList.length>0 ? warningSnackElement.offsetHeight : 0"\r\n    [snackbarMethodDescription] = "infoStack.methodDescription"\r\n    #infoStackElement\r\n  >\r\n    <div [animateSnackbar]="infoStack.snackbarAnimation" id="infoSnack" #infoSnackElement>\r\n      <avl-snackbar\r\n        id="infoSnackbar"\r\n        *ngIf="infoStack.activeNotification$ | async as activeInfoNotification"\r\n        [message]="activeInfoNotification.messageText"\r\n        [actionButtonLabel]="infoStack.stackIndicatorButtonLabel"\r\n        [link]="activeInfoNotification.link"\r\n        [messageType]="activeInfoNotification.type"\r\n        [displayIcon]="displayIcon"\r\n        sliding\r\n        (buttonClicked)="onButtonClicked($event)"\r\n        (notificationDismissed)="onNotificationDismissed($event, activeInfoNotification)"\r\n        snackbarListener\r\n        #infoSnackbar\r\n        showHideSnackbar="infoSnackbar"\r\n        [methodDescription]="infoStack.methodDescription"\r\n      ></avl-snackbar>\r\n    </div>\r\n\r\n    <div class="stack-indicator-container" *ngIf="infoStack.notificationList.length>1" #infoStackIndicator>\r\n      <div class="stack-indicator">\r\n        <div class="notification-container">\r\n          <div [ngClass]="{\'notification\': true, \'has-action\': infoStack.stackIndicatorButtonLabel}">\r\n            <p id="snackbarMessage">{{ infoStack.previousNotification?.messageText }}</p>\r\n            <avl-icon-button id="closeButton" icon="icons:close"></avl-icon-button>\r\n          </div>\r\n        </div>\r\n        <button id="actionButton" *ngIf="infoStack.stackIndicatorButtonLabel" (click)="openFromStack(infoStack.previousNotification)">\r\n          <div class="button-label">{{ infoStack.stackIndicatorButtonLabel }}</div>\r\n        </button>\r\n      </div>\r\n    </div>\r\n  </div>\r\n  <div\r\n    animateButton\r\n    [infoStackHeight]="infoStack?.notificationList?.length > 0 ? infoSnackElement.offsetHeight : 0"\r\n    [warningStackHeight]="warningStack?.notificationList?.length > 0 ? warningSnackElement.offsetHeight : 0"\r\n    [infoStackIndicatorHeight]="infoStackIndicatorElement?.nativeElement?.offsetHeight"\r\n    [warningStackIndicatorHeight]="warningStackIndicatorElement?.nativeElement?.offsetHeight"\r\n    class="dismiss-all"\r\n    *ngIf="notificationList?.length > 1"\r\n  >\r\n    <avl-button id="dismissAll" (click)="dismissAll()">{{\'VizBox.NotificationContainer.DismissAll\' | translate}}</avl-button>\r\n  </div>\r\n</div>\r\n\r\n\r\n',styles:[":host{position:fixed;right:0;width:445px;display:flex;flex-direction:column;--avl-snackbar-text-color:var(--avl-on-background-info-color)}.snackbar{width:100%;display:flex;flex-direction:column}.snackbar.displayed{flex:1;max-height:100%}.snackbar-stack{position:absolute;top:0;left:0;right:0;width:100%}.stack-indicator-container{margin:0 12px;position:absolute;width:calc(100% - 12px);top:12px;z-index:-1}.snackbar-container{margin-top:0;margin-left:0;margin-right:0;width:100%}.button-label{text-align:left;text-transform:none}.stack-indicator{background-color:var(--avl-background-message-color);top:0;left:0;width:calc(100% - 24px);border-radius:4px;position:relative;height:100%;z-index:-1;box-shadow:0 3px 5px -1px rgb(0 0 0 / 20%),0 6px 10px 0 rgb(0 0 0 / 14%),0 1px 18px 0 rgb(0 0 0 / 12%)}.notification{display:flex;flex:1 1 100%;align-items:center;flex-direction:row;padding:0 12px 0 16px;justify-content:flex-start;cursor:pointer;text-overflow:ellipsis}.notification p{flex-grow:1;-webkit-line-clamp:3;max-height:48px;text-overflow:ellipsis;line-height:19px;font-size:14px;margin:0 0 0 12px;padding:12px 0;font-family:var(--avl-font-family);color:var(--avl-on-background-info-color)}button#actionButton{font-family:var(--avl-font-family);font-weight:500;font-size:14px;color:var(--avl-on-background-message-link-color);background-color:var(--avl-button-background-default-color);max-height:48px;height:48px;width:100%;cursor:pointer;padding:12px;margin:-12px 0 0;border-radius:2px;border:0;outline:0}div#actionButton:hover{color:var(--avl-on-background-message-link-hover-color)}#warningIcon{--avl-icon-custom-color:var(--avl-on-background-message-warning-color);flex:0 0 24px;--avl-icon-custom-color:var(--avl-warning-color)}#errorIcon{--avl-icon-custom-color:var(--avl-on-background-message-error-color);flex:0 0 24px}#infoIcon{--avl-icon-custom-color:var(--avl-on-background-message-emphasis-medium-color);flex:0 0 24px}#OKIcon{--avl-icon-custom-color:var(--avl-on-background-message-ok-color);flex:0 0 24px}.dismiss-all{position:absolute;padding:0 16px;border-radius:25px;background-color:var(--avl-background-message-color);width:-webkit-fit-content;width:-moz-fit-content;width:fit-content;top:12px}#dismissAll{--avl-flat-button-label-color:var(--avl-on-background-message-link-color)}avl-icon-button{flex:0 0 48px;margin-left:12px;cursor:pointer;--avl-icon-button-color:var(--avl-on-background-message-icon-default-color);--avl-icon-ink-hover-color:var(--avl-on-background-message-icon-hover-color);--avl-icon-ink-focus-color:var(--avl-on-background-message-icon-focus-color);--avl-icon-ink-pressed-color:var(--avl-on-background-message-icon-pressed-color)}@media only screen and (min-width:320px) and (max-width:376px){:host{width:calc(100% - 32px)}}@media only screen and (min-width:460px){:host{width:445px}}@media only screen and (min-width:376px) and (max-width:400px){:host{width:376px}}"]}),tt("design:paramtypes",[n.ChangeDetectorRef])],t)}(),it=[{value:15,label:"Show 15 per page"},{value:50,label:"Show 50 per page"},{value:Number.MAX_SAFE_INTEGER,label:"Show all"}],ot={type:{warning:void 0,error:void 0,info:void 0,ok:void 0},state:{read:void 0,unread:void 0},date:{dateFromValue:void 0,dateToValue:void 0}},at=[new m.LeafColumn("VizBox.NotificationDialog.Type","icon",m.ColumnType.Icon,!1,!1,.5),new m.LeafColumn("VizBox.NotificationDialog.Module","module",m.ColumnType.Text,!0,!1,3),new m.LeafColumn("VizBox.NotificationDialog.Message","messageText",m.ColumnType.Text,!0,!1,8),new m.LeafColumn("VizBox.NotificationDialog.Id","id",m.ColumnType.Number,!1,!1,1),{caption:"VizBox.NotificationDialog.Timestamp",valueField:"timestamp",type:m.ColumnType.Date,sortable:!1,filterable:!1,flexWidth:3,dateTimeOptions:{format:"date-time-short"}},new m.LeafColumn("VizBox.NotificationDialog.State","currentIconToggle",m.ColumnType.Icon,!1,!1,1)],rt=((w={})[0]="error",w[1]="warning",w[2]="info",w[3]="ok",w.false="unread",w.true="read",w),ct=((S={})[0]="cancel",S[1]="warning",S[2]="info-outline",S[3]="check",S),lt={false:"mail",true:"communication:mail-outline"},st=((x={})[0]="--avl-icon-custom-color: var(--avl-error-color); height:24px; width:24px;",x[1]="--avl-icon-custom-color: var(--avl-warning-color); height:24px; width:24px;",x[2]="--avl-icon-custom-color: var(--avl-icon-default-color); height:24px; width:24px;",x[3]="--avl-icon-custom-color: var(--avl-ok-color); height:24px; width:24px;",x),dt=this&&this.__assign||function(){return(dt=Object.assign||function(t){for(var e,n=1,i=arguments.length;n<i;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},ut=this&&this.__decorate||function(t,e,n,i){var o,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,n,i);else for(var c=t.length-1;c>=0;c--)(o=t[c])&&(r=(a<3?o(r):a>3?o(e,n,r):o(e,n))||r);return a>3&&r&&Object.defineProperty(e,n,r),r},ft=this&&this.__metadata||function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},pt=this&&this.__awaiter||function(t,e,n,i){return new(n||(n=Promise))((function(o,a){function r(t){try{l(i.next(t))}catch(t){a(t)}}function c(t){try{l(i.throw(t))}catch(t){a(t)}}function l(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(r,c)}l((i=i.apply(t,e||[])).next())}))},vt=this&&this.__generator||function(t,e){var n,i,o,a,r={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function c(a){return function(c){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,i&&(o=2&a[0]?i.return:a[0]?i.throw||((o=i.return)&&o.call(i),0):i.next)&&!(o=o.call(i,a[1])).done)return o;switch(i=0,o&&(a=[2&a[0],o.value]),a[0]){case 0:case 1:o=a;break;case 4:return r.label++,{value:a[1],done:!1};case 5:r.label++,i=a[1],a=[0];continue;case 7:a=r.ops.pop(),r.trys.pop();continue;default:if(!(o=r.trys,(o=o.length>0&&o[o.length-1])||6!==a[0]&&2!==a[0])){r=0;continue}if(3===a[0]&&(!o||a[1]>o[0]&&a[1]<o[3])){r.label=a[1];break}if(6===a[0]&&r.label<o[1]){r.label=o[1],o=a;break}if(o&&r.label<o[2]){r.label=o[2],r.ops.push(a);break}o[2]&&r.ops.pop(),r.trys.pop();continue}a=e.call(t,r)}catch(t){a=[6,t],i=0}finally{n=o=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,c])}}},ht=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],i=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&i>=t.length&&(t=void 0),{value:t&&t[i++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},gt=this&&this.__read||function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var i,o,a=n.call(t),r=[];try{for(;(void 0===e||e-- >0)&&!(i=a.next()).done;)r.push(i.value)}catch(t){o={error:t}}finally{try{i&&!i.done&&(n=a.return)&&n.call(a)}finally{if(o)throw o.error}}return r},mt=this&&this.__spread||function(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(gt(arguments[e]));return t},yt=function(){function t(t){this.cdRef=t,this.open=!1,this.pageSizeOptions=it,this.columnDefinitions=at,this.openChange=new n.EventEmitter,this.markSelectedAsRead=new n.EventEmitter,this.markSelectedAsUnread=new n.EventEmitter,this.tableData=[],this.filteredData=[],this.badge=!1,this.disableMarkingSelected=!0,this.filters=this.deepCopyObject(ot),this.filtersOpen=!0,this.showRefreshButton=!1,this.dateFromLabel="Date from",this.dateToLabel="Date to",this.dateFilterGroupInitHeader="Date",this.dateFilterGroupHeader=this.dateFilterGroupInitHeader,this.selectedRows=[],this.pageSize=15,this.appliedFilters=this.deepCopyObject(ot),this._notifications=[]}return Object.defineProperty(t.prototype,"notifications",{get:function(){return this._notifications},set:function(t){this._notifications.length!==t.length&&(this.showRefreshButton=!0,this._notifications=t)},enumerable:!0,configurable:!0}),t.prototype.ngOnInit=function(){this.translateLabels(),this.refreshTable()},t.prototype.ngAfterViewChecked=function(){this.cdRef.detectChanges()},t.prototype.openChanged=function(t){this.openChange.emit(t)},t.prototype.toggleFilters=function(){this.filtersOpen=!this.filtersOpen},t.prototype.refreshTable=function(){this.showRefreshButton=!1,this.tableData=this.prepareNotifications(this._notifications),this.filters=this.deepCopyObject(this.appliedFilters),this.filterData()},t.prototype.applyFilters=function(){this.appliedFilters=this.deepCopyObject(this.filters),this.filterData()},t.prototype.filterData=function(){var t,e;this.filteredData=[];var n=this.getActiveFilters();try{for(var i=ht(this.tableData),o=i.next();!o.done;o=i.next()){var a=o.value;this.doesElementPassEveryFilter(n,a)&&this.filteredData.push(a)}}catch(e){t={error:e}}finally{try{o&&!o.done&&(e=i.return)&&e.call(i)}finally{if(t)throw t.error}}},t.prototype.markAsRead=function(){this.updateStateOfSelectedRowsTo(!0),this.markSelectedAsRead.emit(this.selectedRows)},t.prototype.markAsUnread=function(){this.updateStateOfSelectedRowsTo(!1),this.markSelectedAsUnread.emit(this.selectedRows)},t.prototype.reset=function(){this.filters=this.deepCopyObject(ot),this.appliedFilters=this.deepCopyObject(ot),this.filterData(),this.updateLabels(),this.badge=!1},t.prototype.getActiveFilters=function(){var t,e,n,i;this.badge=!1;var o={};try{for(var a=ht(Object.keys(this.appliedFilters)),r=a.next();!r.done;r=a.next()){var c=r.value,l=[];try{for(var s=(n=void 0,ht(Object.keys(this.appliedFilters[c]))),d=s.next();!d.done;d=s.next()){var u=d.value;!0===this.appliedFilters[c][u]&&(l.push(u),this.badge=!0)}}catch(t){n={error:t}}finally{try{d&&!d.done&&(i=s.return)&&i.call(s)}finally{if(n)throw n.error}}l.length&&(o[c]=l),"date"===c&&(o[c]=[this.appliedFilters[c].dateFromValue,this.appliedFilters[c].dateToValue])}}catch(e){t={error:e}}finally{try{r&&!r.done&&(e=a.return)&&e.call(a)}finally{if(t)throw t.error}}return o},t.prototype.selectedValuesChanged=function(){this.disableMarkingSelected=!1,0==this.selectedRows.length&&(this.disableMarkingSelected=!0)},t.prototype.updateLabels=function(){return pt(this,void 0,void 0,(function(){var t,e,n,i,o;return vt(this,(function(a){switch(a.label){case 0:return t=AvlLocalizationService.translationService,e=this.filters.date,n=e.dateFromValue,i=e.dateToValue,n||i?[3,1]:(this.dateFilterGroupHeader=this.dateFilterGroupInitHeader,[3,3]);case 1:return o=this,[4,t.translate("VizBox.NotificationDialog.DateRange",{dateFrom:this.formatDateTime(n),dateTo:this.formatDateTime(i)})];case 2:o.dateFilterGroupHeader=a.sent(),a.label=3;case 3:return[2]}}))}))},t.prototype.getNumberOfNotificationsWithType=function(t,e){return t.filter((function(t){return rt[t.type]===e})).length},t.prototype.getNumberOfUnreadNotifications=function(t){return t.filter((function(t){return!t.state})).length},t.prototype.getNumberOfNotifications=function(){return this.filteredData.length!==this.tableData.length||this.badge?this.filteredData.length+"/"+this.tableData.length:this.filteredData.length.toString()},t.prototype.onRowClicked=function(t){var e=t.detail;e.link&&window.open(e.link,"_blank")},t.prototype.prepareNotifications=function(t){return t.map((function(t){return dt(dt({},t),{icon:ct[t.type],iconStyle:st[t.type],currentIconToggle:lt[String(t.read)],currentIconToggleStyle:"height:24px; width:24px;",state:t.read})}))},t.prototype.formatDateTime=function(t){return t?AvlLocalizationService.formatDateTime(t,{format:"date-short"}):"(-)"},t.prototype.deepCopyObject=function(t){var e={};return Object.keys(t).forEach((function(n){e[n]=Object.assign({},t[n])})),e},t.prototype.doesElementPassEveryFilter=function(t,e){var n=this;return Object.keys(t).every((function(i){if("date"===i){var o=gt(n.prepareDates(t[i]),2),a=o[0],r=o[1];if(!a.getTime()&&!r.getTime())return!0;n.badge=!0;var c=new Date(e.timestamp);return!!c.getTime()&&n.compareDates(c,a,r)}return t[i].includes(rt[e[i]])}))},t.prototype.prepareDates=function(t){var e=new Date(t[0]),n=new Date(t[1]);return e.setHours(0,0,0,0),n.setHours(23,59,59,999),[e,n]},t.prototype.compareDates=function(t,e,n){var i=t.getTime(),o=null==e?void 0:e.getTime(),a=null==n?void 0:n.getTime();return o&&a?i>=o&&i<=a:o?i>=o:!!a&&i<=a},t.prototype.updateStateOfSelectedRowsTo=function(t){var e=this;this.tableData.filter((function(t){return e.isRowSelected(t.id)})).forEach((function(e){e.state=t,e.currentIconToggle=lt[String(t)]})),this.tableData=mt(this.tableData),this.filterData()},t.prototype.isRowSelected=function(t){return this.selectedRows.map((function(t){return t.id})).includes(t)},t.prototype.translateLabels=function(){return pt(this,void 0,void 0,(function(){var t,e,n,i,o,a;return vt(this,(function(r){switch(r.label){case 0:return AvlLocalizationService&&AvlLocalizationService.translationService?(t=AvlLocalizationService.translationService,e=this,[4,t.translate("VizBox.NotificationDialog.Date")]):[2];case 1:return e.dateFilterGroupInitHeader=r.sent(),this.dateFilterGroupHeader=this.dateFilterGroupInitHeader,n=this,[4,t.translate("VizBox.NotificationDialog.DateFrom")];case 2:return n.dateFromLabel=r.sent(),i=this,[4,t.translate("VizBox.NotificationDialog.DateTo")];case 3:return i.dateToLabel=r.sent(),o=this,[4,this.translatePageSizeOptions(this.pageSizeOptions)];case 4:return o.pageSizeOptions=r.sent(),a=this,[4,this.translateColumns(this.columnDefinitions)];case 5:return a.columnDefinitions=r.sent(),[2]}}))}))},t.prototype.translatePageSizeOptions=function(t){return pt(this,void 0,void 0,(function(){var e=this;return vt(this,(function(n){switch(n.label){case 0:return[4,Promise.all(t.map((function(t){return pt(e,void 0,void 0,(function(){return vt(this,(function(e){switch(e.label){case 0:return[4,this.translatePageSizeOption(t)];case 1:return[2,e.sent()]}}))}))})))];case 1:return[2,n.sent()]}}))}))},t.prototype.translatePageSizeOption=function(t){return pt(this,void 0,void 0,(function(){var e,n,i,o;return vt(this,(function(a){switch(a.label){case 0:return e=AvlLocalizationService.translationService,n=[dt({},t)],i={},t.value!==Number.MAX_SAFE_INTEGER?[3,2]:[4,e.translate("VizBox.NotificationDialog.ShowAll")];case 1:return o=a.sent(),[3,4];case 2:return[4,e.translate("VizBox.NotificationDialog.ShowXPerPage",{rows:t.value})];case 3:o=a.sent(),a.label=4;case 4:return[2,dt.apply(void 0,n.concat([(i.label=o,i)]))]}}))}))},t.prototype.translateColumns=function(t){return pt(this,void 0,void 0,(function(){var e=this;return vt(this,(function(n){switch(n.label){case 0:return[4,Promise.all(t.map((function(t){return pt(e,void 0,void 0,(function(){return vt(this,(function(e){switch(e.label){case 0:return[4,this.translateColumnItem(t)];case 1:return[2,e.sent()]}}))}))})))];case 1:return[2,n.sent()]}}))}))},t.prototype.translateColumnItem=function(t){return pt(this,void 0,void 0,(function(){var e,n,i;return vt(this,(function(o){switch(o.label){case 0:return e=AvlLocalizationService.translationService,n=[dt({},t)],i={},[4,e.translate(t.caption)];case 1:return[2,dt.apply(void 0,n.concat([(i.caption=o.sent(),i)]))]}}))}))},t.ctorParameters=function(){return[{type:n.ChangeDetectorRef}]},ut([n.Input(),ft("design:type",Boolean)],t.prototype,"open",void 0),ut([n.Input(),ft("design:type",Array)],t.prototype,"pageSizeOptions",void 0),ut([n.Input(),ft("design:type",Array)],t.prototype,"columnDefinitions",void 0),ut([n.Input(),ft("design:type",Array),ft("design:paramtypes",[Array])],t.prototype,"notifications",null),ut([n.Output(),ft("design:type",n.EventEmitter)],t.prototype,"openChange",void 0),ut([n.Output(),ft("design:type",n.EventEmitter)],t.prototype,"markSelectedAsRead",void 0),ut([n.Output(),ft("design:type",n.EventEmitter)],t.prototype,"markSelectedAsUnread",void 0),ut([n.ViewChild("notificationTable"),ft("design:type",n.ElementRef)],t.prototype,"table",void 0),ut([n.ViewChild("filterForm",{read:a.NgForm}),ft("design:type",a.NgForm)],t.prototype,"filterForm",void 0),t=ut([n.Component({selector:"avl-notification-dialog",template:'<avl-dialog\r\n  id="outerDialog"\r\n  [open]="open"\r\n  (openChange)="openChanged($event)"\r\n  [closeOnScrimClick]="false"\r\n  [fullscreen]="true"\r\n>\r\n  <ng-template #content>\r\n    <avl-dialog-header>{{ \'VizBox.NotificationDialog.Details\' | translate }}</avl-dialog-header>\r\n    <avl-dialog-content>\r\n      <div class="main-container">\r\n        <div class="content">\r\n          <div class="table-header">\r\n            <h1>\r\n              {{ \'VizBox.NotificationDialog.Notifications\' | translate }} ({{\r\n                getNumberOfNotifications()\r\n              }})\r\n            </h1>\r\n            <div class="table-header-right">\r\n              <avl-icon-button\r\n                *ngIf="showRefreshButton"\r\n                id="updateIcon"\r\n                (click)="refreshTable()"\r\n                class="pointer"\r\n                icon="icons:refresh"\r\n              >\r\n              </avl-icon-button>\r\n              <avl-tooltip *ngIf="showRefreshButton" for="updateIcon"\r\n                > {{ \'VizBox.NotificationDialog.Refresh\' | translate }}</avl-tooltip\r\n              >\r\n              <avl-icon-button\r\n                id="unreadIcon"\r\n                (click)="markAsUnread()"\r\n                class="pointer"\r\n                icon="icons:mail"\r\n                [disabled]="disableMarkingSelected"\r\n              >\r\n              </avl-icon-button>\r\n              <avl-tooltip for="unreadIcon">{{\r\n                \'VizBox.NotificationDialog.MarkSelectedAsUnread\' | translate\r\n              }}</avl-tooltip>\r\n              <avl-icon-button\r\n                id="readIcon"\r\n                class="pointer"\r\n                (click)="markAsRead()"\r\n                icon="communication:mail-outline"\r\n                [disabled]="disableMarkingSelected"\r\n              >\r\n              </avl-icon-button>\r\n              <avl-tooltip for="readIcon">{{\r\n                \'VizBox.NotificationDialog.MarkSelectedAsRead\' | translate\r\n              }}</avl-tooltip>\r\n              <avl-icon-button\r\n                (click)="toggleFilters()"\r\n                class="pointer"\r\n                icon="icons:filter-list"\r\n                [badge]="badge"\r\n              ></avl-icon-button>\r\n            </div>\r\n          </div>\r\n          <avl-datatable\r\n            #notificationTable\r\n            class="filterDatatable"\r\n            multi-select\r\n            allow-active-row\r\n            pagination\r\n            [columnDefinitions]="columnDefinitions"\r\n            [data]="filteredData"\r\n            [pageSize]="pageSize"\r\n            [pageSizeOptions]="pageSizeOptions"\r\n            [(selectedValues)]="selectedRows"\r\n            (selectedValuesChange)="selectedValuesChanged()"\r\n            (on-row-clicked)="onRowClicked($event)"\r\n          >\r\n          </avl-datatable>\r\n        </div>\r\n        <avl-side-sheet class="filter-sheet" divider [(open)]="filtersOpen" #filterSheet>\r\n          <div slot="title">\r\n            <h2>{{ \'VizBox.NotificationDialog.Filters\' | translate }}</h2>\r\n          </div>\r\n          <div slot="content">\r\n            <form #filterForm="ngForm">\r\n              <avl-list-expander [narrow]="true">\r\n                <div role="header">\r\n                  <h3>{{ \'VizBox.NotificationDialog.Type\' | translate }}</h3>\r\n                </div>\r\n                <div role="content" class="filterContent">\r\n                  <div>\r\n                    <avl-checkbox name="warningSwitch" [(ngModel)]="filters.type.warning">\r\n                      {{ \'VizBox.NotificationDialog.Warning\' | translate }}\r\n                      <span *ngIf="tableData.length"\r\n                        >({{ getNumberOfNotificationsWithType(tableData, \'warning\') }})</span\r\n                      >\r\n                    </avl-checkbox>\r\n                    <avl-icon id="warningIcon" class="typeIcons" icon="icons:warning"></avl-icon>\r\n                  </div>\r\n                  <div>\r\n                    <avl-checkbox name="errorSwitch" [(ngModel)]="filters.type.error">\r\n                      {{ \'VizBox.NotificationDialog.Error\' | translate }}\r\n                      <span *ngIf="tableData.length"\r\n                        >({{ getNumberOfNotificationsWithType(tableData, \'error\') }})</span\r\n                      >\r\n                    </avl-checkbox>\r\n                    <avl-icon id="errorIcon" class="typeIcons" icon="icons:cancel"></avl-icon>\r\n                  </div>\r\n                  <div>\r\n                    <avl-checkbox name="infoSwitch" [(ngModel)]="filters.type.info">\r\n                      {{ \'VizBox.NotificationDialog.Info\' | translate }}\r\n                      <span *ngIf="tableData.length"\r\n                        >({{ getNumberOfNotificationsWithType(tableData, \'info\') }})</span\r\n                      >\r\n                    </avl-checkbox>\r\n                    <avl-icon id="infoIcon" class="typeIcons" icon="icons:info-outline"></avl-icon>\r\n                  </div>\r\n                  <div>\r\n                    <avl-checkbox name="okSwitch" [(ngModel)]="filters.type.ok">\r\n                      {{ \'VizBox.NotificationDialog.Ok\' | translate }}\r\n                      <span *ngIf="tableData.length"\r\n                        >({{ getNumberOfNotificationsWithType(tableData, \'ok\') }})</span\r\n                      >\r\n                    </avl-checkbox>\r\n                    <avl-icon id="okIcon" class="typeIcons" icon="icons:check"></avl-icon>\r\n                  </div>\r\n                </div>\r\n              </avl-list-expander>\r\n              <avl-list-expander [narrow]="true">\r\n                <div role="header">\r\n                  <h3>{{ \'VizBox.NotificationDialog.State\' | translate }}</h3>\r\n                </div>\r\n                <div role="content" class="filterContent">\r\n                  <avl-checkbox name="unreadState" [(ngModel)]="filters.state.unread">\r\n                    {{ \'VizBox.NotificationDialog.Unread\' | translate }} ({{\r\n                      getNumberOfUnreadNotifications(tableData)\r\n                    }})\r\n                  </avl-checkbox>\r\n                  <avl-icon id="infoIcon" class="typeIcons" icon="icons:mail"></avl-icon>\r\n                  <avl-checkbox name="readState" [(ngModel)]="filters.state.read">\r\n                    {{ \'VizBox.NotificationDialog.Read\' | translate }} ({{\r\n                      tableData.length - getNumberOfUnreadNotifications(tableData)\r\n                    }})\r\n                  </avl-checkbox>\r\n                  <avl-icon\r\n                    id="infoIcon"\r\n                    class="typeIcons"\r\n                    icon="communication:mail-outline"\r\n                  ></avl-icon>\r\n                </div>\r\n              </avl-list-expander>\r\n              <avl-list-expander [narrow]="true">\r\n                <div role="header">\r\n                  <h3 id="date-group" #dateGroup>\r\n                    {{ dateFilterGroupHeader }}\r\n                  </h3>\r\n                  <avl-tooltip for="date-group" *ngIf="dateGroup.scrollWidth > dateGroup.clientWidth">\r\n                    {{ dateFilterGroupHeader }}\r\n                  </avl-tooltip>\r\n                </div>\r\n                <div role="content">\r\n                  <avl-date\r\n                    class="date-control"\r\n                    [(ngModel)]="filters.date.dateFromValue"\r\n                    name="dateFromValue"\r\n                    (valueChange)="updateLabels()"\r\n                    [label]="dateFromLabel"\r\n                  ></avl-date>\r\n                  <avl-date\r\n                    class="date-control"\r\n                    [(ngModel)]="filters.date.dateToValue"\r\n                    name="dateTo"\r\n                    (valueChange)="updateLabels()"\r\n                    [label]="dateToLabel"\r\n                  ></avl-date>\r\n                </div>\r\n              </avl-list-expander>\r\n            </form>\r\n          </div>\r\n          <div slot="actions">\r\n            <avl-button contained (click)="applyFilters()">{{\r\n              \'VizBox.NotificationDialog.Apply\' | translate\r\n            }}</avl-button>\r\n            <avl-button (click)="reset()">{{\r\n              \'VizBox.NotificationDialog.Reset\' | translate\r\n            }}</avl-button>\r\n          </div>\r\n        </avl-side-sheet>\r\n      </div>\r\n    </avl-dialog-content>\r\n  </ng-template>\r\n</avl-dialog>\r\n',styles:[".content{position:relative;display:flex;flex-direction:column;flex-grow:1}.table-header{display:flex;justify-content:space-between;align-items:center}.main-container{display:flex;height:100%}.main-container.hidden{display:none}.filterDatatable{height:100%}.filter-sheet{--avl-side-sheet-padding:0px;--avl-side-sheet-height:84vh;width:300px}.filter-sheet h2{font-size:20px;margin-left:24px}.filter-sheet h3{font-size:16px;margin:0;text-overflow:ellipsis;overflow:hidden}.pointer{cursor:pointer}#errorIcon{--avl-icon-custom-color:var(--avl-error-color)}#warningIcon{--avl-icon-custom-color:var(--avl-warning-color)}#okIcon{--avl-icon-custom-color:var(--avl-ok-color)}#infoIcon{--avl-icon-custom-color:var(--avl-icon-default-color)}.filterContent{position:relative}.typeIcons{position:absolute;right:0;margin-top:12px;margin-bottom:12px}.date-control{width:100%}avl-dialog-content{--padding-top:1px!important;--padding-right:0px!important;--padding-bottom:2px!important}avl-dialog-header{z-index:1}avl-side-sheet{--avl-side-sheet-height:unset!important;box-shadow:none;border-left:1px solid var(--avl-divider-color)}avl-datatable{--margin-top-pages:0px!important}"]}),ft("design:paramtypes",[n.ChangeDetectorRef])],t)}(),bt=this&&this.__decorate||function(t,e,n,i){var o,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,n,i);else for(var c=t.length-1;c>=0;c--)(o=t[c])&&(r=(a<3?o(r):a>3?o(e,n,r):o(e,n))||r);return a>3&&r&&Object.defineProperty(e,n,r),r},kt=this&&this.__read||function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var i,o,a=n.call(t),r=[];try{for(;(void 0===e||e-- >0)&&!(i=a.next()).done;)r.push(i.value)}catch(t){o={error:t}}finally{try{i&&!i.done&&(n=a.return)&&n.call(a)}finally{if(o)throw o.error}}return r},wt=this&&this.__spread||function(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(kt(arguments[e]));return t},St=[T,nt,Y,q,M,$,z,yt],xt=function(){function t(){}return t=bt([n.NgModule({declarations:wt(St),imports:[e.CommonModule,i.TranslateModule,o.AvlNgBindersModule,y.AvlDialogModule,b.AvlNavigationModule,a.FormsModule],schemas:[n.CUSTOM_ELEMENTS_SCHEMA],exports:wt(St)})],t)}();t.AvlNotificationContainerComponent=nt,t.AvlNotificationDialogComponent=yt,t.AvlNotificationMenuComponent=T,t.AvlNotificationModule=xt,t.ɵa=Y,t.ɵb=q,t.ɵc=M,t.ɵd=$,t.ɵe=z,Object.defineProperty(t,"__esModule",{value:!0})}));
//# sourceMappingURL=avl-ng-controls-notification.umd.min.js.map