var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};
var __metadata = (this && this.__metadata) || function (k, v) {
    if (typeof Reflect === "object" && typeof Reflect.metadata === "function") return Reflect.metadata(k, v);
};
import { Component, Output, EventEmitter, Input, HostBinding } from '@angular/core';
import { trigger, style, animate, transition } from '@angular/animations';
import { Router, ActivationEnd, ActivatedRoute } from '@angular/router';
import { filter } from 'rxjs/operators';
import '@avl-controls/core/dist/avl-icon/avl-icon';
var rowHeightPx = 48;
var AvlSideNavComponent = /** @class */ (function () {
    function AvlSideNavComponent(router, activeRoute) {
        var _this = this;
        this.router = router;
        this.activeRoute = activeRoute;
        this.openValue = false;
        /**
         * Emitted when the open property changes.
         */
        this.openChange = new EventEmitter();
        activeRoute.queryParams.subscribe(function (p) {
            _this.params = p;
        });
        this.subscription = this.router.events
            .pipe(filter(function (event) { return event instanceof ActivationEnd; }))
            .subscribe(function (event) {
            _this.selectItems();
        });
    }
    Object.defineProperty(AvlSideNavComponent.prototype, "open", {
        /**
         * Can be set to open or close the side nav.
         * Returns the current state of the side nav.
         */
        get: function () {
            return this.openValue;
        },
        set: function (val) {
            this.openValue = val;
            this.openChange.next(val);
        },
        enumerable: true,
        configurable: true
    });
    /**
     * @hidden
     */
    AvlSideNavComponent.prototype.toggleOpen = function () {
        if (!this.manuallyOpened) {
            this.open = !this.open;
        }
    };
    /**
     * @hidden
     */
    AvlSideNavComponent.prototype.arrowToggleOpen = function () {
        this.manuallyOpened = !this.open;
        this.open = !this.open;
    };
    /**
     * @hidden
     */
    AvlSideNavComponent.prototype.mobileClose = function () {
        if (Math.max(document.documentElement.clientWidth, window.innerWidth) < 960) {
            this.open = false;
        }
    };
    /**
     * @hidden
     */
    AvlSideNavComponent.prototype.groupClicked = function (item) {
        if (!this.open) {
            this.open = true;
            if (!item.expanded) {
                item.expanded = true;
            }
        }
        else {
            item.expanded = !item.expanded;
        }
    };
    /**
     * @hidden
     */
    AvlSideNavComponent.prototype.getScrubberStyle = function () {
        return {
            height: this.selectedParagraph ? '14px' : '0px',
            top: this.selectedParagraphIndex * rowHeightPx + "px"
        };
    };
    /**
    * @hidden
    */
    AvlSideNavComponent.prototype.trimSlash = function (str) {
        if (str[0] === '/') {
            str = str.substring(1, str.length);
        }
        if (str[str.length - 1] === '/') {
            str = str.substring(0, str.length - 1);
        }
        return str;
    };
    AvlSideNavComponent.prototype.selectItems = function () {
        if (!this.menuItems) {
            return;
        }
        var fragment = this.router.parseUrl(this.router.url).fragment;
        var url = this.router.url.split('#')[0];
        var queue = this.menuItems.slice();
        var currentGroup;
        this.selectedGroup = undefined;
        this.selectedPage = undefined;
        this.selectedParagraph = undefined;
        var fallbackSelectedPage;
        var _loop_1 = function () {
            var item = queue.pop();
            if (isGroup(item)) {
                currentGroup = item;
                item.subItems.map(function (subitem) { queue.push(subitem); });
            }
            else {
                if (fallbackSelectedPage == null && this_1.trimSlash(url).startsWith(this_1.trimSlash(item.route))) {
                    fallbackSelectedPage = item;
                }
                if (item.route && this_1.trimSlash(url).endsWith(this_1.trimSlash(item.route + this_1.getUrlParams(item.params)))) {
                    if (this_1.selectedPage && this_1.selectedPage.route && this_1.selectedPage.route.length > item.route.length) {
                        return "continue";
                    }
                    if (item.params && item.params.length > 0) {
                        var object_1 = new Object();
                        item.params.forEach(function (i) {
                            object_1[i.name] = i.value;
                        });
                        if (JSON.stringify(this_1.params) === JSON.stringify(object_1)) {
                            this_1.selectedPage = item;
                        }
                    }
                    else {
                        this_1.selectedPage = item;
                    }
                    if (isTopLevelPage(item)) {
                        this_1.selectedGroup = undefined;
                    }
                    else {
                        this_1.selectedGroup = currentGroup;
                    }
                    if (item.paragraphs && item.paragraphs.length > 0) {
                        var paragraphIndex = item.paragraphs.findIndex(function (p) { return p.id === fragment; });
                        if (fragment && item.paragraphs && paragraphIndex !== -1) {
                            this_1.selectedParagraph = fragment;
                            this_1.selectedParagraphIndex = paragraphIndex;
                        }
                    }
                }
            }
        };
        var this_1 = this;
        while (queue.length) {
            _loop_1();
        }
        if (this.selectedPage == null) {
            this.selectedPage = fallbackSelectedPage;
        }
    };
    /**
    * @hidden
    */
    AvlSideNavComponent.prototype.ngOnChanges = function (changes) {
        if (changes['menuItems']) {
            this.selectItems();
        }
    };
    /**
    * @hidden
    */
    AvlSideNavComponent.prototype.ngOnDestroy = function () {
        this.subscription.unsubscribe();
    };
    /**
    * @hidden
    */
    AvlSideNavComponent.prototype.getParams = function (params) {
        if (params && params.length > 0) {
            var object_2 = {};
            params.forEach(function (param) {
                object_2[param.name] = param.value;
            });
            return object_2;
        }
        else {
            return null;
        }
    };
    /**
    * @hidden
    */
    AvlSideNavComponent.prototype.getUrlParams = function (params) {
        if (params && params.length > 0) {
            var url_1 = '?';
            params.forEach(function (param) {
                url_1 += param.name + '=' + param.value + '&';
            });
            return url_1.slice(0, -1);
        }
        else {
            return '';
        }
    };
    AvlSideNavComponent.ctorParameters = function () { return [
        { type: Router },
        { type: ActivatedRoute }
    ]; };
    __decorate([
        Input(),
        HostBinding('class.open'),
        __metadata("design:type", Boolean),
        __metadata("design:paramtypes", [Boolean])
    ], AvlSideNavComponent.prototype, "open", null);
    __decorate([
        Input(),
        __metadata("design:type", Array)
    ], AvlSideNavComponent.prototype, "menuItems", void 0);
    __decorate([
        Input(),
        HostBinding('class.responsive'),
        __metadata("design:type", Boolean)
    ], AvlSideNavComponent.prototype, "responsive", void 0);
    __decorate([
        Input(),
        HostBinding('class.mobile'),
        __metadata("design:type", Boolean)
    ], AvlSideNavComponent.prototype, "mobile", void 0);
    __decorate([
        Output(),
        __metadata("design:type", EventEmitter)
    ], AvlSideNavComponent.prototype, "openChange", void 0);
    AvlSideNavComponent = __decorate([
        Component({
            selector: 'avl-side-nav',
            template: "<div #outerContainer [class.closed]=\"!open\" class=\"outer-container toolbar-spacing\">\r\n  <div class=\"item-scroll\">\r\n    <div #innerContainer class=\"inner-container\">\r\n      <ng-template ngFor let-item [ngForOf]=\"menuItems\">\r\n        <!-- Top level page -->\r\n        <a *ngIf=\"!item.subItems\" tabindex=\"0\" class=\"item top-level-page\" routerLink={{item.route}} [queryParams]=\"getParams(item.params)\" [class.selected]=\"item === selectedPage\" (click)=\"mobileClose()\">\r\n          <div class=\"image-div\">\r\n            <avl-icon *ngIf=\"item.icon\" attr.icon=\"{{item.icon}}\"></avl-icon>\r\n            <img *ngIf=\"item.iconUrl\" [src]=\"item.iconUrl\">\r\n          </div>\r\n          <div class=\"label-div\">{{item.label}}</div>\r\n          <div class=\"item-overlay\"></div>\r\n        </a>\r\n        <!-- Paragraphs of a top level page -->\r\n        <div class=\"child-container\" *ngIf=\"open && item.paragraphs && item.paragraphs.length > 0 && item === selectedPage\" [@expandCollapse]>\r\n          <!-- div for preventing reversing of the items by flex-direction: column-reverse -->\r\n          <div>\r\n            <a *ngFor=\"let paragraph of item.paragraphs\" class=\"item top-level-paragraph\"\r\n              href=\"{{trimSlash(item.route + getUrlParams(item.params) + '#' + paragraph.id)}}\" [class.selected]=\"paragraph.id === selectedParagraph\" (click)=\"mobileClose()\">\r\n              <div class=\"label-div\">{{paragraph.label}}</div>\r\n            </a>\r\n          </div>\r\n          <div class=\"page-progress-bar\">\r\n            <div class=\"page-progress-bar-background\"></div>\r\n            <div class=\"page-progress-bar-scrubber\" [ngStyle]=\"getScrubberStyle()\"></div>\r\n          </div>\r\n        </div>\r\n        <!-- Group -->\r\n        <div *ngIf=\"item.subItems\" tabindex=\"0\" class=\"item group\" [class.expanded]=\"item.expanded\" (click)=\"groupClicked(item)\"\r\n          [class.selected]=\"!open && item === selectedGroup\">\r\n          <div class=\"image-div\">\r\n            <avl-icon *ngIf=\"item.icon\" attr.icon=\"{{item.icon}}\"></avl-icon>\r\n            <img *ngIf=\"item.iconUrl\" [src]=\"item.iconUrl\">\r\n          </div>\r\n          <div class=\"label-div group\">{{item.label}}</div>\r\n          <avl-icon class=\"group-arrow\" icon=\"arrow-drop-down\"></avl-icon>\r\n          <div class=\"item-overlay\"></div>\r\n        </div>\r\n        <!-- Subpages -->\r\n        <div class=\"child-container\" *ngIf=\"open && item.subItems && item.subItems.length > 0 && item.expanded\" [@expandCollapse] (click)=\"toggleOpen()\">\r\n          <!-- div for preventing reversing of the items by flex-direction: column-reverse -->\r\n          <div>\r\n            <ng-template ngFor let-subItem [ngForOf]=\"item.subItems\">\r\n              <a class=\"item subpage\" routerLink={{subItem.route}} [queryParams]=\"getParams(subItem.params)\" [class.selected]=\"subItem === selectedPage\" (click)=\"mobileClose()\">\r\n                <div class=\"label-div\">{{subItem.label}}</div>\r\n                <div class=\"item-overlay\"></div>\r\n              </a>\r\n              <!-- Paragraphs of a subpage -->\r\n              <div class=\"child-container\" *ngIf=\"subItem.paragraphs && subItem.paragraphs.length > 0 && subItem === selectedPage\" [@expandCollapse]>\r\n                <!-- div for preventing reversing of the items by flex-direction: column-reverse -->\r\n                <div>\r\n                  <a *ngFor=\"let paragraph of subItem.paragraphs\" class=\"item subpage-paragraph\" href=\"{{subItem.route}}{{getUrlParams(item.params)}}#{{paragraph.id}}\"\r\n                    [class.selected]=\"paragraph.id === selectedParagraph\" (click)=\"mobileClose()\">\r\n                    <div class=\"label-div\">{{paragraph.label}}</div>\r\n                  </a>\r\n                </div>\r\n                <div class=\"page-progress-bar\">\r\n                  <div class=\"page-progress-bar-background\"></div>\r\n                  <div class=\"page-progress-bar-scrubber\" [ngStyle]=\"getScrubberStyle()\"></div>\r\n                </div>\r\n              </div>\r\n            </ng-template>\r\n          </div>\r\n        </div>\r\n      </ng-template>\r\n    </div>\r\n  </div>\r\n  <div class=\"arrow-spacer\"></div>\r\n\r\n  <svg (click)=\"arrowToggleOpen()\" [class.closed]=\"!open\" class=\"open-close-arrow\"  id=\"Layer_1\" data-name=\"Layer 1\" xmlns=\"http://www.w3.org/2000/svg\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\">\r\n    <g transform=\"translate(405 102) rotate(-180)\">\r\n      <path d=\"M-972.955,492l6.774-6,1.581,1.4-5.194,4.6,5.194,4.6-1.581,1.4Zm-5.645,0,6.773-6,1.581,1.4-5.193,4.6,5.193,4.6-1.581,1.4Z\" transform=\"translate(1364.6 -402)\"/>\r\n    </g>\r\n  </svg>\r\n\r\n</div>\r\n<div class=\"scrim\" (click)=\"open = false;\"></div>",
            animations: [
                trigger('expandCollapse', [
                    transition(':enter', [
                        style({ 'max-height': '0px' }),
                        animate('225ms ease-in', style({ transform: 'translateY(0%)', 'max-height': '200px' }))
                    ]),
                    transition(':leave', [
                        style({ 'max-height': '200px' }),
                        animate('180ms ease-in', style({ 'max-height': '0px' }))
                    ])
                ])
            ],
            styles: [":host{font-family:var(--avl-font-family);height:100%;display:block;--text-color:var(--avl-side-nav-text-color, var(--avl-emphasis-high-color));--icons-color:var(--avl-side-nav-icons-color, var(--avl-emphasis-medium-color));--background-color:var(--avl-side-nav-background-color, var(--avl-side-nav-color));--item-icon-width:72px;--side-nav-mini-width:var(--item-icon-width);--side-nav-open-width:var(--avl-side-nav-open-width, 256px);--item-height:48px;box-shadow:var(--avl-box-shadow-12dp);z-index:3}.outer-container{position:relative;box-sizing:content-box;height:calc(100% - var(--avl-app-bar-height,56px));background-color:var(--background-color);width:var(--side-nav-open-width);overflow:hidden}.inner-container{width:var(--side-nav-open-width)}.toolbar-spacing{padding-top:var(--avl-app-bar-height,56px)}.open-close-arrow{position:absolute;bottom:12px;right:24px;font-size:24px;fill:var(--icons-color);cursor:pointer;-webkit-user-select:none;-moz-user-select:none;user-select:none;width:24px}.open-close-arrow:not(.closed){transform:scale(-1,1)}.outer-container.closed{width:var(--side-nav-mini-width);-webkit-animation-name:closing;animation-name:closing;-webkit-animation-timing-function:cubic-bezier(0,0,.2,1);animation-timing-function:cubic-bezier(0,0,.2,1);transition-duration:195ms}.arrow-spacer{height:48px}.item-scroll{height:calc(100% - 48px);overflow-y:auto;overflow-x:hidden}.item{display:flex;align-items:center;cursor:pointer;color:var(--text-color);height:var(--item-height);position:relative;overflow:hidden;white-space:nowrap;text-overflow:ellipsis;isolation:isolate;outline:0;white-space:pre-wrap;padding-right:24px}.item:active{color:var(--text-color)}.top-level-paragraph{padding-left:88px}.subpage{padding-left:72px}.subpage-paragraph{padding-left:88px}.label-div{z-index:10;font-family:Roboto;max-width:160px;overflow:hidden;text-overflow:ellipsis;max-height:40px;word-break:break-word;-webkit-box-orient:vertical;display:-webkit-box;-webkit-line-clamp:2}.group.expanded>.label-div.group{font-family:Roboto-Medium}.label-div.group{max-width:calc(100% - 112px)}.image-div{color:var(--avl-emphasis-medium-color);display:flex;align-items:center;justify-content:center;width:var(--item-icon-width);height:var(--item-height);margin-right:0;z-index:9}img{height:auto;width:auto;max-height:24px;max-width:24px}avl-icon{margin-bottom:0;font-size:24px;color:var(--avl-emphasis-medium-color)}.group-arrow{position:absolute;right:24px}.group.expanded>.group-arrow{transform:rotate(180deg)}.item-overlay{box-sizing:border-box;position:absolute;height:100%;width:100%;left:0;z-index:0}.item.selected>.item-overlay{background-color:var(--avl-side-nav-product-color,var(--avl-product-focus-color))}.item:hover:not(.selected)>.item-overlay{background-color:var(--avl-side-nav-product-color-hover,var(--avl-product-hover-color))}.item.selected{font-weight:500}.child-container{position:relative;display:flex;overflow:hidden;flex-direction:column-reverse}.page-progress-bar{position:absolute;left:72px;top:11px;bottom:11px;width:2px;overflow:hidden}.page-progress-bar-background{background-color:var(--text-color);opacity:.2;width:100%;height:100%}.page-progress-bar-scrubber{position:absolute;width:100%;background-color:var(--text-color);opacity:1;transition:height .2s,top .2s;margin-top:6px;margin-bottom:2px}@-webkit-keyframes closing{from{width:var(--side-nav-open-width)}to{width:var(--side-nav-mini-width)}}@keyframes closing{from{width:var(--side-nav-open-width)}to{width:var(--side-nav-mini-width)}}@-webkit-keyframes opening{from{width:var(--side-nav-mini-width)}to{width:var(--side-nav-open-width)}}@keyframes opening{from{width:var(--side-nav-mini-width)}to{width:var(--side-nav-open-width)}}.outer-container:not(.closed){-webkit-animation-name:opening;animation-name:opening;-webkit-animation-timing-function:cubic-bezier(0,0,.2,1);animation-timing-function:cubic-bezier(0,0,.2,1);transition-duration:225ms}@media (max-width:960px){:host(.responsive){position:absolute;--side-nav-mini-width:0;transition:box-shadow 250ms}:host(.responsive[slot=left-side]){left:0}:host(.responsive[slot=right-side]){right:0}:host(.responsive:not(.open)){box-shadow:none}:host(.responsive) .item-scroll{height:100%}:host(.responsive) .open-close-arrow{display:none}:host(.responsive) .arrow-spacer{display:none;visibility:hidden}:host(.responsive) .scrim{transition:250ms;transition-duration:250px}:host(.responsive[slot=left-side]:not(.open)) .scrim{visibility:hidden;left:0}:host(.responsive.open) .scrim{background-color:var(--avl-scrim-color);position:fixed;visibility:visible;top:0;width:100%;height:100%}:host(.responsive[slot=left-side].open) .scrim{left:var(--side-nav-open-width)}:host(.responsive[slot=right-side].open) .scrim{right:var(--side-nav-open-width)}:host(.responsive[slot=right-side]:not(.open)) .scrim{visibility:hidden;right:0}}:host(.mobile){position:absolute;--side-nav-mini-width:0;transition:box-shadow 250ms}:host(.mobile[slot=left-side]){left:0}:host(.mobile[slot=right-side]){right:0}:host(.mobile:not(.open)){box-shadow:none}:host(.mobile) .item-scroll{height:100%}:host(.mobile) .open-close-arrow{display:none}:host(.mobile) .arrow-spacer{display:none;visibility:hidden}:host(.mobile) .scrim{transition:250ms;transition-duration:250px}:host(.mobile[slot=left-side]:not(.open)) .scrim{visibility:hidden;left:0}:host(.mobile.open) .scrim{background-color:var(--avl-scrim-color);position:fixed;visibility:visible;top:0;width:100%;height:100%}:host(.mobile[slot=left-side].open) .scrim{left:var(--side-nav-open-width)}:host(.mobile[slot=right-side].open) .scrim{right:var(--side-nav-open-width)}:host(.mobile[slot=right-side]:not(.open)) .scrim{visibility:hidden;right:0}"]
        }),
        __metadata("design:paramtypes", [Router,
            ActivatedRoute])
    ], AvlSideNavComponent);
    return AvlSideNavComponent;
}());
export { AvlSideNavComponent };
/**
* @hidden
*/
function isGroup(item) {
    return item.subItems !== undefined && item.subItems.length > 0;
}
/**
* @hidden
*/
function isTopLevelPage(item) {
    return !isGroup(item) && (item.icon !== undefined || item.iconUrl !== undefined);
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiYXZsLXNpZGUtbmF2LmNvbXBvbmVudC5qcyIsInNvdXJjZVJvb3QiOiJuZzovL0BhdmwtbmctY29udHJvbHMvbmF2aWdhdGlvbi8iLCJzb3VyY2VzIjpbImxpYi9jb21wb25lbnRzL2F2bC1zaWRlLW5hdi9hdmwtc2lkZS1uYXYuY29tcG9uZW50LnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7Ozs7OztBQUFBLE9BQU8sRUFDTCxTQUFTLEVBQUUsTUFBTSxFQUFFLFlBQVksRUFBRSxLQUFLLEVBQXVDLFdBQVcsRUFDekYsTUFBTSxlQUFlLENBQUM7QUFDdkIsT0FBTyxFQUFFLE9BQU8sRUFBRSxLQUFLLEVBQUUsT0FBTyxFQUFFLFVBQVUsRUFBQyxNQUFNLHFCQUFxQixDQUFDO0FBR3pFLE9BQU8sRUFBRSxNQUFNLEVBQUUsYUFBYSxFQUFFLGNBQWMsRUFBRSxNQUFNLGlCQUFpQixDQUFDO0FBQ3hFLE9BQU8sRUFBRSxNQUFNLEVBQUUsTUFBTSxnQkFBZ0IsQ0FBQztBQUV4QyxPQUFPLDJDQUEyQyxDQUFDO0FBRW5ELElBQU0sV0FBVyxHQUFHLEVBQUUsQ0FBQztBQW1CdkI7SUFvRkUsNkJBQ1UsTUFBYyxFQUVmLFdBQTJCO1FBSHBDLGlCQWFDO1FBWlMsV0FBTSxHQUFOLE1BQU0sQ0FBUTtRQUVmLGdCQUFXLEdBQVgsV0FBVyxDQUFnQjtRQW5FNUIsY0FBUyxHQUFHLEtBQUssQ0FBQztRQWtDMUI7O1dBRUc7UUFFSSxlQUFVLEdBQTBCLElBQUksWUFBWSxFQUFFLENBQUM7UUErQjVELFdBQVcsQ0FBQyxXQUFXLENBQUMsU0FBUyxDQUFDLFVBQUEsQ0FBQztZQUNqQyxLQUFJLENBQUMsTUFBTSxHQUFHLENBQUMsQ0FBQztRQUNsQixDQUFDLENBQUMsQ0FBQztRQUNILElBQUksQ0FBQyxZQUFZLEdBQUcsSUFBSSxDQUFDLE1BQU0sQ0FBQyxNQUFNO2FBQ25DLElBQUksQ0FBQyxNQUFNLENBQUMsVUFBQSxLQUFLLElBQUksT0FBQSxLQUFLLFlBQVksYUFBYSxFQUE5QixDQUE4QixDQUFDLENBQUM7YUFDckQsU0FBUyxDQUFDLFVBQUMsS0FBb0I7WUFDOUIsS0FBSSxDQUFDLFdBQVcsRUFBRSxDQUFDO1FBQ3JCLENBQUMsQ0FBQyxDQUFDO0lBQ1AsQ0FBQztJQXJFRCxzQkFBVyxxQ0FBSTtRQU5mOzs7V0FHRzthQUdIO1lBQ0UsT0FBTyxJQUFJLENBQUMsU0FBUyxDQUFDO1FBQ3hCLENBQUM7YUE4QkQsVUFBZ0IsR0FBWTtZQUMxQixJQUFJLENBQUMsU0FBUyxHQUFHLEdBQUcsQ0FBQztZQUNyQixJQUFJLENBQUMsVUFBVSxDQUFDLElBQUksQ0FBQyxHQUFHLENBQUMsQ0FBQztRQUM1QixDQUFDOzs7T0FqQ0E7SUFxRUQ7O09BRUc7SUFDSSx3Q0FBVSxHQUFqQjtRQUNFLElBQUcsQ0FBQyxJQUFJLENBQUMsY0FBYyxFQUFFO1lBQ3ZCLElBQUksQ0FBQyxJQUFJLEdBQUcsQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDO1NBQ3hCO0lBQ0gsQ0FBQztJQUlEOztPQUVHO0lBQ0ksNkNBQWUsR0FBdEI7UUFDSSxJQUFJLENBQUMsY0FBYyxHQUFHLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQztRQUNqQyxJQUFJLENBQUMsSUFBSSxHQUFHLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQztJQUMzQixDQUFDO0lBRUQ7O09BRUc7SUFDSSx5Q0FBVyxHQUFsQjtRQUNFLElBQUcsSUFBSSxDQUFDLEdBQUcsQ0FBQyxRQUFRLENBQUMsZUFBZSxDQUFDLFdBQVcsRUFBRSxNQUFNLENBQUMsVUFBVSxDQUFDLEdBQUcsR0FBRyxFQUFFO1lBQzFFLElBQUksQ0FBQyxJQUFJLEdBQUcsS0FBSyxDQUFDO1NBQ25CO0lBQ0gsQ0FBQztJQUVEOztPQUVHO0lBQ0ksMENBQVksR0FBbkIsVUFBb0IsSUFBSTtRQUN0QixJQUFJLENBQUMsSUFBSSxDQUFDLElBQUksRUFBRTtZQUNkLElBQUksQ0FBQyxJQUFJLEdBQUcsSUFBSSxDQUFDO1lBQ2pCLElBQUksQ0FBQyxJQUFJLENBQUMsUUFBUSxFQUFFO2dCQUNsQixJQUFJLENBQUMsUUFBUSxHQUFHLElBQUksQ0FBQzthQUN0QjtTQUNGO2FBQU07WUFDTCxJQUFJLENBQUMsUUFBUSxHQUFHLENBQUMsSUFBSSxDQUFDLFFBQVEsQ0FBQztTQUNoQztJQUNILENBQUM7SUFFRDs7T0FFRztJQUNJLDhDQUFnQixHQUF2QjtRQUNFLE9BQU87WUFDTCxNQUFNLEVBQUUsSUFBSSxDQUFDLGlCQUFpQixDQUFDLENBQUMsQ0FBQyxNQUFNLENBQUMsQ0FBQyxDQUFDLEtBQUs7WUFDL0MsR0FBRyxFQUFLLElBQUksQ0FBQyxzQkFBc0IsR0FBRyxXQUFXLE9BQUk7U0FDdEQsQ0FBQztJQUNKLENBQUM7SUFFRDs7TUFFRTtJQUNLLHVDQUFTLEdBQWhCLFVBQWlCLEdBQVc7UUFDMUIsSUFBSSxHQUFHLENBQUMsQ0FBQyxDQUFDLEtBQUssR0FBRyxFQUFFO1lBQ2xCLEdBQUcsR0FBRyxHQUFHLENBQUMsU0FBUyxDQUFDLENBQUMsRUFBRSxHQUFHLENBQUMsTUFBTSxDQUFDLENBQUM7U0FDcEM7UUFDRCxJQUFJLEdBQUcsQ0FBQyxHQUFHLENBQUMsTUFBTSxHQUFHLENBQUMsQ0FBQyxLQUFLLEdBQUcsRUFBRTtZQUMvQixHQUFHLEdBQUcsR0FBRyxDQUFDLFNBQVMsQ0FBQyxDQUFDLEVBQUUsR0FBRyxDQUFDLE1BQU0sR0FBRyxDQUFDLENBQUMsQ0FBQztTQUN4QztRQUNELE9BQU8sR0FBRyxDQUFDO0lBQ2IsQ0FBQztJQUVPLHlDQUFXLEdBQW5CO1FBQ0UsSUFBSSxDQUFDLElBQUksQ0FBQyxTQUFTLEVBQUU7WUFDbkIsT0FBTztTQUNSO1FBQ0QsSUFBTSxRQUFRLEdBQUcsSUFBSSxDQUFDLE1BQU0sQ0FBQyxRQUFRLENBQUMsSUFBSSxDQUFDLE1BQU0sQ0FBQyxHQUFHLENBQUMsQ0FBQyxRQUFRLENBQUM7UUFDaEUsSUFBTSxHQUFHLEdBQUcsSUFBSSxDQUFDLE1BQU0sQ0FBQyxHQUFHLENBQUMsS0FBSyxDQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDO1FBQzFDLElBQU0sS0FBSyxHQUF3QixJQUFJLENBQUMsU0FBUyxDQUFDLEtBQUssRUFBRSxDQUFDO1FBQzFELElBQUksWUFBbUIsQ0FBQztRQUN4QixJQUFJLENBQUMsYUFBYSxHQUFHLFNBQVMsQ0FBQztRQUMvQixJQUFJLENBQUMsWUFBWSxHQUFHLFNBQVMsQ0FBQztRQUM5QixJQUFJLENBQUMsaUJBQWlCLEdBQUcsU0FBUyxDQUFDO1FBQ25DLElBQUksb0JBQXlCLENBQUM7O1lBRTVCLElBQU0sSUFBSSxHQUFHLEtBQUssQ0FBQyxHQUFHLEVBQUUsQ0FBQztZQUN6QixJQUFJLE9BQU8sQ0FBQyxJQUFJLENBQUMsRUFBRTtnQkFDakIsWUFBWSxHQUFHLElBQUksQ0FBQztnQkFDcEIsSUFBSSxDQUFDLFFBQVEsQ0FBQyxHQUFHLENBQUMsVUFBQSxPQUFPLElBQU0sS0FBSyxDQUFDLElBQUksQ0FBQyxPQUFPLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDO2FBQ3hEO2lCQUFNO2dCQUNMLElBQUksb0JBQW9CLElBQUksSUFBSSxJQUFJLE9BQUssU0FBUyxDQUFDLEdBQUcsQ0FBQyxDQUFDLFVBQVUsQ0FBQyxPQUFLLFNBQVMsQ0FBQyxJQUFJLENBQUMsS0FBSyxDQUFDLENBQUMsRUFBRTtvQkFDOUYsb0JBQW9CLEdBQUcsSUFBSSxDQUFDO2lCQUM3QjtnQkFDRCxJQUFJLElBQUksQ0FBQyxLQUFLLElBQUksT0FBSyxTQUFTLENBQUMsR0FBRyxDQUFDLENBQUMsUUFBUSxDQUFDLE9BQUssU0FBUyxDQUFDLElBQUksQ0FBQyxLQUFLLEdBQUcsT0FBSyxZQUFZLENBQUMsSUFBSSxDQUFDLE1BQU0sQ0FBQyxDQUFDLENBQUMsRUFBRTtvQkFDM0csSUFBSSxPQUFLLFlBQVksSUFBSSxPQUFLLFlBQVksQ0FBQyxLQUFLLElBQUksT0FBSyxZQUFZLENBQUMsS0FBSyxDQUFDLE1BQU0sR0FBRyxJQUFJLENBQUMsS0FBSyxDQUFDLE1BQU0sRUFBRTs7cUJBRXZHO29CQUNELElBQUksSUFBSSxDQUFDLE1BQU0sSUFBSSxJQUFJLENBQUMsTUFBTSxDQUFDLE1BQU0sR0FBRyxDQUFDLEVBQUU7d0JBQ3pDLElBQU0sUUFBTSxHQUFHLElBQUksTUFBTSxFQUFFLENBQUM7d0JBQzVCLElBQUksQ0FBQyxNQUFNLENBQUMsT0FBTyxDQUFDLFVBQUEsQ0FBQzs0QkFDbkIsUUFBTSxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsR0FBRyxDQUFDLENBQUMsS0FBSyxDQUFDO3dCQUMzQixDQUFDLENBQUMsQ0FBQzt3QkFDSCxJQUFJLElBQUksQ0FBQyxTQUFTLENBQUMsT0FBSyxNQUFNLENBQUMsS0FBSyxJQUFJLENBQUMsU0FBUyxDQUFDLFFBQU0sQ0FBQyxFQUFFOzRCQUMxRCxPQUFLLFlBQVksR0FBRyxJQUFJLENBQUM7eUJBQzFCO3FCQUNGO3lCQUFNO3dCQUNMLE9BQUssWUFBWSxHQUFHLElBQUksQ0FBQztxQkFDMUI7b0JBQ0QsSUFBSSxjQUFjLENBQUMsSUFBSSxDQUFDLEVBQUU7d0JBQ3hCLE9BQUssYUFBYSxHQUFHLFNBQVMsQ0FBQztxQkFDaEM7eUJBQU07d0JBQ0wsT0FBSyxhQUFhLEdBQUcsWUFBWSxDQUFDO3FCQUNuQztvQkFFRCxJQUFJLElBQUksQ0FBQyxVQUFVLElBQUksSUFBSSxDQUFDLFVBQVUsQ0FBQyxNQUFNLEdBQUcsQ0FBQyxFQUFFO3dCQUNqRCxJQUFNLGNBQWMsR0FBRyxJQUFJLENBQUMsVUFBVSxDQUFDLFNBQVMsQ0FBQyxVQUFDLENBQUMsSUFBSyxPQUFBLENBQUMsQ0FBQyxFQUFFLEtBQUssUUFBUSxFQUFqQixDQUFpQixDQUFDLENBQUM7d0JBQzNFLElBQUksUUFBUSxJQUFJLElBQUksQ0FBQyxVQUFVLElBQUksY0FBYyxLQUFLLENBQUMsQ0FBQyxFQUFFOzRCQUN4RCxPQUFLLGlCQUFpQixHQUFHLFFBQVEsQ0FBQzs0QkFDbEMsT0FBSyxzQkFBc0IsR0FBRyxjQUFjLENBQUM7eUJBQzlDO3FCQUNGO2lCQUNGO2FBQ0Y7OztRQXRDSCxPQUFPLEtBQUssQ0FBQyxNQUFNOztTQXVDbEI7UUFDRCxJQUFJLElBQUksQ0FBQyxZQUFZLElBQUksSUFBSSxFQUFFO1lBQzdCLElBQUksQ0FBQyxZQUFZLEdBQUcsb0JBQW9CLENBQUM7U0FDMUM7SUFDSCxDQUFDO0lBRUQ7O01BRUU7SUFDRix5Q0FBVyxHQUFYLFVBQVksT0FBc0I7UUFDaEMsSUFBSSxPQUFPLENBQUMsV0FBVyxDQUFDLEVBQUU7WUFDeEIsSUFBSSxDQUFDLFdBQVcsRUFBRSxDQUFDO1NBQ3BCO0lBQ0gsQ0FBQztJQUVEOztNQUVFO0lBQ0YseUNBQVcsR0FBWDtRQUNFLElBQUksQ0FBQyxZQUFZLENBQUMsV0FBVyxFQUFFLENBQUM7SUFDbEMsQ0FBQztJQUVEOztNQUVFO0lBQ0YsdUNBQVMsR0FBVCxVQUFVLE1BQWdCO1FBQ3hCLElBQUksTUFBTSxJQUFJLE1BQU0sQ0FBQyxNQUFNLEdBQUcsQ0FBQyxFQUFFO1lBQy9CLElBQU0sUUFBTSxHQUFHLEVBQUUsQ0FBQztZQUNsQixNQUFNLENBQUMsT0FBTyxDQUFDLFVBQUEsS0FBSztnQkFDbEIsUUFBTSxDQUFDLEtBQUssQ0FBQyxJQUFJLENBQUMsR0FBRyxLQUFLLENBQUMsS0FBSyxDQUFDO1lBQ25DLENBQUMsQ0FBQyxDQUFDO1lBQ0gsT0FBTyxRQUFNLENBQUM7U0FDZjthQUFNO1lBQ0wsT0FBTyxJQUFJLENBQUM7U0FDYjtJQUNILENBQUM7SUFFRDs7TUFFRTtJQUNILDBDQUFZLEdBQVosVUFBYSxNQUFnQjtRQUM1QixJQUFJLE1BQU0sSUFBSSxNQUFNLENBQUMsTUFBTSxHQUFHLENBQUMsRUFBRTtZQUMvQixJQUFJLEtBQUcsR0FBRyxHQUFHLENBQUM7WUFDZCxNQUFNLENBQUMsT0FBTyxDQUFDLFVBQUEsS0FBSztnQkFDbEIsS0FBRyxJQUFJLEtBQUssQ0FBQyxJQUFJLEdBQUcsR0FBRyxHQUFHLEtBQUssQ0FBQyxLQUFLLEdBQUcsR0FBRyxDQUFDO1lBQzlDLENBQUMsQ0FBQyxDQUFDO1lBQ0gsT0FBTyxLQUFHLENBQUMsS0FBSyxDQUFDLENBQUMsRUFBRSxDQUFDLENBQUMsQ0FBQyxDQUFDO1NBQ3pCO2FBQU07WUFDTCxPQUFPLEVBQUUsQ0FBQztTQUNYO0lBQ0gsQ0FBQzs7Z0JBcExtQixNQUFNO2dCQUVGLGNBQWM7O0lBM0RwQztRQUZDLEtBQUssRUFBRTtRQUNQLFdBQVcsQ0FBQyxZQUFZLENBQUM7OzttREFHekI7SUFNRDtRQURDLEtBQUssRUFBRTtrQ0FDVSxLQUFLOzBEQUF1QjtJQVE5QztRQUZDLEtBQUssRUFBRTtRQUNQLFdBQVcsQ0FBQyxrQkFBa0IsQ0FBQzs7MkRBQ0w7SUFRM0I7UUFGQyxLQUFLLEVBQUU7UUFDUCxXQUFXLENBQUMsY0FBYyxDQUFDOzt1REFDTDtJQU12QjtRQURDLE1BQU0sRUFBRTtrQ0FDVSxZQUFZOzJEQUErQjtJQTFEbkQsbUJBQW1CO1FBakIvQixTQUFTLENBQUM7WUFDVCxRQUFRLEVBQUUsY0FBYztZQUN4QiwweUpBQTRDO1lBRTVDLFVBQVUsRUFBRTtnQkFDVixPQUFPLENBQUMsZ0JBQWdCLEVBQUU7b0JBQ3hCLFVBQVUsQ0FBQyxRQUFRLEVBQUU7d0JBQ25CLEtBQUssQ0FBQyxFQUFFLFlBQVksRUFBRSxLQUFLLEVBQUUsQ0FBQzt3QkFDOUIsT0FBTyxDQUFDLGVBQWUsRUFBRSxLQUFLLENBQUMsRUFBRSxTQUFTLEVBQUUsZ0JBQWdCLEVBQUUsWUFBWSxFQUFFLE9BQU8sRUFBRSxDQUFDLENBQUM7cUJBQ3hGLENBQUM7b0JBQ0YsVUFBVSxDQUFDLFFBQVEsRUFBRTt3QkFDbkIsS0FBSyxDQUFDLEVBQUUsWUFBWSxFQUFFLE9BQU8sRUFBRSxDQUFDO3dCQUNoQyxPQUFPLENBQUMsZUFBZSxFQUFFLEtBQUssQ0FBQyxFQUFFLFlBQVksRUFBRSxLQUFLLEVBQUUsQ0FBQyxDQUFDO3FCQUN6RCxDQUFDO2lCQUNILENBQUM7YUFDSDs7U0FDRixDQUFDO3lDQXNGa0IsTUFBTTtZQUVGLGNBQWM7T0F2RnpCLG1CQUFtQixDQTBRL0I7SUFBRCwwQkFBQztDQUFBLEFBMVFELElBMFFDO1NBMVFZLG1CQUFtQjtBQTRRaEM7O0VBRUU7QUFDRixTQUFTLE9BQU8sQ0FBQyxJQUFrQjtJQUNqQyxPQUFRLElBQWMsQ0FBQyxRQUFRLEtBQUssU0FBUyxJQUFLLElBQWMsQ0FBQyxRQUFRLENBQUMsTUFBTSxHQUFHLENBQUMsQ0FBQztBQUN2RixDQUFDO0FBRUQ7O0VBRUU7QUFDRixTQUFTLGNBQWMsQ0FBQyxJQUFrQjtJQUN4QyxPQUFPLENBQUMsT0FBTyxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUUsSUFBcUIsQ0FBQyxJQUFJLEtBQUssU0FBUyxJQUFLLElBQXFCLENBQUMsT0FBTyxLQUFLLFNBQVMsQ0FBQyxDQUFDO0FBQ3ZILENBQUMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQge1xyXG4gIENvbXBvbmVudCwgT3V0cHV0LCBFdmVudEVtaXR0ZXIsIElucHV0LCBPbkRlc3Ryb3ksIE9uQ2hhbmdlcywgU2ltcGxlQ2hhbmdlcywgSG9zdEJpbmRpbmdcclxufSBmcm9tICdAYW5ndWxhci9jb3JlJztcclxuaW1wb3J0IHsgdHJpZ2dlciwgc3R5bGUsIGFuaW1hdGUsIHRyYW5zaXRpb259IGZyb20gJ0Bhbmd1bGFyL2FuaW1hdGlvbnMnO1xyXG5pbXBvcnQgeyBUb3BMZXZlbFBhZ2UsIEdyb3VwLCBQYWdlLCBQYXJhbXMgfSBmcm9tICcuL21lbnUtaXRlbXMnO1xyXG5cclxuaW1wb3J0IHsgUm91dGVyLCBBY3RpdmF0aW9uRW5kLCBBY3RpdmF0ZWRSb3V0ZSB9IGZyb20gJ0Bhbmd1bGFyL3JvdXRlcic7XHJcbmltcG9ydCB7IGZpbHRlciB9IGZyb20gJ3J4anMvb3BlcmF0b3JzJztcclxuaW1wb3J0IHsgU3Vic2NyaXB0aW9uIH0gZnJvbSAncnhqcyc7XHJcbmltcG9ydCAnQGF2bC1jb250cm9scy9jb3JlL2Rpc3QvYXZsLWljb24vYXZsLWljb24nO1xyXG5cclxuY29uc3Qgcm93SGVpZ2h0UHggPSA0ODtcclxuXHJcbkBDb21wb25lbnQoe1xyXG4gIHNlbGVjdG9yOiAnYXZsLXNpZGUtbmF2JyxcclxuICB0ZW1wbGF0ZVVybDogJy4vYXZsLXNpZGUtbmF2LmNvbXBvbmVudC5odG1sJyxcclxuICBzdHlsZVVybHM6IFsnLi9hdmwtc2lkZS1uYXYuY29tcG9uZW50LmNzcyddLFxyXG4gIGFuaW1hdGlvbnM6IFtcclxuICAgIHRyaWdnZXIoJ2V4cGFuZENvbGxhcHNlJywgW1xyXG4gICAgICB0cmFuc2l0aW9uKCc6ZW50ZXInLCBbXHJcbiAgICAgICAgc3R5bGUoeyAnbWF4LWhlaWdodCc6ICcwcHgnIH0pLFxyXG4gICAgICAgIGFuaW1hdGUoJzIyNW1zIGVhc2UtaW4nLCBzdHlsZSh7IHRyYW5zZm9ybTogJ3RyYW5zbGF0ZVkoMCUpJywgJ21heC1oZWlnaHQnOiAnMjAwcHgnIH0pKVxyXG4gICAgICBdKSxcclxuICAgICAgdHJhbnNpdGlvbignOmxlYXZlJywgW1xyXG4gICAgICAgIHN0eWxlKHsgJ21heC1oZWlnaHQnOiAnMjAwcHgnIH0pLFxyXG4gICAgICAgIGFuaW1hdGUoJzE4MG1zIGVhc2UtaW4nLCBzdHlsZSh7ICdtYXgtaGVpZ2h0JzogJzBweCcgfSkpXHJcbiAgICAgIF0pXHJcbiAgICBdKVxyXG4gIF1cclxufSlcclxuZXhwb3J0IGNsYXNzIEF2bFNpZGVOYXZDb21wb25lbnQgaW1wbGVtZW50cyBPbkRlc3Ryb3ksIE9uQ2hhbmdlcyB7XHJcblxyXG4gIC8qKlxyXG4gICAqXHJcbiAgICogIyMjIFN0eWxpbmdcclxuICAgKiBUaGUgZm9sbG93aW5nIGN1c3RvbSBwcm9wZXJ0aWVzIGFyZSBhdmFpbGFibGUgZm9yIHN0eWxpbmc6XHJcbiAgICpcclxuICAgKiBDdXN0b20gcHJvcGVydHkgICAgICAgICAgICAgICAgICAgICAgICAgIHwgRGVzY3JpcHRpb24gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfCBEZWZhdWx0XHJcbiAgICogOi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS18Oi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLXw6LS0tLS0tLS0tXHJcbiAgICogYC0tYXZsLWFwcC1iYXItaGVpZ2h0YCAgICAgICAgICAgICAgICAgICB8IEhlaWdodCBvZiB0aGUgdG9vbGJhci4gTmVlZGVkIHNvIHRoYXQgdGhlIGF2bC1zaWRlLW5hdiBjYW4gYmUgY29ycmVjdGx5IHBvc2l0aW9uZWQgYmVsb3cgdGhlIHRvb2xiYXIuIHwgYDU2cHhgXHJcbiAgICogYC0tYXZsLXNpZGUtbmF2LXByb2R1Y3QtY29sb3JgICAgICAgICAgICB8IFVzZWQgZm9yIHNlbGVjdGVkIGNvbG9yICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHwgYC0tYXZsLXByb2R1Y3Qtc2VsZWN0ZWRgXHJcbiAgICogYC0tYXZsLXNpZGUtbmF2LXByb2R1Y3QtY29sb3ItaG92ZXJgICAgICB8IFVzZWQgZm9yIGhvdmVyIGNvbG9yLiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHwgYC0tYXZsLXByb2R1Y3QtaG92ZXJgXHJcbiAgICogYC0tYXZsLXNpZGUtbmF2LXRleHQtY29sb3JgICAgICAgICAgICAgICB8IENvbG9yIG9mIHRoZSB0ZXh0ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHwgYC0tYXZsLWVtcGhhc2lzLWhpZ2gtY29sb3JgXHJcbiAgICogYC0tYXZsLXNpZGUtbmF2LWljb25zLWNvbG9yYCAgICAgICAgICAgICB8IENvbG9yIG9mIGljb25zICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHwgYC0tYXZsLWVtcGhhc2lzLW1lZGl1bS1jb2xvcmBcclxuICAgKiBgLS1hdmwtc2lkZS1uYXYtYmFja2dyb3VuZC1jb2xvcmAgICAgICAgIHwgQmFja2dyb3VuZCBjb2xvciBvZiB0aGUgYXZsLXNpZGUtbmF2ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfCBgLS1hdmwtc2lkZS1uYXYtY29sb3JgXHJcbiAgICogYC0tYXZsLXNpZGUtbmF2LW9wZW4td2lkdGhgICAgICAgICAgICAgICB8IFdpZHRoIG9mIHRoZSBhdmwtc2lkZS1uYXYgaW4gdGhlIG9wZW4gc3RhdGUuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHwgYDI1NnB4YFxyXG4gICAqXHJcbiAgICovXHJcbiAgX3N0eWxpbmc6IGFueTtcclxuXHJcbiAgcHJpdmF0ZSBvcGVuVmFsdWUgPSBmYWxzZTtcclxuXHJcbiAgLyoqXHJcbiAgICogQ2FuIGJlIHNldCB0byBvcGVuIG9yIGNsb3NlIHRoZSBzaWRlIG5hdi5cclxuICAgKiBSZXR1cm5zIHRoZSBjdXJyZW50IHN0YXRlIG9mIHRoZSBzaWRlIG5hdi5cclxuICAgKi9cclxuICBASW5wdXQoKVxyXG4gIEBIb3N0QmluZGluZygnY2xhc3Mub3BlbicpXHJcbiAgcHVibGljIGdldCBvcGVuKCk6IGJvb2xlYW4ge1xyXG4gICAgcmV0dXJuIHRoaXMub3BlblZhbHVlO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogSXRlbXMgdGhhdCBhcmUgc2hvd24gaW4gdGhlIHNpZGUgbmF2LlxyXG4gICAqL1xyXG4gIEBJbnB1dCgpXHJcbiAgcHVibGljIG1lbnVJdGVtczogQXJyYXk8VG9wTGV2ZWxQYWdlIHwgR3JvdXA+O1xyXG5cclxuICAvKipcclxuICAgKiBCb29sZWFuIHRvIHRvZ2dsZSByZXNwb25zaXZlIGZlYXR1cmVzXHJcbiAgICogT24gbW9iaWxlIHNjcmVlbnMgc2lkZW5hdiB0b2dnbGluZyBpcyB0cmlnZ2VyZWQgYnkgYnVyZ2VyIGljb24gaW4gYXBwLWJhciBhcyBwYXJ0IG9mIGFwcC1sYXlvdXRcclxuICAgKi9cclxuICBASW5wdXQoKVxyXG4gIEBIb3N0QmluZGluZygnY2xhc3MucmVzcG9uc2l2ZScpXHJcbiAgcHVibGljIHJlc3BvbnNpdmU6IGJvb2xlYW47XHJcblxyXG4gIC8qKlxyXG4gICAqIEJvb2xlYW4gdG8gc2V0IG9ubHkgbW9iaWxlIGZlYXR1cmVzIG9uXHJcbiAgICogT24gbW9iaWxlIHNjcmVlbnMgc2lkZW5hdiB0b2dnbGluZyBpcyB0cmlnZ2VyZWQgYnkgYnVyZ2VyIGljb24gaW4gYXBwLWJhciBhcyBwYXJ0IG9mIGFwcC1sYXlvdXRcclxuICAgKi9cclxuICBASW5wdXQoKVxyXG4gIEBIb3N0QmluZGluZygnY2xhc3MubW9iaWxlJylcclxuICBwdWJsaWMgbW9iaWxlOiBib29sZWFuO1xyXG5cclxuICAvKipcclxuICAgKiBFbWl0dGVkIHdoZW4gdGhlIG9wZW4gcHJvcGVydHkgY2hhbmdlcy5cclxuICAgKi9cclxuICBAT3V0cHV0KClcclxuICBwdWJsaWMgb3BlbkNoYW5nZTogRXZlbnRFbWl0dGVyPGJvb2xlYW4+ID0gbmV3IEV2ZW50RW1pdHRlcigpO1xyXG5cclxuICBwdWJsaWMgc2V0IG9wZW4odmFsOiBib29sZWFuKSB7XHJcbiAgICB0aGlzLm9wZW5WYWx1ZSA9IHZhbDtcclxuICAgIHRoaXMub3BlbkNoYW5nZS5uZXh0KHZhbCk7XHJcbiAgfVxyXG5cclxuICBwcml2YXRlIHN1YnNjcmlwdGlvbjogU3Vic2NyaXB0aW9uO1xyXG5cclxuICAvKipcclxuICAgKiBAaGlkZGVuXHJcbiAgICovXHJcbiAgcHVibGljIHNlbGVjdGVkR3JvdXA6IEdyb3VwO1xyXG5cclxuICAvKipcclxuICAgKiBAaGlkZGVuXHJcbiAgICovXHJcbiAgcHVibGljIHNlbGVjdGVkUGFnZTogUGFnZTtcclxuXHJcbiAgLyoqXHJcbiAgICogQGhpZGRlblxyXG4gICAqL1xyXG4gIHB1YmxpYyBzZWxlY3RlZFBhcmFncmFwaDogc3RyaW5nO1xyXG4gIHByaXZhdGUgc2VsZWN0ZWRQYXJhZ3JhcGhJbmRleDogbnVtYmVyO1xyXG4gIHByaXZhdGUgcGFyYW1zOiBhbnk7XHJcblxyXG4gIGNvbnN0cnVjdG9yKFxyXG4gICAgcHJpdmF0ZSByb3V0ZXI6IFJvdXRlcixcclxuXHJcbiAgICBwdWJsaWMgYWN0aXZlUm91dGU6IEFjdGl2YXRlZFJvdXRlXHJcbiAgICApIHtcclxuICAgIGFjdGl2ZVJvdXRlLnF1ZXJ5UGFyYW1zLnN1YnNjcmliZShwID0+IHtcclxuICAgICAgdGhpcy5wYXJhbXMgPSBwO1xyXG4gICAgfSk7XHJcbiAgICB0aGlzLnN1YnNjcmlwdGlvbiA9IHRoaXMucm91dGVyLmV2ZW50c1xyXG4gICAgICAucGlwZShmaWx0ZXIoZXZlbnQgPT4gZXZlbnQgaW5zdGFuY2VvZiBBY3RpdmF0aW9uRW5kKSlcclxuICAgICAgLnN1YnNjcmliZSgoZXZlbnQ6IEFjdGl2YXRpb25FbmQpID0+IHtcclxuICAgICAgICB0aGlzLnNlbGVjdEl0ZW1zKCk7XHJcbiAgICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogQGhpZGRlblxyXG4gICAqL1xyXG4gIHB1YmxpYyB0b2dnbGVPcGVuKCkge1xyXG4gICAgaWYoIXRoaXMubWFudWFsbHlPcGVuZWQpIHtcclxuICAgICAgdGhpcy5vcGVuID0gIXRoaXMub3BlbjtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIHByaXZhdGUgbWFudWFsbHlPcGVuZWQ6IGJvb2xlYW47XHJcblxyXG4gIC8qKlxyXG4gICAqIEBoaWRkZW5cclxuICAgKi9cclxuICBwdWJsaWMgYXJyb3dUb2dnbGVPcGVuKCkge1xyXG4gICAgICB0aGlzLm1hbnVhbGx5T3BlbmVkID0gIXRoaXMub3BlbjtcclxuICAgICAgdGhpcy5vcGVuID0gIXRoaXMub3BlbjtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIEBoaWRkZW5cclxuICAgKi9cclxuICBwdWJsaWMgbW9iaWxlQ2xvc2UoKSB7XHJcbiAgICBpZihNYXRoLm1heChkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuY2xpZW50V2lkdGgsIHdpbmRvdy5pbm5lcldpZHRoKSA8IDk2MCkge1xyXG4gICAgICB0aGlzLm9wZW4gPSBmYWxzZTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIEBoaWRkZW5cclxuICAgKi9cclxuICBwdWJsaWMgZ3JvdXBDbGlja2VkKGl0ZW0pIHtcclxuICAgIGlmICghdGhpcy5vcGVuKSB7XHJcbiAgICAgIHRoaXMub3BlbiA9IHRydWU7XHJcbiAgICAgIGlmICghaXRlbS5leHBhbmRlZCkge1xyXG4gICAgICAgIGl0ZW0uZXhwYW5kZWQgPSB0cnVlO1xyXG4gICAgICB9XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICBpdGVtLmV4cGFuZGVkID0gIWl0ZW0uZXhwYW5kZWQ7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBAaGlkZGVuXHJcbiAgICovXHJcbiAgcHVibGljIGdldFNjcnViYmVyU3R5bGUoKSB7XHJcbiAgICByZXR1cm4ge1xyXG4gICAgICBoZWlnaHQ6IHRoaXMuc2VsZWN0ZWRQYXJhZ3JhcGggPyAnMTRweCcgOiAnMHB4JyxcclxuICAgICAgdG9wOiBgJHt0aGlzLnNlbGVjdGVkUGFyYWdyYXBoSW5kZXggKiByb3dIZWlnaHRQeH1weGBcclxuICAgIH07XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAqIEBoaWRkZW5cclxuICAqL1xyXG4gIHB1YmxpYyB0cmltU2xhc2goc3RyOiBzdHJpbmcpIHtcclxuICAgIGlmIChzdHJbMF0gPT09ICcvJykge1xyXG4gICAgICBzdHIgPSBzdHIuc3Vic3RyaW5nKDEsIHN0ci5sZW5ndGgpO1xyXG4gICAgfVxyXG4gICAgaWYgKHN0cltzdHIubGVuZ3RoIC0gMV0gPT09ICcvJykge1xyXG4gICAgICBzdHIgPSBzdHIuc3Vic3RyaW5nKDAsIHN0ci5sZW5ndGggLSAxKTtcclxuICAgIH1cclxuICAgIHJldHVybiBzdHI7XHJcbiAgfVxyXG5cclxuICBwcml2YXRlIHNlbGVjdEl0ZW1zKCkge1xyXG4gICAgaWYgKCF0aGlzLm1lbnVJdGVtcykge1xyXG4gICAgICByZXR1cm47XHJcbiAgICB9XHJcbiAgICBjb25zdCBmcmFnbWVudCA9IHRoaXMucm91dGVyLnBhcnNlVXJsKHRoaXMucm91dGVyLnVybCkuZnJhZ21lbnQ7XHJcbiAgICBjb25zdCB1cmwgPSB0aGlzLnJvdXRlci51cmwuc3BsaXQoJyMnKVswXTtcclxuICAgIGNvbnN0IHF1ZXVlOiBBcnJheTxQYWdlIHwgR3JvdXA+ID0gdGhpcy5tZW51SXRlbXMuc2xpY2UoKTtcclxuICAgIGxldCBjdXJyZW50R3JvdXA6IEdyb3VwO1xyXG4gICAgdGhpcy5zZWxlY3RlZEdyb3VwID0gdW5kZWZpbmVkO1xyXG4gICAgdGhpcy5zZWxlY3RlZFBhZ2UgPSB1bmRlZmluZWQ7XHJcbiAgICB0aGlzLnNlbGVjdGVkUGFyYWdyYXBoID0gdW5kZWZpbmVkO1xyXG4gICAgbGV0IGZhbGxiYWNrU2VsZWN0ZWRQYWdlOiBhbnk7XHJcbiAgICB3aGlsZSAocXVldWUubGVuZ3RoKSB7XHJcbiAgICAgIGNvbnN0IGl0ZW0gPSBxdWV1ZS5wb3AoKTtcclxuICAgICAgaWYgKGlzR3JvdXAoaXRlbSkpIHtcclxuICAgICAgICBjdXJyZW50R3JvdXAgPSBpdGVtO1xyXG4gICAgICAgIGl0ZW0uc3ViSXRlbXMubWFwKHN1Yml0ZW0gPT4geyBxdWV1ZS5wdXNoKHN1Yml0ZW0pOyB9KTtcclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICBpZiAoZmFsbGJhY2tTZWxlY3RlZFBhZ2UgPT0gbnVsbCAmJiB0aGlzLnRyaW1TbGFzaCh1cmwpLnN0YXJ0c1dpdGgodGhpcy50cmltU2xhc2goaXRlbS5yb3V0ZSkpKSB7XHJcbiAgICAgICAgICBmYWxsYmFja1NlbGVjdGVkUGFnZSA9IGl0ZW07XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmIChpdGVtLnJvdXRlICYmIHRoaXMudHJpbVNsYXNoKHVybCkuZW5kc1dpdGgodGhpcy50cmltU2xhc2goaXRlbS5yb3V0ZSArIHRoaXMuZ2V0VXJsUGFyYW1zKGl0ZW0ucGFyYW1zKSkpKSB7XHJcbiAgICAgICAgICBpZiAodGhpcy5zZWxlY3RlZFBhZ2UgJiYgdGhpcy5zZWxlY3RlZFBhZ2Uucm91dGUgJiYgdGhpcy5zZWxlY3RlZFBhZ2Uucm91dGUubGVuZ3RoID4gaXRlbS5yb3V0ZS5sZW5ndGgpIHtcclxuICAgICAgICAgICAgY29udGludWU7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgICBpZiAoaXRlbS5wYXJhbXMgJiYgaXRlbS5wYXJhbXMubGVuZ3RoID4gMCkge1xyXG4gICAgICAgICAgICBjb25zdCBvYmplY3QgPSBuZXcgT2JqZWN0KCk7XHJcbiAgICAgICAgICAgIGl0ZW0ucGFyYW1zLmZvckVhY2goaSA9PiB7XHJcbiAgICAgICAgICAgICAgb2JqZWN0W2kubmFtZV0gPSBpLnZhbHVlO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgaWYgKEpTT04uc3RyaW5naWZ5KHRoaXMucGFyYW1zKSA9PT0gSlNPTi5zdHJpbmdpZnkob2JqZWN0KSkge1xyXG4gICAgICAgICAgICAgIHRoaXMuc2VsZWN0ZWRQYWdlID0gaXRlbTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgdGhpcy5zZWxlY3RlZFBhZ2UgPSBpdGVtO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgICAgaWYgKGlzVG9wTGV2ZWxQYWdlKGl0ZW0pKSB7XHJcbiAgICAgICAgICAgIHRoaXMuc2VsZWN0ZWRHcm91cCA9IHVuZGVmaW5lZDtcclxuICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIHRoaXMuc2VsZWN0ZWRHcm91cCA9IGN1cnJlbnRHcm91cDtcclxuICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICBpZiAoaXRlbS5wYXJhZ3JhcGhzICYmIGl0ZW0ucGFyYWdyYXBocy5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IHBhcmFncmFwaEluZGV4ID0gaXRlbS5wYXJhZ3JhcGhzLmZpbmRJbmRleCgocCkgPT4gcC5pZCA9PT0gZnJhZ21lbnQpO1xyXG4gICAgICAgICAgICBpZiAoZnJhZ21lbnQgJiYgaXRlbS5wYXJhZ3JhcGhzICYmIHBhcmFncmFwaEluZGV4ICE9PSAtMSkge1xyXG4gICAgICAgICAgICAgIHRoaXMuc2VsZWN0ZWRQYXJhZ3JhcGggPSBmcmFnbWVudDtcclxuICAgICAgICAgICAgICB0aGlzLnNlbGVjdGVkUGFyYWdyYXBoSW5kZXggPSBwYXJhZ3JhcGhJbmRleDtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG4gICAgfVxyXG4gICAgaWYgKHRoaXMuc2VsZWN0ZWRQYWdlID09IG51bGwpIHtcclxuICAgICAgdGhpcy5zZWxlY3RlZFBhZ2UgPSBmYWxsYmFja1NlbGVjdGVkUGFnZTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICogQGhpZGRlblxyXG4gICovXHJcbiAgbmdPbkNoYW5nZXMoY2hhbmdlczogU2ltcGxlQ2hhbmdlcykge1xyXG4gICAgaWYgKGNoYW5nZXNbJ21lbnVJdGVtcyddKSB7XHJcbiAgICAgIHRoaXMuc2VsZWN0SXRlbXMoKTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICogQGhpZGRlblxyXG4gICovXHJcbiAgbmdPbkRlc3Ryb3koKSB7XHJcbiAgICB0aGlzLnN1YnNjcmlwdGlvbi51bnN1YnNjcmliZSgpO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgKiBAaGlkZGVuXHJcbiAgKi9cclxuICBnZXRQYXJhbXMocGFyYW1zOiBQYXJhbXNbXSkge1xyXG4gICAgaWYgKHBhcmFtcyAmJiBwYXJhbXMubGVuZ3RoID4gMCkge1xyXG4gICAgICBjb25zdCBvYmplY3QgPSB7fTtcclxuICAgICAgcGFyYW1zLmZvckVhY2gocGFyYW0gPT4ge1xyXG4gICAgICAgIG9iamVjdFtwYXJhbS5uYW1lXSA9IHBhcmFtLnZhbHVlO1xyXG4gICAgICB9KTtcclxuICAgICAgcmV0dXJuIG9iamVjdDtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIHJldHVybiBudWxsO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgKiBAaGlkZGVuXHJcbiAgKi9cclxuIGdldFVybFBhcmFtcyhwYXJhbXM6IFBhcmFtc1tdKSB7XHJcbiAgaWYgKHBhcmFtcyAmJiBwYXJhbXMubGVuZ3RoID4gMCkge1xyXG4gICAgbGV0IHVybCA9ICc/JztcclxuICAgIHBhcmFtcy5mb3JFYWNoKHBhcmFtID0+IHtcclxuICAgICAgdXJsICs9IHBhcmFtLm5hbWUgKyAnPScgKyBwYXJhbS52YWx1ZSArICcmJztcclxuICAgIH0pO1xyXG4gICAgcmV0dXJuIHVybC5zbGljZSgwLCAtMSk7XHJcbiAgfSBlbHNlIHtcclxuICAgIHJldHVybiAnJztcclxuICB9XHJcbn1cclxufVxyXG5cclxuLyoqXHJcbiogQGhpZGRlblxyXG4qL1xyXG5mdW5jdGlvbiBpc0dyb3VwKGl0ZW06IFBhZ2UgfCBHcm91cCk6IGl0ZW0gaXMgR3JvdXAge1xyXG4gIHJldHVybiAoaXRlbSBhcyBHcm91cCkuc3ViSXRlbXMgIT09IHVuZGVmaW5lZCAmJiAoaXRlbSBhcyBHcm91cCkuc3ViSXRlbXMubGVuZ3RoID4gMDtcclxufVxyXG5cclxuLyoqXHJcbiogQGhpZGRlblxyXG4qL1xyXG5mdW5jdGlvbiBpc1RvcExldmVsUGFnZShpdGVtOiBQYWdlIHwgR3JvdXApOiBpdGVtIGlzIFRvcExldmVsUGFnZSB7XHJcbiAgcmV0dXJuICFpc0dyb3VwKGl0ZW0pICYmICgoaXRlbSBhcyBUb3BMZXZlbFBhZ2UpLmljb24gIT09IHVuZGVmaW5lZCB8fCAoaXRlbSBhcyBUb3BMZXZlbFBhZ2UpLmljb25VcmwgIT09IHVuZGVmaW5lZCk7XHJcbn1cclxuXHJcbiJdfQ==