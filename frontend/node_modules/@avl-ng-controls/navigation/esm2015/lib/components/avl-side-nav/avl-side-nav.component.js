import { Component, Output, EventEmitter, Input, HostBinding } from '@angular/core';
import { trigger, style, animate, transition } from '@angular/animations';
import { ActivationEnd } from '@angular/router';
import { filter } from 'rxjs/operators';
import '@avl-controls/core/dist/avl-icon/avl-icon';
import * as i0 from "@angular/core";
import * as i1 from "@angular/router";
import * as i2 from "@angular/common";
const rowHeightPx = 48;
export class AvlSideNavComponent {
    constructor(router, activeRoute) {
        this.router = router;
        this.activeRoute = activeRoute;
        this.openValue = false;
        /**
         * Specific for shell usage. When side-nav is used in application inside a shell (iframe)
         * this parameter containing shell url enables opening correct url in new tab/window
         */
        this.shellUrl = '';
        /**
         * Emitted when the open property changes.
         */
        this.openChange = new EventEmitter();
        activeRoute.queryParams.subscribe(p => {
            this.params = p;
        });
        this.subscription = this.router.events
            .pipe(filter(event => event instanceof ActivationEnd))
            .subscribe((event) => {
            this.selectItems();
        });
    }
    /**
     * Can be set to open or close the side nav.
     * Returns the current state of the side nav.
     */
    get open() {
        return this.openValue;
    }
    set open(val) {
        this.openValue = val;
        this.openChange.next(val);
    }
    /**
     * @hidden
     */
    toggleOpen() {
        if (!this.manuallyOpened) {
            this.open = !this.open;
        }
    }
    /**
     * @hidden
     */
    arrowToggleOpen() {
        this.manuallyOpened = !this.open;
        this.open = !this.open;
    }
    /**
     * @hidden
     */
    mobileClose() {
        if (Math.max(document.documentElement.clientWidth, window.innerWidth) < 960) {
            this.open = false;
        }
    }
    navigateLocal(event, route, params, fragment) {
        if (!event.ctrlKey) {
            event.preventDefault();
            let navigationExtras = {
                queryParams: this.getParams(params),
                fragment: fragment
            };
            this.router.navigate([route], navigationExtras);
        }
    }
    /**
     * @hidden
     */
    groupClicked(item) {
        if (!this.open) {
            this.open = true;
            if (!item.expanded) {
                item.expanded = true;
            }
        }
        else {
            item.expanded = !item.expanded;
        }
    }
    /**
     * @hidden
     */
    getScrubberStyle() {
        return {
            height: this.selectedParagraph ? '14px' : '0px',
            top: `${this.selectedParagraphIndex * rowHeightPx}px`
        };
    }
    /**
     * @hidden
     */
    trimSlash(str) {
        if (str[0] === '/') {
            str = str.substring(1, str.length);
        }
        if (str[str.length - 1] === '/') {
            str = str.substring(0, str.length - 1);
        }
        return str;
    }
    selectItems() {
        if (!this.menuItems) {
            return;
        }
        const fragment = this.router.parseUrl(this.router.url).fragment;
        const url = this.router.url.split('#')[0];
        const queue = this.menuItems.slice();
        queue.sort((pageOne, pageTwo) => (pageOne.route < pageTwo.route ? -1 : 1));
        let currentGroup;
        this.selectedGroup = undefined;
        this.selectedPage = undefined;
        this.selectedParagraph = undefined;
        let fallbackSelectedPage;
        while (queue.length) {
            const item = queue.pop();
            if (isGroup(item)) {
                currentGroup = item;
                item.subItems.forEach(subitem => {
                    queue.push(subitem);
                });
            }
            else {
                if (fallbackSelectedPage == null &&
                    this.trimSlash(url).startsWith(this.trimSlash(item.route))) {
                    fallbackSelectedPage = item;
                }
                if (item.route &&
                    this.trimSlash(url).endsWith(this.trimSlash(item.route + this.getUrlParams(item.params)))) {
                    if (this.selectedPage &&
                        this.selectedPage.route &&
                        this.selectedPage.route.length > item.route.length) {
                        continue;
                    }
                    if (item.params && item.params.length > 0) {
                        const object = new Object();
                        item.params.forEach(i => {
                            object[i.name] = i.value;
                        });
                        if (JSON.stringify(this.params) === JSON.stringify(object)) {
                            this.selectedPage = item;
                        }
                    }
                    else {
                        this.selectedPage = item;
                    }
                    if (isTopLevelPage(item)) {
                        this.selectedGroup = undefined;
                    }
                    else {
                        this.selectedGroup = currentGroup;
                    }
                    if (item.paragraphs && item.paragraphs.length > 0) {
                        const paragraphIndex = item.paragraphs.findIndex(p => p.id === fragment);
                        if (fragment && item.paragraphs && paragraphIndex !== -1) {
                            this.selectedParagraph = fragment;
                            this.selectedParagraphIndex = paragraphIndex;
                        }
                    }
                }
            }
        }
        if (this.selectedPage == null) {
            this.selectedPage = fallbackSelectedPage;
        }
    }
    /**
     * @hidden
     */
    ngOnChanges(changes) {
        if (changes['menuItems']) {
            this.selectItems();
        }
    }
    /**
     * @hidden
     */
    ngOnDestroy() {
        this.subscription.unsubscribe();
    }
    /**
     * @hidden
     */
    getParams(params) {
        if (params && params.length > 0) {
            const object = {};
            params.forEach(param => {
                object[param.name] = param.value;
            });
            return object;
        }
        else {
            return {};
        }
    }
    /**
     * @hidden
     */
    getUrlParams(params) {
        if (params && params.length > 0) {
            let url = '?';
            params.forEach(param => {
                url += param.name + '=' + param.value + '&';
            });
            return url.slice(0, -1);
        }
        else {
            return '';
        }
    }
}
AvlSideNavComponent.ɵfac = i0.ɵɵngDeclareFactory({ minVersion: "12.0.0", version: "12.0.3", ngImport: i0, type: AvlSideNavComponent, deps: [{ token: i1.Router }, { token: i1.ActivatedRoute }], target: i0.ɵɵFactoryTarget.Component });
AvlSideNavComponent.ɵcmp = i0.ɵɵngDeclareComponent({ minVersion: "12.0.0", version: "12.0.3", type: AvlSideNavComponent, selector: "avl-side-nav", inputs: { open: "open", menuItems: "menuItems", responsive: "responsive", mobile: "mobile", shellUrl: "shellUrl" }, outputs: { openChange: "openChange" }, host: { properties: { "class.open": "this.open", "class.responsive": "this.responsive", "class.mobile": "this.mobile" } }, usesOnChanges: true, ngImport: i0, template: "<div #outerContainer [class.closed]=\"!open\" class=\"outer-container toolbar-spacing\">\r\n  <div class=\"item-scroll\">\r\n    <div #innerContainer class=\"inner-container\">\r\n      <ng-template ngFor let-item [ngForOf]=\"menuItems\">\r\n        <!-- Top level page -->\r\n        <a\r\n          *ngIf=\"!item.subItems && !shellUrl\"\r\n          tabindex=\"0\"\r\n          class=\"item top-level-page\"\r\n          routerLink=\"{{ item.route }}\"\r\n          [queryParams]=\"getParams(item.params)\"\r\n          [class.selected]=\"item === selectedPage\"\r\n          (click)=\"mobileClose()\"\r\n        >\r\n          <div class=\"image-div\">\r\n            <avl-icon *ngIf=\"item.icon\" attr.icon=\"{{ item.icon }}\"></avl-icon>\r\n            <img alt=\"[[item.name]]\" *ngIf=\"item.iconUrl\" [src]=\"item.iconUrl\" />\r\n          </div>\r\n          <div class=\"label-div\">{{ item.label }}</div>\r\n          <div class=\"item-overlay\"></div>\r\n        </a>\r\n        <a\r\n          *ngIf=\"!item.subItems && shellUrl\"\r\n          tabindex=\"0\"\r\n          class=\"item top-level-page\"\r\n          href=\"{{ shellUrl + '/' + trimSlash(item.route + getUrlParams(item.params)) }}\"\r\n          [class.selected]=\"item === selectedPage\"\r\n          (click)=\"mobileClose(); navigateLocal($event, item.route, item.params)\"\r\n        >\r\n          <div class=\"image-div\">\r\n            <avl-icon *ngIf=\"item.icon\" attr.icon=\"{{ item.icon }}\"></avl-icon>\r\n            <img alt=\"[[item.name]]\" *ngIf=\"item.iconUrl\" [src]=\"item.iconUrl\" />\r\n          </div>\r\n          <div class=\"label-div\">{{ item.label }}</div>\r\n          <div class=\"item-overlay\"></div>\r\n        </a>\r\n        <!-- Paragraphs of a top level page -->\r\n        <div\r\n          class=\"child-container\"\r\n          *ngIf=\"open && item.paragraphs && item.paragraphs.length > 0 && item === selectedPage\"\r\n          [@expandCollapse]\r\n        >\r\n          <!-- div for preventing reversing of the items by flex-direction: column-reverse -->\r\n          <div *ngIf=\"!shellUrl\">\r\n            <a\r\n              *ngFor=\"let paragraph of item.paragraphs\"\r\n              class=\"item top-level-paragraph\"\r\n              routerLink=\"{{ item.route }}\"\r\n              [queryParams]=\"getParams(item.params)\"\r\n              fragment=\"{{ paragraph.id }}\"\r\n              [class.selected]=\"paragraph.id === selectedParagraph\"\r\n              (click)=\"mobileClose()\"\r\n            >\r\n              <div class=\"label-div\">{{ paragraph.label }}</div>\r\n            </a>\r\n          </div>\r\n          <div *ngIf=\"shellUrl\">\r\n            <a\r\n              *ngFor=\"let paragraph of item.paragraphs\"\r\n              class=\"item top-level-paragraph\"\r\n              href=\"{{\r\n                shellUrl +\r\n                  '/' +\r\n                  trimSlash(item.route + getUrlParams(item.params)) +\r\n                  '#' +\r\n                  paragraph.id\r\n              }}\"\r\n              [class.selected]=\"paragraph.id === selectedParagraph\"\r\n              (click)=\"mobileClose(); navigateLocal($event, item.route, item.params, paragraph.id)\"\r\n            >\r\n              <div class=\"label-div\">{{ paragraph.label }}</div>\r\n            </a>\r\n          </div>\r\n          <div class=\"page-progress-bar\">\r\n            <div class=\"page-progress-bar-background\"></div>\r\n            <div class=\"page-progress-bar-scrubber\" [ngStyle]=\"getScrubberStyle()\"></div>\r\n          </div>\r\n        </div>\r\n        <!-- Group -->\r\n        <div\r\n          *ngIf=\"item.subItems\"\r\n          tabindex=\"0\"\r\n          class=\"item group\"\r\n          [class.expanded]=\"item.expanded\"\r\n          (click)=\"groupClicked(item)\"\r\n          [class.selected]=\"item === selectedGroup\"\r\n        >\r\n          <div class=\"image-div\">\r\n            <avl-icon *ngIf=\"item.icon\" attr.icon=\"{{ item.icon }}\"></avl-icon>\r\n            <img alt=\"[[item.name]]\" *ngIf=\"item.iconUrl\" [src]=\"item.iconUrl\" />\r\n          </div>\r\n          <div class=\"label-div group\">{{ item.label }}</div>\r\n          <avl-icon class=\"group-arrow\" icon=\"arrow-drop-down\"></avl-icon>\r\n          <div class=\"item-overlay\"></div>\r\n        </div>\r\n        <!-- Subpages -->\r\n        <div\r\n          class=\"child-container\"\r\n          *ngIf=\"open && item.subItems && item.subItems.length > 0 && item.expanded\"\r\n          [@expandCollapse]\r\n          (click)=\"toggleOpen()\"\r\n        >\r\n          <!-- div for preventing reversing of the items by flex-direction: column-reverse -->\r\n          <div>\r\n            <ng-template ngFor let-subItem [ngForOf]=\"item.subItems\">\r\n              <a\r\n                *ngIf=\"!shellUrl\"\r\n                class=\"item subpage\"\r\n                routerLink=\"{{ subItem.route }}\"\r\n                [queryParams]=\"getParams(subItem.params)\"\r\n                [class.selected]=\"subItem === selectedPage\"\r\n                (click)=\"mobileClose()\"\r\n              >\r\n                <div class=\"label-div\">{{ subItem.label }}</div>\r\n                <div class=\"item-overlay\"></div>\r\n              </a>\r\n              <a\r\n                *ngIf=\"shellUrl\"\r\n                class=\"item subpage\"\r\n                href=\"{{\r\n                  shellUrl + '/' + trimSlash(subItem.route + getUrlParams(subItem.params))\r\n                }}\"\r\n                [class.selected]=\"subItem === selectedPage\"\r\n                (click)=\"mobileClose(); navigateLocal($event, item.route, item.params)\"\r\n              >\r\n                <div class=\"label-div\">{{ subItem.label }}</div>\r\n                <div class=\"item-overlay\"></div>\r\n              </a>\r\n              <!-- Paragraphs of a subpage -->\r\n              <div\r\n                class=\"child-container\"\r\n                *ngIf=\"\r\n                  subItem.paragraphs && subItem.paragraphs.length > 0 && subItem === selectedPage\r\n                \"\r\n                [@expandCollapse]\r\n              >\r\n                <!-- div for preventing reversing of the items by flex-direction: column-reverse -->\r\n                <div *ngIf=\"!shellUrl\">\r\n                  <a\r\n                    *ngFor=\"let paragraph of subItem.paragraphs\"\r\n                    class=\"item subpage-paragraph\"\r\n                    routerLink=\"{{ subItem.route }}\"\r\n                    [queryParams]=\"getParams(subItem.params)\"\r\n                    fragment=\"{{ paragraph.id }}\"\r\n                    [class.selected]=\"paragraph.id === selectedParagraph\"\r\n                    (click)=\"mobileClose()\"\r\n                  >\r\n                    <div class=\"label-div\">{{ paragraph.label }}</div>\r\n                  </a>\r\n                </div>\r\n                <div *ngIf=\"shellUrl\">\r\n                  <a\r\n                    *ngFor=\"let paragraph of subItem.paragraphs\"\r\n                    class=\"item subpage-paragraph\"\r\n                    href=\"{{\r\n                      shellUrl +\r\n                        '/' +\r\n                        trimSlash(subItem.route + getUrlParams(item.params)) +\r\n                        '#' +\r\n                        paragraph.id\r\n                    }}\"\r\n                    [class.selected]=\"paragraph.id === selectedParagraph\"\r\n                    (click)=\"\r\n                      mobileClose(); navigateLocal($event, subItem.route, item.params, paragraph.id)\r\n                    \"\r\n                  >\r\n                    <div class=\"label-div\">{{ paragraph.label }}</div>\r\n                  </a>\r\n                </div>\r\n                <div class=\"page-progress-bar\">\r\n                  <div class=\"page-progress-bar-background\"></div>\r\n                  <div class=\"page-progress-bar-scrubber\" [ngStyle]=\"getScrubberStyle()\"></div>\r\n                </div>\r\n              </div>\r\n            </ng-template>\r\n          </div>\r\n        </div>\r\n      </ng-template>\r\n    </div>\r\n  </div>\r\n  <div class=\"arrow-spacer\"></div>\r\n\r\n  <svg\r\n    (click)=\"arrowToggleOpen()\"\r\n    [class.closed]=\"!open\"\r\n    class=\"open-close-arrow\"\r\n    id=\"Layer_1\"\r\n    data-name=\"Layer 1\"\r\n    xmlns=\"http://www.w3.org/2000/svg\"\r\n    width=\"24\"\r\n    height=\"24\"\r\n    viewBox=\"0 0 24 24\"\r\n  >\r\n    <g transform=\"translate(405 102) rotate(-180)\">\r\n      <path\r\n        d=\"M-972.955,492l6.774-6,1.581,1.4-5.194,4.6,5.194,4.6-1.581,1.4Zm-5.645,0,6.773-6,1.581,1.4-5.193,4.6,5.193,4.6-1.581,1.4Z\"\r\n        transform=\"translate(1364.6 -402)\"\r\n      />\r\n    </g>\r\n  </svg>\r\n</div>\r\n<div class=\"scrim\" (click)=\"open = false\"></div>\r\n", styles: [":host{font-family:var(--avl-font-family);height:100%;display:block;--text-color:var(--avl-side-nav-text-color,var(--avl-foreground-color));--icons-color:var(--avl-side-nav-icons-color,var(--avl-foreground-medium-color));--background-color:var(--avl-side-nav-background-color,var(--avl-sidenav-color));--item-icon-width:72px;--side-nav-mini-width:var(--item-icon-width);--side-nav-open-width:var(--avl-side-nav-open-width,256px);--item-height:48px;box-shadow:var(--avl-box-shadow-12dp);z-index:3}.outer-container{position:relative;box-sizing:content-box;height:calc(100% - 56px);height:calc(100% - var(--avl-app-bar-height, 56px));background-color:var(--background-color);overflow:hidden}.inner-container,.outer-container{width:var(--side-nav-open-width)}.toolbar-spacing{padding-top:56px;padding-top:var(--avl-app-bar-height,56px)}.open-close-arrow{position:absolute;bottom:12px;right:24px;font-size:24px;fill:var(--icons-color);cursor:pointer;-webkit-user-select:none;-moz-user-select:none;user-select:none;width:24px}.open-close-arrow:not(.closed){transform:scaleX(-1)}.outer-container.closed{width:var(--side-nav-mini-width)}.arrow-spacer{height:48px}.item-scroll{height:calc(100% - 48px);overflow-y:auto;overflow-x:hidden}.item{display:flex;align-items:center;cursor:pointer;height:var(--item-height);position:relative;overflow:hidden;white-space:nowrap;text-overflow:ellipsis;isolation:isolate}.item,.item:active{color:var(--text-color)}.top-level-paragraph{padding-left:88px}.subpage{padding-left:72px}.subpage-paragraph{padding-left:88px}.label-div{z-index:10;font-family:Roboto,sans-serif;max-width:160px;overflow:hidden;text-overflow:ellipsis;max-height:40px;word-break:break-word;-webkit-box-orient:vertical;display:-webkit-box;-webkit-line-clamp:2}.group.expanded>.label-div.group{font-family:Roboto-Medium,sans-serif}.label-div.group{max-width:calc(100% - 112px)}.image-div{color:var(--avl-foreground-medium-color);display:flex;align-items:center;justify-content:center;width:var(--item-icon-width);height:var(--item-height);margin-right:0;z-index:9}img{height:auto;width:auto;max-height:24px;max-width:24px}avl-icon{margin-bottom:0;font-size:24px}.group-arrow{position:absolute;right:24px}.group.expanded>.group-arrow{transform:rotate(180deg)}.item-overlay{box-sizing:border-box;position:absolute;height:100%;width:100%;left:0;z-index:0}.item.selected>.item-overlay{background-color:var(--avl-product-focus-color);background-color:var(--avl-side-nav-product-color,var(--avl-product-focus-color))}.item:hover:not(.selected)>.item-overlay{background-color:var(--avl-product-hover-color);background-color:var(--avl-side-nav-product-color-hover,var(--avl-product-hover-color))}.item{outline:none;white-space:pre-wrap;padding-right:24px}.item.selected{font-weight:500}.child-container{position:relative}.page-progress-bar{position:absolute;left:72px;top:11px;bottom:11px;width:2px;overflow:hidden}.page-progress-bar-background{background-color:var(--text-color);opacity:.2;width:100%;height:100%}.page-progress-bar-scrubber{position:absolute;width:100%;background-color:var(--text-color);opacity:1;transition:height .2s ease,top .2s ease;margin-top:6px;margin-bottom:2px}.child-container{display:flex;overflow:hidden;flex-direction:column-reverse}@-webkit-keyframes closing{0%{width:var(--side-nav-open-width)}to{width:var(--side-nav-mini-width)}}@keyframes closing{0%{width:var(--side-nav-open-width)}to{width:var(--side-nav-mini-width)}}.outer-container.closed{-webkit-animation-name:closing;animation-name:closing;-webkit-animation-timing-function:cubic-bezier(0,0,.2,1);animation-timing-function:cubic-bezier(0,0,.2,1);transition-duration:195ms}@-webkit-keyframes opening{0%{width:var(--side-nav-mini-width)}to{width:var(--side-nav-open-width)}}@keyframes opening{0%{width:var(--side-nav-mini-width)}to{width:var(--side-nav-open-width)}}.outer-container:not(.closed){-webkit-animation-name:opening;animation-name:opening;-webkit-animation-timing-function:cubic-bezier(0,0,.2,1);animation-timing-function:cubic-bezier(0,0,.2,1);transition-duration:225ms}avl-icon{color:var(--avl-foreground-medium-color)}@media (max-width:960px){:host(.responsive){position:absolute;--side-nav-mini-width:0;transition:box-shadow .25s}:host(.responsive[slot=left-side]){left:0}:host(.responsive[slot=right-side]){right:0}:host(.responsive:not(.open)){box-shadow:none}:host(.responsive) .item-scroll{height:100%}:host(.responsive) .open-close-arrow{display:none}:host(.responsive) .arrow-spacer{display:none;visibility:hidden}:host(.responsive) .scrim{transition:all .25s;transition-duration:250px}:host(.responsive[slot=left-side]:not(.open)) .scrim{visibility:hidden;left:0}:host(.responsive.open) .scrim{background-color:var(--avl-scrim-color);position:fixed;visibility:visible;top:0;width:100%;height:100%}:host(.responsive[slot=left-side].open) .scrim{left:var(--side-nav-open-width)}:host(.responsive[slot=right-side].open) .scrim{right:var(--side-nav-open-width)}:host(.responsive[slot=right-side]:not(.open)) .scrim{visibility:hidden;right:0}}:host(.mobile){position:absolute;--side-nav-mini-width:0;transition:box-shadow .25s}:host(.mobile[slot=left-side]){left:0}:host(.mobile[slot=right-side]){right:0}:host(.mobile:not(.open)){box-shadow:none}:host(.mobile) .item-scroll{height:100%}:host(.mobile) .open-close-arrow{display:none}:host(.mobile) .arrow-spacer{display:none;visibility:hidden}:host(.mobile) .scrim{transition:all .25s;transition-duration:250px}:host(.mobile[slot=left-side]:not(.open)) .scrim{visibility:hidden;left:0}:host(.mobile.open) .scrim{background-color:var(--avl-scrim-color);position:fixed;visibility:visible;top:0;width:100%;height:100%}:host(.mobile[slot=left-side].open) .scrim{left:var(--side-nav-open-width)}:host(.mobile[slot=right-side].open) .scrim{right:var(--side-nav-open-width)}:host(.mobile[slot=right-side]:not(.open)) .scrim{visibility:hidden;right:0}"], directives: [{ type: i2.NgForOf, selector: "[ngFor][ngForOf]", inputs: ["ngForOf", "ngForTrackBy", "ngForTemplate"] }, { type: i2.NgIf, selector: "[ngIf]", inputs: ["ngIf", "ngIfThen", "ngIfElse"] }, { type: i1.RouterLinkWithHref, selector: "a[routerLink],area[routerLink]", inputs: ["routerLink", "target", "queryParams", "fragment", "queryParamsHandling", "preserveFragment", "skipLocationChange", "replaceUrl", "state", "relativeTo"] }, { type: i2.NgStyle, selector: "[ngStyle]", inputs: ["ngStyle"] }], animations: [
        trigger('expandCollapse', [
            transition(':enter', [
                style({ 'max-height': '0px' }),
                animate('225ms ease-in', style({ transform: 'translateY(0%)', 'max-height': '200px' }))
            ]),
            transition(':leave', [
                style({ 'max-height': '200px' }),
                animate('180ms ease-in', style({ 'max-height': '0px' }))
            ])
        ])
    ] });
i0.ɵɵngDeclareClassMetadata({ minVersion: "12.0.0", version: "12.0.3", ngImport: i0, type: AvlSideNavComponent, decorators: [{
            type: Component,
            args: [{
                    selector: 'avl-side-nav',
                    templateUrl: './avl-side-nav.component.html',
                    styleUrls: ['./avl-side-nav.component.css'],
                    animations: [
                        trigger('expandCollapse', [
                            transition(':enter', [
                                style({ 'max-height': '0px' }),
                                animate('225ms ease-in', style({ transform: 'translateY(0%)', 'max-height': '200px' }))
                            ]),
                            transition(':leave', [
                                style({ 'max-height': '200px' }),
                                animate('180ms ease-in', style({ 'max-height': '0px' }))
                            ])
                        ])
                    ]
                }]
        }], ctorParameters: function () { return [{ type: i1.Router }, { type: i1.ActivatedRoute }]; }, propDecorators: { open: [{
                type: Input
            }, {
                type: HostBinding,
                args: ['class.open']
            }], menuItems: [{
                type: Input
            }], responsive: [{
                type: Input
            }, {
                type: HostBinding,
                args: ['class.responsive']
            }], mobile: [{
                type: Input
            }, {
                type: HostBinding,
                args: ['class.mobile']
            }], shellUrl: [{
                type: Input
            }], openChange: [{
                type: Output
            }] } });
/**
 * @hidden
 */
function isGroup(item) {
    return item.subItems !== undefined && item.subItems.length > 0;
}
/**
 * @hidden
 */
function isTopLevelPage(item) {
    return (!isGroup(item) &&
        (item.icon !== undefined || item.iconUrl !== undefined));
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiYXZsLXNpZGUtbmF2LmNvbXBvbmVudC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uLy4uLy4uL3Byb2plY3RzL25hdmlnYXRpb24vc3JjL2xpYi9jb21wb25lbnRzL2F2bC1zaWRlLW5hdi9hdmwtc2lkZS1uYXYuY29tcG9uZW50LnRzIiwiLi4vLi4vLi4vLi4vLi4vLi4vcHJvamVjdHMvbmF2aWdhdGlvbi9zcmMvbGliL2NvbXBvbmVudHMvYXZsLXNpZGUtbmF2L2F2bC1zaWRlLW5hdi5jb21wb25lbnQuaHRtbCJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSxPQUFPLEVBQ0wsU0FBUyxFQUNULE1BQU0sRUFDTixZQUFZLEVBQ1osS0FBSyxFQUlMLFdBQVcsRUFDWixNQUFNLGVBQWUsQ0FBQztBQUN2QixPQUFPLEVBQUUsT0FBTyxFQUFFLEtBQUssRUFBRSxPQUFPLEVBQUUsVUFBVSxFQUFFLE1BQU0scUJBQXFCLENBQUM7QUFHMUUsT0FBTyxFQUFVLGFBQWEsRUFBb0MsTUFBTSxpQkFBaUIsQ0FBQztBQUMxRixPQUFPLEVBQUUsTUFBTSxFQUFFLE1BQU0sZ0JBQWdCLENBQUM7QUFFeEMsT0FBTywyQ0FBMkMsQ0FBQzs7OztBQUVuRCxNQUFNLFdBQVcsR0FBRyxFQUFFLENBQUM7QUFtQnZCLE1BQU0sT0FBTyxtQkFBbUI7SUEwRjlCLFlBQ1UsTUFBYyxFQUVmLFdBQTJCO1FBRjFCLFdBQU0sR0FBTixNQUFNLENBQVE7UUFFZixnQkFBVyxHQUFYLFdBQVcsQ0FBZ0I7UUExRTVCLGNBQVMsR0FBRyxLQUFLLENBQUM7UUFrQzFCOzs7V0FHRztRQUVJLGFBQVEsR0FBRyxFQUFFLENBQUM7UUFFckI7O1dBRUc7UUFFSSxlQUFVLEdBQTBCLElBQUksWUFBWSxFQUFFLENBQUM7UUErQjVELFdBQVcsQ0FBQyxXQUFXLENBQUMsU0FBUyxDQUFDLENBQUMsQ0FBQyxFQUFFO1lBQ3BDLElBQUksQ0FBQyxNQUFNLEdBQUcsQ0FBQyxDQUFD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cEIsUUFBUTtzQkFEZCxLQUFLO2dCQU9DLFVBQVU7c0JBRGhCLE1BQU07O0FBMk9UOztHQUVHO0FBQ0gsU0FBUyxPQUFPLENBQUMsSUFBa0I7SUFDakMsT0FBUSxJQUFjLENBQUMsUUFBUSxLQUFLLFNBQVMsSUFBSyxJQUFjLENBQUMsUUFBUSxDQUFDLE1BQU0sR0FBRyxDQUFDLENBQUM7QUFDdkYsQ0FBQztBQUVEOztHQUVHO0FBQ0gsU0FBUyxjQUFjLENBQUMsSUFBa0I7SUFDeEMsT0FBTyxDQUNMLENBQUMsT0FBTyxDQUFDLElBQUksQ0FBQztRQUNkLENBQUUsSUFBcUIsQ0FBQyxJQUFJLEtBQUssU0FBUyxJQUFLLElBQXFCLENBQUMsT0FBTyxLQUFLLFNBQVMsQ0FBQyxDQUM1RixDQUFDO0FBQ0osQ0FBQyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7XHJcbiAgQ29tcG9uZW50LFxyXG4gIE91dHB1dCxcclxuICBFdmVudEVtaXR0ZXIsXHJcbiAgSW5wdXQsXHJcbiAgT25EZXN0cm95LFxyXG4gIE9uQ2hhbmdlcyxcclxuICBTaW1wbGVDaGFuZ2VzLFxyXG4gIEhvc3RCaW5kaW5nXHJcbn0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XHJcbmltcG9ydCB7IHRyaWdnZXIsIHN0eWxlLCBhbmltYXRlLCB0cmFuc2l0aW9uIH0gZnJvbSAnQGFuZ3VsYXIvYW5pbWF0aW9ucyc7XHJcbmltcG9ydCB7IFRvcExldmVsUGFnZSwgR3JvdXAsIFBhZ2UsIFBhcmFtcyB9IGZyb20gJy4vbWVudS1pdGVtcyc7XHJcblxyXG5pbXBvcnQgeyBSb3V0ZXIsIEFjdGl2YXRpb25FbmQsIEFjdGl2YXRlZFJvdXRlLCBOYXZpZ2F0aW9uRXh0cmFzIH0gZnJvbSAnQGFuZ3VsYXIvcm91dGVyJztcclxuaW1wb3J0IHsgZmlsdGVyIH0gZnJvbSAncnhqcy9vcGVyYXRvcnMnO1xyXG5pbXBvcnQgeyBTdWJzY3JpcHRpb24gfSBmcm9tICdyeGpzJztcclxuaW1wb3J0ICdAYXZsLWNvbnRyb2xzL2NvcmUvZGlzdC9hdmwtaWNvbi9hdmwtaWNvbic7XHJcblxyXG5jb25zdCByb3dIZWlnaHRQeCA9IDQ4O1xyXG5cclxuQENvbXBvbmVudCh7XHJcbiAgc2VsZWN0b3I6ICdhdmwtc2lkZS1uYXYnLFxyXG4gIHRlbXBsYXRlVXJsOiAnLi9hdmwtc2lkZS1uYXYuY29tcG9uZW50Lmh0bWwnLFxyXG4gIHN0eWxlVXJsczogWycuL2F2bC1zaWRlLW5hdi5jb21wb25lbnQuY3NzJ10sXHJcbiAgYW5pbWF0aW9uczogW1xyXG4gICAgdHJpZ2dlcignZXhwYW5kQ29sbGFwc2UnLCBbXHJcbiAgICAgIHRyYW5zaXRpb24oJzplbnRlcicsIFtcclxuICAgICAgICBzdHlsZSh7ICdtYXgtaGVpZ2h0JzogJzBweCcgfSksXHJcbiAgICAgICAgYW5pbWF0ZSgnMjI1bXMgZWFzZS1pbicsIHN0eWxlKHsgdHJhbnNmb3JtOiAndHJhbnNsYXRlWSgwJSknLCAnbWF4LWhlaWdodCc6ICcyMDBweCcgfSkpXHJcbiAgICAgIF0pLFxyXG4gICAgICB0cmFuc2l0aW9uKCc6bGVhdmUnLCBbXHJcbiAgICAgICAgc3R5bGUoeyAnbWF4LWhlaWdodCc6ICcyMDBweCcgfSksXHJcbiAgICAgICAgYW5pbWF0ZSgnMTgwbXMgZWFzZS1pbicsIHN0eWxlKHsgJ21heC1oZWlnaHQnOiAnMHB4JyB9KSlcclxuICAgICAgXSlcclxuICAgIF0pXHJcbiAgXVxyXG59KVxyXG5leHBvcnQgY2xhc3MgQXZsU2lkZU5hdkNvbXBvbmVudCBpbXBsZW1lbnRzIE9uRGVzdHJveSwgT25DaGFuZ2VzIHtcclxuICAvKipcclxuICAgKlxyXG4gICAqICMjIyBTdHlsaW5nXHJcbiAgICogVGhlIGZvbGxvd2luZyBjdXN0b20gcHJvcGVydGllcyBhcmUgYXZhaWxhYmxlIGZvciBzdHlsaW5nOlxyXG4gICAqXHJcbiAgICogQ3VzdG9tIHByb3BlcnR5ICAgICAgICAgICAgICAgICAgICAgICAgICB8IERlc2NyaXB0aW9uICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHwgRGVmYXVsdFxyXG4gICAqIDotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tfDotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS18Oi0tLS0tLS0tLVxyXG4gICAqIGAtLWF2bC1hcHAtYmFyLWhlaWdodGAgICAgICAgICAgICAgICAgICAgfCBIZWlnaHQgb2YgdGhlIHRvb2xiYXIuIE5lZWRlZCBzbyB0aGF0IHRoZSBhdmwtc2lkZS1uYXYgY2FuIGJlIGNvcnJlY3RseSBwb3NpdGlvbmVkIGJlbG93IHRoZSB0b29sYmFyLiB8IGA1NnB4YFxyXG4gICAqIGAtLWF2bC1zaWRlLW5hdi1wcm9kdWN0LWNvbG9yYCAgICAgICAgICAgfCBVc2VkIGZvciBzZWxlY3RlZCBjb2xvciAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB8IGAtLWF2bC1wcm9kdWN0LXNlbGVjdGVkYFxyXG4gICAqIGAtLWF2bC1zaWRlLW5hdi1wcm9kdWN0LWNvbG9yLWhvdmVyYCAgICAgfCBVc2VkIGZvciBob3ZlciBjb2xvci4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB8IGAtLWF2bC1wcm9kdWN0LWhvdmVyYFxyXG4gICAqIGAtLWF2bC1zaWRlLW5hdi10ZXh0LWNvbG9yYCAgICAgICAgICAgICAgfCBDb2xvciBvZiB0aGUgdGV4dCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB8IGAtLWF2bC1mb3JlZ3JvdW5kLWNvbG9yYFxyXG4gICAqIGAtLWF2bC1zaWRlLW5hdi1pY29ucy1jb2xvcmAgICAgICAgICAgICAgfCBDb2xvciBvZiBpY29ucyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB8IGAtLWF2bC1mb3JlZ3JvdW5kLW1lZGl1bS1jb2xvcmBcclxuICAgKiBgLS1hdmwtc2lkZS1uYXYtYmFja2dyb3VuZC1jb2xvcmAgICAgICAgIHwgQmFja2dyb3VuZCBjb2xvciBvZiB0aGUgYXZsLXNpZGUtbmF2ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfCBgLS1hdmwtc2lkZW5hdi1jb2xvcmBcclxuICAgKiBgLS1hdmwtc2lkZS1uYXYtb3Blbi13aWR0aGAgICAgICAgICAgICAgIHwgV2lkdGggb2YgdGhlIGF2bC1zaWRlLW5hdiBpbiB0aGUgb3BlbiBzdGF0ZS4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfCBgMjU2cHhgXHJcbiAgICpcclxuICAgKi9cclxuICBfc3R5bGluZzogYW55O1xyXG5cclxuICBwcml2YXRlIG9wZW5WYWx1ZSA9IGZhbHNlO1xyXG5cclxuICAvKipcclxuICAgKiBDYW4gYmUgc2V0IHRvIG9wZW4gb3IgY2xvc2UgdGhlIHNpZGUgbmF2LlxyXG4gICAqIFJldHVybnMgdGhlIGN1cnJlbnQgc3RhdGUgb2YgdGhlIHNpZGUgbmF2LlxyXG4gICAqL1xyXG4gIEBJbnB1dCgpXHJcbiAgQEhvc3RCaW5kaW5nKCdjbGFzcy5vcGVuJylcclxuICBwdWJsaWMgZ2V0IG9wZW4oKTogYm9vbGVhbiB7XHJcbiAgICByZXR1cm4gdGhpcy5vcGVuVmFsdWU7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBJdGVtcyB0aGF0IGFyZSBzaG93biBpbiB0aGUgc2lkZSBuYXYuXHJcbiAgICovXHJcbiAgQElucHV0KClcclxuICBwdWJsaWMgbWVudUl0ZW1zOiBBcnJheTxUb3BMZXZlbFBhZ2UgfCBHcm91cD47XHJcblxyXG4gIC8qKlxyXG4gICAqIEJvb2xlYW4gdG8gdG9nZ2xlIHJlc3BvbnNpdmUgZmVhdHVyZXNcclxuICAgKiBPbiBtb2JpbGUgc2NyZWVucyBzaWRlbmF2IHRvZ2dsaW5nIGlzIHRyaWdnZXJlZCBieSBidXJnZXIgaWNvbiBpbiBhcHAtYmFyIGFzIHBhcnQgb2YgYXBwLWxheW91dFxyXG4gICAqL1xyXG4gIEBJbnB1dCgpXHJcbiAgQEhvc3RCaW5kaW5nKCdjbGFzcy5yZXNwb25zaXZlJylcclxuICBwdWJsaWMgcmVzcG9uc2l2ZTogYm9vbGVhbjtcclxuXHJcbiAgLyoqXHJcbiAgICogQm9vbGVhbiB0byBzZXQgb25seSBtb2JpbGUgZmVhdHVyZXMgb25cclxuICAgKiBPbiBtb2JpbGUgc2NyZWVucyBzaWRlbmF2IHRvZ2dsaW5nIGlzIHRyaWdnZXJlZCBieSBidXJnZXIgaWNvbiBpbiBhcHAtYmFyIGFzIHBhcnQgb2YgYXBwLWxheW91dFxyXG4gICAqL1xyXG4gIEBJbnB1dCgpXHJcbiAgQEhvc3RCaW5kaW5nKCdjbGFzcy5tb2JpbGUnKVxyXG4gIHB1YmxpYyBtb2JpbGU6IGJvb2xlYW47XHJcblxyXG4gIC8qKlxyXG4gICAqIFNwZWNpZmljIGZvciBzaGVsbCB1c2FnZS4gV2hlbiBzaWRlLW5hdiBpcyB1c2VkIGluIGFwcGxpY2F0aW9uIGluc2lkZSBhIHNoZWxsIChpZnJhbWUpXHJcbiAgICogdGhpcyBwYXJhbWV0ZXIgY29udGFpbmluZyBzaGVsbCB1cmwgZW5hYmxlcyBvcGVuaW5nIGNvcnJlY3QgdXJsIGluIG5ldyB0YWIvd2luZG93XHJcbiAgICovXHJcbiAgQElucHV0KClcclxuICBwdWJsaWMgc2hlbGxVcmwgPSAnJztcclxuXHJcbiAgLyoqXHJcbiAgICogRW1pdHRlZCB3aGVuIHRoZSBvcGVuIHByb3BlcnR5IGNoYW5nZXMuXHJcbiAgICovXHJcbiAgQE91dHB1dCgpXHJcbiAgcHVibGljIG9wZW5DaGFuZ2U6IEV2ZW50RW1pdHRlcjxib29sZWFuPiA9IG5ldyBFdmVudEVtaXR0ZXIoKTtcclxuXHJcbiAgcHVibGljIHNldCBvcGVuKHZhbDogYm9vbGVhbikge1xyXG4gICAgdGhpcy5vcGVuVmFsdWUgPSB2YWw7XHJcbiAgICB0aGlzLm9wZW5DaGFuZ2UubmV4dCh2YWwpO1xyXG4gIH1cclxuXHJcbiAgcHJpdmF0ZSBzdWJzY3JpcHRpb246IFN1YnNjcmlwdGlvbjtcclxuXHJcbiAgLyoqXHJcbiAgICogQGhpZGRlblxyXG4gICAqL1xyXG4gIHB1YmxpYyBzZWxlY3RlZEdyb3VwOiBHcm91cDtcclxuXHJcbiAgLyoqXHJcbiAgICogQGhpZGRlblxyXG4gICAqL1xyXG4gIHB1YmxpYyBzZWxlY3RlZFBhZ2U6IFBhZ2U7XHJcblxyXG4gIC8qKlxyXG4gICAqIEBoaWRkZW5cclxuICAgKi9cclxuICBwdWJsaWMgc2VsZWN0ZWRQYXJhZ3JhcGg6IHN0cmluZztcclxuICBwcml2YXRlIHNlbGVjdGVkUGFyYWdyYXBoSW5kZXg6IG51bWJlcjtcclxuICBwcml2YXRlIHBhcmFtczogYW55O1xyXG5cclxuICBjb25zdHJ1Y3RvcihcclxuICAgIHByaXZhdGUgcm91dGVyOiBSb3V0ZXIsXHJcblxyXG4gICAgcHVibGljIGFjdGl2ZVJvdXRlOiBBY3RpdmF0ZWRSb3V0ZVxyXG4gICkge1xyXG4gICAgYWN0aXZlUm91dGUucXVlcnlQYXJhbXMuc3Vic2NyaWJlKHAgPT4ge1xyXG4gICAgICB0aGlzLnBhcmFtcyA9IHA7XHJcbiAgICB9KTtcclxuICAgIHRoaXMuc3Vic2NyaXB0aW9uID0gdGhpcy5yb3V0ZXIuZXZlbnRzXHJcbiAgICAgIC5waXBlKGZpbHRlcihldmVudCA9PiBldmVudCBpbnN0YW5jZW9mIEFjdGl2YXRpb25FbmQpKVxyXG4gICAgICAuc3Vic2NyaWJlKChldmVudDogQWN0aXZhdGlvbkVuZCkgPT4ge1xyXG4gICAgICAgIHRoaXMuc2VsZWN0SXRlbXMoKTtcclxuICAgICAgfSk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBAaGlkZGVuXHJcbiAgICovXHJcbiAgcHVibGljIHRvZ2dsZU9wZW4oKSB7XHJcbiAgICBpZiAoIXRoaXMubWFudWFsbHlPcGVuZWQpIHtcclxuICAgICAgdGhpcy5vcGVuID0gIXRoaXMub3BlbjtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIHByaXZhdGUgbWFudWFsbHlPcGVuZWQ6IGJvb2xlYW47XHJcblxyXG4gIC8qKlxyXG4gICAqIEBoaWRkZW5cclxuICAgKi9cclxuICBwdWJsaWMgYXJyb3dUb2dnbGVPcGVuKCkge1xyXG4gICAgdGhpcy5tYW51YWxseU9wZW5lZCA9ICF0aGlzLm9wZW47XHJcbiAgICB0aGlzLm9wZW4gPSAhdGhpcy5vcGVuO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogQGhpZGRlblxyXG4gICAqL1xyXG4gIHB1YmxpYyBtb2JpbGVDbG9zZSgpIHtcclxuICAgIGlmIChNYXRoLm1heChkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuY2xpZW50V2lkdGgsIHdpbmRvdy5pbm5lcldpZHRoKSA8IDk2MCkge1xyXG4gICAgICB0aGlzLm9wZW4gPSBmYWxzZTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIHB1YmxpYyBuYXZpZ2F0ZUxvY2FsKGV2ZW50OiBNb3VzZUV2ZW50LCByb3V0ZTogc3RyaW5nLCBwYXJhbXM/OiBQYXJhbXNbXSwgZnJhZ21lbnQ/OiBzdHJpbmcpIHtcclxuICAgIGlmICghZXZlbnQuY3RybEtleSkge1xyXG4gICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICBsZXQgbmF2aWdhdGlvbkV4dHJhczogTmF2aWdhdGlvbkV4dHJhcyA9IHtcclxuICAgICAgICBxdWVyeVBhcmFtczogdGhpcy5nZXRQYXJhbXMocGFyYW1zKSxcclxuICAgICAgICBmcmFnbWVudDogZnJhZ21lbnRcclxuICAgICAgfTtcclxuICAgICAgdGhpcy5yb3V0ZXIubmF2aWdhdGUoW3JvdXRlXSwgbmF2aWdhdGlvbkV4dHJhcyk7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBAaGlkZGVuXHJcbiAgICovXHJcbiAgcHVibGljIGdyb3VwQ2xpY2tlZChpdGVtKSB7XHJcbiAgICBpZiAoIXRoaXMub3Blbikge1xyXG4gICAgICB0aGlzLm9wZW4gPSB0cnVlO1xyXG4gICAgICBpZiAoIWl0ZW0uZXhwYW5kZWQpIHtcclxuICAgICAgICBpdGVtLmV4cGFuZGVkID0gdHJ1ZTtcclxuICAgICAgfVxyXG4gICAgfSBlbHNlIHtcclxuICAgICAgaXRlbS5leHBhbmRlZCA9ICFpdGVtLmV4cGFuZGVkO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogQGhpZGRlblxyXG4gICAqL1xyXG4gIHB1YmxpYyBnZXRTY3J1YmJlclN0eWxlKCkge1xyXG4gICAgcmV0dXJuIHtcclxuICAgICAgaGVpZ2h0OiB0aGlzLnNlbGVjdGVkUGFyYWdyYXBoID8gJzE0cHgnIDogJzBweCcsXHJcbiAgICAgIHRvcDogYCR7dGhpcy5zZWxlY3RlZFBhcmFncmFwaEluZGV4ICogcm93SGVpZ2h0UHh9cHhgXHJcbiAgICB9O1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogQGhpZGRlblxyXG4gICAqL1xyXG4gIHB1YmxpYyB0cmltU2xhc2goc3RyOiBzdHJpbmcpIHtcclxuICAgIGlmIChzdHJbMF0gPT09ICcvJykge1xyXG4gICAgICBzdHIgPSBzdHIuc3Vic3RyaW5nKDEsIHN0ci5sZW5ndGgpO1xyXG4gICAgfVxyXG4gICAgaWYgKHN0cltzdHIubGVuZ3RoIC0gMV0gPT09ICcvJykge1xyXG4gICAgICBzdHIgPSBzdHIuc3Vic3RyaW5nKDAsIHN0ci5sZW5ndGggLSAxKTtcclxuICAgIH1cclxuICAgIHJldHVybiBzdHI7XHJcbiAgfVxyXG5cclxuICBwcml2YXRlIHNlbGVjdEl0ZW1zKCkge1xyXG4gICAgaWYgKCF0aGlzLm1lbnVJdGVtcykge1xyXG4gICAgICByZXR1cm47XHJcbiAgICB9XHJcbiAgICBjb25zdCBmcmFnbWVudCA9IHRoaXMucm91dGVyLnBhcnNlVXJsKHRoaXMucm91dGVyLnVybCkuZnJhZ21lbnQ7XHJcbiAgICBjb25zdCB1cmwgPSB0aGlzLnJvdXRlci51cmwuc3BsaXQoJyMnKVswXTtcclxuICAgIGNvbnN0IHF1ZXVlOiBBcnJheTxQYWdlIHwgR3JvdXA+ID0gdGhpcy5tZW51SXRlbXMuc2xpY2UoKTtcclxuICAgIHF1ZXVlLnNvcnQoKHBhZ2VPbmUsIHBhZ2VUd28pID0+IChwYWdlT25lLnJvdXRlIDwgcGFnZVR3by5yb3V0ZSA/IC0xIDogMSkpO1xyXG4gICAgbGV0IGN1cnJlbnRHcm91cDogR3JvdXA7XHJcbiAgICB0aGlzLnNlbGVjdGVkR3JvdXAgPSB1bmRlZmluZWQ7XHJcbiAgICB0aGlzLnNlbGVjdGVkUGFnZSA9IHVuZGVmaW5lZDtcclxuICAgIHRoaXMuc2VsZWN0ZWRQYXJhZ3JhcGggPSB1bmRlZmluZWQ7XHJcbiAgICBsZXQgZmFsbGJhY2tTZWxlY3RlZFBhZ2U6IGFueTtcclxuICAgIHdoaWxlIChxdWV1ZS5sZW5ndGgpIHtcclxuICAgICAgY29uc3QgaXRlbSA9IHF1ZXVlLnBvcCgpO1xyXG4gICAgICBpZiAoaXNHcm91cChpdGVtKSkge1xyXG4gICAgICAgIGN1cnJlbnRHcm91cCA9IGl0ZW07XHJcbiAgICAgICAgaXRlbS5zdWJJdGVtcy5mb3JFYWNoKHN1Yml0ZW0gPT4ge1xyXG4gICAgICAgICAgcXVldWUucHVzaChzdWJpdGVtKTtcclxuICAgICAgICB9KTtcclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICBpZiAoXHJcbiAgICAgICAgICBmYWxsYmFja1NlbGVjdGVkUGFnZSA9PSBudWxsICYmXHJcbiAgICAgICAgICB0aGlzLnRyaW1TbGFzaCh1cmwpLnN0YXJ0c1dpdGgodGhpcy50cmltU2xhc2goaXRlbS5yb3V0ZSkpXHJcbiAgICAgICAgKSB7XHJcbiAgICAgICAgICBmYWxsYmFja1NlbGVjdGVkUGFnZSA9IGl0ZW07XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmIChcclxuICAgICAgICAgIGl0ZW0ucm91dGUgJiZcclxuICAgICAgICAgIHRoaXMudHJpbVNsYXNoKHVybCkuZW5kc1dpdGgodGhpcy50cmltU2xhc2goaXRlbS5yb3V0ZSArIHRoaXMuZ2V0VXJsUGFyYW1zKGl0ZW0ucGFyYW1zKSkpXHJcbiAgICAgICAgKSB7XHJcbiAgICAgICAgICBpZiAoXHJcbiAgICAgICAgICAgIHRoaXMuc2VsZWN0ZWRQYWdlICYmXHJcbiAgICAgICAgICAgIHRoaXMuc2VsZWN0ZWRQYWdlLnJvdXRlICYmXHJcbiAgICAgICAgICAgIHRoaXMuc2VsZWN0ZWRQYWdlLnJvdXRlLmxlbmd0aCA+IGl0ZW0ucm91dGUubGVuZ3RoXHJcbiAgICAgICAgICApIHtcclxuICAgICAgICAgICAgY29udGludWU7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgICBpZiAoaXRlbS5wYXJhbXMgJiYgaXRlbS5wYXJhbXMubGVuZ3RoID4gMCkge1xyXG4gICAgICAgICAgICBjb25zdCBvYmplY3QgPSBuZXcgT2JqZWN0KCk7XHJcbiAgICAgICAgICAgIGl0ZW0ucGFyYW1zLmZvckVhY2goaSA9PiB7XHJcbiAgICAgICAgICAgICAgb2JqZWN0W2kubmFtZV0gPSBpLnZhbHVlO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgaWYgKEpTT04uc3RyaW5naWZ5KHRoaXMucGFyYW1zKSA9PT0gSlNPTi5zdHJpbmdpZnkob2JqZWN0KSkge1xyXG4gICAgICAgICAgICAgIHRoaXMuc2VsZWN0ZWRQYWdlID0gaXRlbTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgdGhpcy5zZWxlY3RlZFBhZ2UgPSBpdGVtO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgICAgaWYgKGlzVG9wTGV2ZWxQYWdlKGl0ZW0pKSB7XHJcbiAgICAgICAgICAgIHRoaXMuc2VsZWN0ZWRHcm91cCA9IHVuZGVmaW5lZDtcclxuICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIHRoaXMuc2VsZWN0ZWRHcm91cCA9IGN1cnJlbnRHcm91cDtcclxuICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICBpZiAoaXRlbS5wYXJhZ3JhcGhzICYmIGl0ZW0ucGFyYWdyYXBocy5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IHBhcmFncmFwaEluZGV4ID0gaXRlbS5wYXJhZ3JhcGhzLmZpbmRJbmRleChwID0+IHAuaWQgPT09IGZyYWdtZW50KTtcclxuICAgICAgICAgICAgaWYgKGZyYWdtZW50ICYmIGl0ZW0ucGFyYWdyYXBocyAmJiBwYXJhZ3JhcGhJbmRleCAhPT0gLTEpIHtcclxuICAgICAgICAgICAgICB0aGlzLnNlbGVjdGVkUGFyYWdyYXBoID0gZnJhZ21lbnQ7XHJcbiAgICAgICAgICAgICAgdGhpcy5zZWxlY3RlZFBhcmFncmFwaEluZGV4ID0gcGFyYWdyYXBoSW5kZXg7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgIH1cclxuICAgIGlmICh0aGlzLnNlbGVjdGVkUGFnZSA9PSBudWxsKSB7XHJcbiAgICAgIHRoaXMuc2VsZWN0ZWRQYWdlID0gZmFsbGJhY2tTZWxlY3RlZFBhZ2U7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBAaGlkZGVuXHJcbiAgICovXHJcbiAgbmdPbkNoYW5nZXMoY2hhbmdlczogU2ltcGxlQ2hhbmdlcykge1xyXG4gICAgaWYgKGNoYW5nZXNbJ21lbnVJdGVtcyddKSB7XHJcbiAgICAgIHRoaXMuc2VsZWN0SXRlbXMoKTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIEBoaWRkZW5cclxuICAgKi9cclxuICBuZ09uRGVzdHJveSgpIHtcclxuICAgIHRoaXMuc3Vic2NyaXB0aW9uLnVuc3Vic2NyaWJlKCk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBAaGlkZGVuXHJcbiAgICovXHJcbiAgZ2V0UGFyYW1zKHBhcmFtczogUGFyYW1zW10pIHtcclxuICAgIGlmIChwYXJhbXMgJiYgcGFyYW1zLmxlbmd0aCA+IDApIHtcclxuICAgICAgY29uc3Qgb2JqZWN0ID0ge307XHJcbiAgICAgIHBhcmFtcy5mb3JFYWNoKHBhcmFtID0+IHtcclxuICAgICAgICBvYmplY3RbcGFyYW0ubmFtZV0gPSBwYXJhbS52YWx1ZTtcclxuICAgICAgfSk7XHJcbiAgICAgIHJldHVybiBvYmplY3Q7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICByZXR1cm4ge307XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBAaGlkZGVuXHJcbiAgICovXHJcbiAgZ2V0VXJsUGFyYW1zKHBhcmFtczogUGFyYW1zW10pOiBzdHJpbmcge1xyXG4gICAgaWYgKHBhcmFtcyAmJiBwYXJhbXMubGVuZ3RoID4gMCkge1xyXG4gICAgICBsZXQgdXJsID0gJz8nO1xyXG4gICAgICBwYXJhbXMuZm9yRWFjaChwYXJhbSA9PiB7XHJcbiAgICAgICAgdXJsICs9IHBhcmFtLm5hbWUgKyAnPScgKyBwYXJhbS52YWx1ZSArICcmJztcclxuICAgICAgfSk7XHJcbiAgICAgIHJldHVybiB1cmwuc2xpY2UoMCwgLTEpO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgcmV0dXJuICcnO1xyXG4gICAgfVxyXG4gIH1cclxufVxyXG5cclxuLyoqXHJcbiAqIEBoaWRkZW5cclxuICovXHJcbmZ1bmN0aW9uIGlzR3JvdXAoaXRlbTogUGFnZSB8IEdyb3VwKTogaXRlbSBpcyBHcm91cCB7XHJcbiAgcmV0dXJuIChpdGVtIGFzIEdyb3VwKS5zdWJJdGVtcyAhPT0gdW5kZWZpbmVkICYmIChpdGVtIGFzIEdyb3VwKS5zdWJJdGVtcy5sZW5ndGggPiAwO1xyXG59XHJcblxyXG4vKipcclxuICogQGhpZGRlblxyXG4gKi9cclxuZnVuY3Rpb24gaXNUb3BMZXZlbFBhZ2UoaXRlbTogUGFnZSB8IEdyb3VwKTogaXRlbSBpcyBUb3BMZXZlbFBhZ2Uge1xyXG4gIHJldHVybiAoXHJcbiAgICAhaXNHcm91cChpdGVtKSAmJlxyXG4gICAgKChpdGVtIGFzIFRvcExldmVsUGFnZSkuaWNvbiAhPT0gdW5kZWZpbmVkIHx8IChpdGVtIGFzIFRvcExldmVsUGFnZSkuaWNvblVybCAhPT0gdW5kZWZpbmVkKVxyXG4gICk7XHJcbn1cclxuIiwiPGRpdiAjb3V0ZXJDb250YWluZXIgW2NsYXNzLmNsb3NlZF09XCIhb3BlblwiIGNsYXNzPVwib3V0ZXItY29udGFpbmVyIHRvb2xiYXItc3BhY2luZ1wiPlxyXG4gIDxkaXYgY2xhc3M9XCJpdGVtLXNjcm9sbFwiPlxyXG4gICAgPGRpdiAjaW5uZXJDb250YWluZXIgY2xhc3M9XCJpbm5lci1jb250YWluZXJcIj5cclxuICAgICAgPG5nLXRlbXBsYXRlIG5nRm9yIGxldC1pdGVtIFtuZ0Zvck9mXT1cIm1lbnVJdGVtc1wiPlxyXG4gICAgICAgIDwhLS0gVG9wIGxldmVsIHBhZ2UgLS0+XHJcbiAgICAgICAgPGFcclxuICAgICAgICAgICpuZ0lmPVwiIWl0ZW0uc3ViSXRlbXMgJiYgIXNoZWxsVXJsXCJcclxuICAgICAgICAgIHRhYmluZGV4PVwiMFwiXHJcbiAgICAgICAgICBjbGFzcz1cIml0ZW0gdG9wLWxldmVsLXBhZ2VcIlxyXG4gICAgICAgICAgcm91dGVyTGluaz1cInt7IGl0ZW0ucm91dGUgfX1cIlxyXG4gICAgICAgICAgW3F1ZXJ5UGFyYW1zXT1cImdldFBhcmFtcyhpdGVtLnBhcmFtcylcIlxyXG4gICAgICAgICAgW2NsYXNzLnNlbGVjdGVkXT1cIml0ZW0gPT09IHNlbGVjdGVkUGFnZVwiXHJcbiAgICAgICAgICAoY2xpY2spPVwibW9iaWxlQ2xvc2UoKVwiXHJcbiAgICAgICAgPlxyXG4gICAgICAgICAgPGRpdiBjbGFzcz1cImltYWdlLWRpdlwiPlxyXG4gICAgICAgICAgICA8YXZsLWljb24gKm5nSWY9XCJpdGVtLmljb25cIiBhdHRyLmljb249XCJ7eyBpdGVtLmljb24gfX1cIj48L2F2bC1pY29uPlxyXG4gICAgICAgICAgICA8aW1nIGFsdD1cIltbaXRlbS5uYW1lXV1cIiAqbmdJZj1cIml0ZW0uaWNvblVybFwiIFtzcmNdPVwiaXRlbS5pY29uVXJsXCIgLz5cclxuICAgICAgICAgIDwvZGl2PlxyXG4gICAgICAgICAgPGRpdiBjbGFzcz1cImxhYmVsLWRpdlwiPnt7IGl0ZW0ubGFiZWwgfX08L2Rpdj5cclxuICAgICAgICAgIDxkaXYgY2xhc3M9XCJpdGVtLW92ZXJsYXlcIj48L2Rpdj5cclxuICAgICAgICA8L2E+XHJcbiAgICAgICAgPGFcclxuICAgICAgICAgICpuZ0lmPVwiIWl0ZW0uc3ViSXRlbXMgJiYgc2hlbGxVcmxcIlxyXG4gICAgICAgICAgdGFiaW5kZXg9XCIwXCJcclxuICAgICAgICAgIGNsYXNzPVwiaXRlbSB0b3AtbGV2ZWwtcGFnZVwiXHJcbiAgICAgICAgICBocmVmPVwie3sgc2hlbGxVcmwgKyAnLycgKyB0cmltU2xhc2goaXRlbS5yb3V0ZSArIGdldFVybFBhcmFtcyhpdGVtLnBhcmFtcykpIH19XCJcclxuICAgICAgICAgIFtjbGFzcy5zZWxlY3RlZF09XCJpdGVtID09PSBzZWxlY3RlZFBhZ2VcIlxyXG4gICAgICAgICAgKGNsaWNrKT1cIm1vYmlsZUNsb3NlKCk7IG5hdmlnYXRlTG9jYWwoJGV2ZW50LCBpdGVtLnJvdXRlLCBpdGVtLnBhcmFtcylcIlxyXG4gICAgICAgID5cclxuICAgICAgICAgIDxkaXYgY2xhc3M9XCJpbWFnZS1kaXZcIj5cclxuICAgICAgICAgICAgPGF2bC1pY29uICpuZ0lmPVwiaXRlbS5pY29uXCIgYXR0ci5pY29uPVwie3sgaXRlbS5pY29uIH19XCI+PC9hdmwtaWNvbj5cclxuICAgICAgICAgICAgPGltZyBhbHQ9XCJbW2l0ZW0ubmFtZV1dXCIgKm5nSWY9XCJpdGVtLmljb25VcmxcIiBbc3JjXT1cIml0ZW0uaWNvblVybFwiIC8+XHJcbiAgICAgICAgICA8L2Rpdj5cclxuICAgICAgICAgIDxkaXYgY2xhc3M9XCJsYWJlbC1kaXZcIj57eyBpdGVtLmxhYmVsIH19PC9kaXY+XHJcbiAgICAgICAgICA8ZGl2IGNsYXNzPVwiaXRlbS1vdmVybGF5XCI+PC9kaXY+XHJcbiAgICAgICAgPC9hPlxyXG4gICAgICAgIDwhLS0gUGFyYWdyYXBocyBvZiBhIHRvcCBsZXZlbCBwYWdlIC0tPlxyXG4gICAgICAgIDxkaXZcclxuICAgICAgICAgIGNsYXNzPVwiY2hpbGQtY29udGFpbmVyXCJcclxuICAgICAgICAgICpuZ0lmPVwib3BlbiAmJiBpdGVtLnBhcmFncmFwaHMgJiYgaXRlbS5wYXJhZ3JhcGhzLmxlbmd0aCA+IDAgJiYgaXRlbSA9PT0gc2VsZWN0ZWRQYWdlXCJcclxuICAgICAgICAgIFtAZXhwYW5kQ29sbGFwc2VdXHJcbiAgICAgICAgPlxyXG4gICAgICAgICAgPCEtLSBkaXYgZm9yIHByZXZlbnRpbmcgcmV2ZXJzaW5nIG9mIHRoZSBpdGVtcyBieSBmbGV4LWRpcmVjdGlvbjogY29sdW1uLXJldmVyc2UgLS0+XHJcbiAgICAgICAgICA8ZGl2ICpuZ0lmPVwiIXNoZWxsVXJsXCI+XHJcbiAgICAgICAgICAgIDxhXHJcbiAgICAgICAgICAgICAgKm5nRm9yPVwibGV0IHBhcmFncmFwaCBvZiBpdGVtLnBhcmFncmFwaHNcIlxyXG4gICAgICAgICAgICAgIGNsYXNzPVwiaXRlbSB0b3AtbGV2ZWwtcGFyYWdyYXBoXCJcclxuICAgICAgICAgICAgICByb3V0ZXJMaW5rPVwie3sgaXRlbS5yb3V0ZSB9fVwiXHJcbiAgICAgICAgICAgICAgW3F1ZXJ5UGFyYW1zXT1cImdldFBhcmFtcyhpdGVtLnBhcmFtcylcIlxyXG4gICAgICAgICAgICAgIGZyYWdtZW50PVwie3sgcGFyYWdyYXBoLmlkIH19XCJcclxuICAgICAgICAgICAgICBbY2xhc3Muc2VsZWN0ZWRdPVwicGFyYWdyYXBoLmlkID09PSBzZWxlY3RlZFBhcmFncmFwaFwiXHJcbiAgICAgICAgICAgICAgKGNsaWNrKT1cIm1vYmlsZUNsb3NlKClcIlxyXG4gICAgICAgICAgICA+XHJcbiAgICAgICAgICAgICAgPGRpdiBjbGFzcz1cImxhYmVsLWRpdlwiPnt7IHBhcmFncmFwaC5sYWJlbCB9fTwvZGl2PlxyXG4gICAgICAgICAgICA8L2E+XHJcbiAgICAgICAgICA8L2Rpdj5cclxuICAgICAgICAgIDxkaXYgKm5nSWY9XCJzaGVsbFVybFwiPlxyXG4gICAgICAgICAgICA8YVxyXG4gICAgICAgICAgICAgICpuZ0Zvcj1cImxldCBwYXJhZ3JhcGggb2YgaXRlbS5wYXJhZ3JhcGhzXCJcclxuICAgICAgICAgICAgICBjbGFzcz1cIml0ZW0gdG9wLWxldmVsLXBhcmFncmFwaFwiXHJcbiAgICAgICAgICAgICAgaHJlZj1cInt7XHJcbiAgICAgICAgICAgICAgICBzaGVsbFVybCArXHJcbiAgICAgICAgICAgICAgICAgICcvJyArXHJcbiAgICAgICAgICAgICAgICAgIHRyaW1TbGFzaChpdGVtLnJvdXRlICsgZ2V0VXJsUGFyYW1zKGl0ZW0ucGFyYW1zKSkgK1xyXG4gICAgICAgICAgICAgICAgICAnIycgK1xyXG4gICAgICAgICAgICAgICAgICBwYXJhZ3JhcGguaWRcclxuICAgICAgICAgICAgICB9fVwiXHJcbiAgICAgICAgICAgICAgW2NsYXNzLnNlbGVjdGVkXT1cInBhcmFncmFwaC5pZCA9PT0gc2VsZWN0ZWRQYXJhZ3JhcGhcIlxyXG4gICAgICAgICAgICAgIChjbGljayk9XCJtb2JpbGVDbG9zZSgpOyBuYXZpZ2F0ZUxvY2FsKCRldmVudCwgaXRlbS5yb3V0ZSwgaXRlbS5wYXJhbXMsIHBhcmFncmFwaC5pZClcIlxyXG4gICAgICAgICAgICA+XHJcbiAgICAgICAgICAgICAgPGRpdiBjbGFzcz1cImxhYmVsLWRpdlwiPnt7IHBhcmFncmFwaC5sYWJlbCB9fTwvZGl2PlxyXG4gICAgICAgICAgICA8L2E+XHJcbiAgICAgICAgICA8L2Rpdj5cclxuICAgICAgICAgIDxkaXYgY2xhc3M9XCJwYWdlLXByb2dyZXNzLWJhclwiPlxyXG4gICAgICAgICAgICA8ZGl2IGNsYXNzPVwicGFnZS1wcm9ncmVzcy1iYXItYmFja2dyb3VuZFwiPjwvZGl2PlxyXG4gICAgICAgICAgICA8ZGl2IGNsYXNzPVwicGFnZS1wcm9ncmVzcy1iYXItc2NydWJiZXJcIiBbbmdTdHlsZV09XCJnZXRTY3J1YmJlclN0eWxlKClcIj48L2Rpdj5cclxuICAgICAgICAgIDwvZGl2PlxyXG4gICAgICAgIDwvZGl2PlxyXG4gICAgICAgIDwhLS0gR3JvdXAgLS0+XHJcbiAgICAgICAgPGRpdlxyXG4gICAgICAgICAgKm5nSWY9XCJpdGVtLnN1Ykl0ZW1zXCJcclxuICAgICAgICAgIHRhYmluZGV4PVwiMFwiXHJcbiAgICAgICAgICBjbGFzcz1cIml0ZW0gZ3JvdXBcIlxyXG4gICAgICAgICAgW2NsYXNzLmV4cGFuZGVkXT1cIml0ZW0uZXhwYW5kZWRcIlxyXG4gICAgICAgICAgKGNsaWNrKT1cImdyb3VwQ2xpY2tlZChpdGVtKVwiXHJcbiAgICAgICAgICBbY2xhc3Muc2VsZWN0ZWRdPVwiaXRlbSA9PT0gc2VsZWN0ZWRHcm91cFwiXHJcbiAgICAgICAgPlxyXG4gICAgICAgICAgPGRpdiBjbGFzcz1cImltYWdlLWRpdlwiPlxyXG4gICAgICAgICAgICA8YXZsLWljb24gKm5nSWY9XCJpdGVtLmljb25cIiBhdHRyLmljb249XCJ7eyBpdGVtLmljb24gfX1cIj48L2F2bC1pY29uPlxyXG4gICAgICAgICAgICA8aW1nIGFsdD1cIltbaXRlbS5uYW1lXV1cIiAqbmdJZj1cIml0ZW0uaWNvblVybFwiIFtzcmNdPVwiaXRlbS5pY29uVXJsXCIgLz5cclxuICAgICAgICAgIDwvZGl2PlxyXG4gICAgICAgICAgPGRpdiBjbGFzcz1cImxhYmVsLWRpdiBncm91cFwiPnt7IGl0ZW0ubGFiZWwgfX08L2Rpdj5cclxuICAgICAgICAgIDxhdmwtaWNvbiBjbGFzcz1cImdyb3VwLWFycm93XCIgaWNvbj1cImFycm93LWRyb3AtZG93blwiPjwvYXZsLWljb24+XHJcbiAgICAgICAgICA8ZGl2IGNsYXNzPVwiaXRlbS1vdmVybGF5XCI+PC9kaXY+XHJcbiAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgPCEtLSBTdWJwYWdlcyAtLT5cclxuICAgICAgICA8ZGl2XHJcbiAgICAgICAgICBjbGFzcz1cImNoaWxkLWNvbnRhaW5lclwiXHJcbiAgICAgICAgICAqbmdJZj1cIm9wZW4gJiYgaXRlbS5zdWJJdGVtcyAmJiBpdGVtLnN1Ykl0ZW1zLmxlbmd0aCA+IDAgJiYgaXRlbS5leHBhbmRlZFwiXHJcbiAgICAgICAgICBbQGV4cGFuZENvbGxhcHNlXVxyXG4gICAgICAgICAgKGNsaWNrKT1cInRvZ2dsZU9wZW4oKVwiXHJcbiAgICAgICAgPlxyXG4gICAgICAgICAgPCEtLSBkaXYgZm9yIHByZXZlbnRpbmcgcmV2ZXJzaW5nIG9mIHRoZSBpdGVtcyBieSBmbGV4LWRpcmVjdGlvbjogY29sdW1uLXJldmVyc2UgLS0+XHJcbiAgICAgICAgICA8ZGl2PlxyXG4gICAgICAgICAgICA8bmctdGVtcGxhdGUgbmdGb3IgbGV0LXN1Ykl0ZW0gW25nRm9yT2ZdPVwiaXRlbS5zdWJJdGVtc1wiPlxyXG4gICAgICAgICAgICAgIDxhXHJcbiAgICAgICAgICAgICAgICAqbmdJZj1cIiFzaGVsbFVybFwiXHJcbiAgICAgICAgICAgICAgICBjbGFzcz1cIml0ZW0gc3VicGFnZVwiXHJcbiAgICAgICAgICAgICAgICByb3V0ZXJMaW5rPVwie3sgc3ViSXRlbS5yb3V0ZSB9fVwiXHJcbiAgICAgICAgICAgICAgICBbcXVlcnlQYXJhbXNdPVwiZ2V0UGFyYW1zKHN1Ykl0ZW0ucGFyYW1zKVwiXHJcbiAgICAgICAgICAgICAgICBbY2xhc3Muc2VsZWN0ZWRdPVwic3ViSXRlbSA9PT0gc2VsZWN0ZWRQYWdlXCJcclxuICAgICAgICAgICAgICAgIChjbGljayk9XCJtb2JpbGVDbG9zZSgpXCJcclxuICAgICAgICAgICAgICA+XHJcbiAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPVwibGFiZWwtZGl2XCI+e3sgc3ViSXRlbS5sYWJlbCB9fTwvZGl2PlxyXG4gICAgICAgICAgICAgICAgPGRpdiBjbGFzcz1cIml0ZW0tb3ZlcmxheVwiPjwvZGl2PlxyXG4gICAgICAgICAgICAgIDwvYT5cclxuICAgICAgICAgICAgICA8YVxyXG4gICAgICAgICAgICAgICAgKm5nSWY9XCJzaGVsbFVybFwiXHJcbiAgICAgICAgICAgICAgICBjbGFzcz1cIml0ZW0gc3VicGFnZVwiXHJcbiAgICAgICAgICAgICAgICBocmVmPVwie3tcclxuICAgICAgICAgICAgICAgICAgc2hlbGxVcmwgKyAnLycgKyB0cmltU2xhc2goc3ViSXRlbS5yb3V0ZSArIGdldFVybFBhcmFtcyhzdWJJdGVtLnBhcmFtcykpXHJcbiAgICAgICAgICAgICAgICB9fVwiXHJcbiAgICAgICAgICAgICAgICBbY2xhc3Muc2VsZWN0ZWRdPVwic3ViSXRlbSA9PT0gc2VsZWN0ZWRQYWdlXCJcclxuICAgICAgICAgICAgICAgIChjbGljayk9XCJtb2JpbGVDbG9zZSgpOyBuYXZpZ2F0ZUxvY2FsKCRldmVudCwgaXRlbS5yb3V0ZSwgaXRlbS5wYXJhbXMpXCJcclxuICAgICAgICAgICAgICA+XHJcbiAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPVwibGFiZWwtZGl2XCI+e3sgc3ViSXRlbS5sYWJlbCB9fTwvZGl2PlxyXG4gICAgICAgICAgICAgICAgPGRpdiBjbGFzcz1cIml0ZW0tb3ZlcmxheVwiPjwvZGl2PlxyXG4gICAgICAgICAgICAgIDwvYT5cclxuICAgICAgICAgICAgICA8IS0tIFBhcmFncmFwaHMgb2YgYSBzdWJwYWdlIC0tPlxyXG4gICAgICAgICAgICAgIDxkaXZcclxuICAgICAgICAgICAgICAgIGNsYXNzPVwiY2hpbGQtY29udGFpbmVyXCJcclxuICAgICAgICAgICAgICAgICpuZ0lmPVwiXHJcbiAgICAgICAgICAgICAgICAgIHN1Ykl0ZW0ucGFyYWdyYXBocyAmJiBzdWJJdGVtLnBhcmFncmFwaHMubGVuZ3RoID4gMCAmJiBzdWJJdGVtID09PSBzZWxlY3RlZFBhZ2VcclxuICAgICAgICAgICAgICAgIFwiXHJcbiAgICAgICAgICAgICAgICBbQGV4cGFuZENvbGxhcHNlXVxyXG4gICAgICAgICAgICAgID5cclxuICAgICAgICAgICAgICAgIDwhLS0gZGl2IGZvciBwcmV2ZW50aW5nIHJldmVyc2luZyBvZiB0aGUgaXRlbXMgYnkgZmxleC1kaXJlY3Rpb246IGNvbHVtbi1yZXZlcnNlIC0tPlxyXG4gICAgICAgICAgICAgICAgPGRpdiAqbmdJZj1cIiFzaGVsbFVybFwiPlxyXG4gICAgICAgICAgICAgICAgICA8YVxyXG4gICAgICAgICAgICAgICAgICAgICpuZ0Zvcj1cImxldCBwYXJhZ3JhcGggb2Ygc3ViSXRlbS5wYXJhZ3JhcGhzXCJcclxuICAgICAgICAgICAgICAgICAgICBjbGFzcz1cIml0ZW0gc3VicGFnZS1wYXJhZ3JhcGhcIlxyXG4gICAgICAgICAgICAgICAgICAgIHJvdXRlckxpbms9XCJ7eyBzdWJJdGVtLnJvdXRlIH19XCJcclxuICAgICAgICAgICAgICAgICAgICBbcXVlcnlQYXJhbXNdPVwiZ2V0UGFyYW1zKHN1Ykl0ZW0ucGFyYW1zKVwiXHJcbiAgICAgICAgICAgICAgICAgICAgZnJhZ21lbnQ9XCJ7eyBwYXJhZ3JhcGguaWQgfX1cIlxyXG4gICAgICAgICAgICAgICAgICAgIFtjbGFzcy5zZWxlY3RlZF09XCJwYXJhZ3JhcGguaWQgPT09IHNlbGVjdGVkUGFyYWdyYXBoXCJcclxuICAgICAgICAgICAgICAgICAgICAoY2xpY2spPVwibW9iaWxlQ2xvc2UoKVwiXHJcbiAgICAgICAgICAgICAgICAgID5cclxuICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPVwibGFiZWwtZGl2XCI+e3sgcGFyYWdyYXBoLmxhYmVsIH19PC9kaXY+XHJcbiAgICAgICAgICAgICAgICAgIDwvYT5cclxuICAgICAgICAgICAgICAgIDwvZGl2PlxyXG4gICAgICAgICAgICAgICAgPGRpdiAqbmdJZj1cInNoZWxsVXJsXCI+XHJcbiAgICAgICAgICAgICAgICAgIDxhXHJcbiAgICAgICAgICAgICAgICAgICAgKm5nRm9yPVwibGV0IHBhcmFncmFwaCBvZiBzdWJJdGVtLnBhcmFncmFwaHNcIlxyXG4gICAgICAgICAgICAgICAgICAgIGNsYXNzPVwiaXRlbSBzdWJwYWdlLXBhcmFncmFwaFwiXHJcbiAgICAgICAgICAgICAgICAgICAgaHJlZj1cInt7XHJcbiAgICAgICAgICAgICAgICAgICAgICBzaGVsbFVybCArXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICcvJyArXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRyaW1TbGFzaChzdWJJdGVtLnJvdXRlICsgZ2V0VXJsUGFyYW1zKGl0ZW0ucGFyYW1zKSkgK1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAnIycgK1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBwYXJhZ3JhcGguaWRcclxuICAgICAgICAgICAgICAgICAgICB9fVwiXHJcbiAgICAgICAgICAgICAgICAgICAgW2NsYXNzLnNlbGVjdGVkXT1cInBhcmFncmFwaC5pZCA9PT0gc2VsZWN0ZWRQYXJhZ3JhcGhcIlxyXG4gICAgICAgICAgICAgICAgICAgIChjbGljayk9XCJcclxuICAgICAgICAgICAgICAgICAgICAgIG1vYmlsZUNsb3NlKCk7IG5hdmlnYXRlTG9jYWwoJGV2ZW50LCBzdWJJdGVtLnJvdXRlLCBpdGVtLnBhcmFtcywgcGFyYWdyYXBoLmlkKVxyXG4gICAgICAgICAgICAgICAgICAgIFwiXHJcbiAgICAgICAgICAgICAgICAgID5cclxuICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPVwibGFiZWwtZGl2XCI+e3sgcGFyYWdyYXBoLmxhYmVsIH19PC9kaXY+XHJcbiAgICAgICAgICAgICAgICAgIDwvYT5cclxuICAgICAgICAgICAgICAgIDwvZGl2PlxyXG4gICAgICAgICAgICAgICAgPGRpdiBjbGFzcz1cInBhZ2UtcHJvZ3Jlc3MtYmFyXCI+XHJcbiAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9XCJwYWdlLXByb2dyZXNzLWJhci1iYWNrZ3JvdW5kXCI+PC9kaXY+XHJcbiAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9XCJwYWdlLXByb2dyZXNzLWJhci1zY3J1YmJlclwiIFtuZ1N0eWxlXT1cImdldFNjcnViYmVyU3R5bGUoKVwiPjwvZGl2PlxyXG4gICAgICAgICAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgICAgIDwvbmctdGVtcGxhdGU+XHJcbiAgICAgICAgICA8L2Rpdj5cclxuICAgICAgICA8L2Rpdj5cclxuICAgICAgPC9uZy10ZW1wbGF0ZT5cclxuICAgIDwvZGl2PlxyXG4gIDwvZGl2PlxyXG4gIDxkaXYgY2xhc3M9XCJhcnJvdy1zcGFjZXJcIj48L2Rpdj5cclxuXHJcbiAgPHN2Z1xyXG4gICAgKGNsaWNrKT1cImFycm93VG9nZ2xlT3BlbigpXCJcclxuICAgIFtjbGFzcy5jbG9zZWRdPVwiIW9wZW5cIlxyXG4gICAgY2xhc3M9XCJvcGVuLWNsb3NlLWFycm93XCJcclxuICAgIGlkPVwiTGF5ZXJfMVwiXHJcbiAgICBkYXRhLW5hbWU9XCJMYXllciAxXCJcclxuICAgIHhtbG5zPVwiaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmdcIlxyXG4gICAgd2lkdGg9XCIyNFwiXHJcbiAgICBoZWlnaHQ9XCIyNFwiXHJcbiAgICB2aWV3Qm94PVwiMCAwIDI0IDI0XCJcclxuICA+XHJcbiAgICA8ZyB0cmFuc2Zvcm09XCJ0cmFuc2xhdGUoNDA1IDEwMikgcm90YXRlKC0xODApXCI+XHJcbiAgICAgIDxwYXRoXHJcbiAgICAgICAgZD1cIk0tOTcyLjk1NSw0OTJsNi43NzQtNiwxLjU4MSwxLjQtNS4xOTQsNC42LDUuMTk0LDQuNi0xLjU4MSwxLjRabS01LjY0NSwwLDYuNzczLTYsMS41ODEsMS40LTUuMTkzLDQuNiw1LjE5Myw0LjYtMS41ODEsMS40WlwiXHJcbiAgICAgICAgdHJhbnNmb3JtPVwidHJhbnNsYXRlKDEzNjQuNiAtNDAyKVwiXHJcbiAgICAgIC8+XHJcbiAgICA8L2c+XHJcbiAgPC9zdmc+XHJcbjwvZGl2PlxyXG48ZGl2IGNsYXNzPVwic2NyaW1cIiAoY2xpY2spPVwib3BlbiA9IGZhbHNlXCI+PC9kaXY+XHJcbiJdfQ==