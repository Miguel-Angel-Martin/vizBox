<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, minimum-scale=1, initial-scale=1, user-scalable=yes">

  <title>Data Table</title>
  <meta name="description" content="Data Table">
  <script src="node_modules/@webcomponents/webcomponentsjs/webcomponents-loader.js"></script>
  <link rel="stylesheet" href="node_modules/@avl-styles/common/dist/avl-styles.css">

  <style>
    a::after {
      content: "\A";
      white-space: pre;
    }

    body {
      display: flex;
      justify-content: flex-start;
      flex-direction: row;
      height: 100%;
    }

    .sidenav {
      padding-left: 10px;
      width: 200px;
    }

    iframe {
      width: 99%;
      height: 95vh;
    }
  </style>

</head>

<body class="mdc-typography">
  <div class="sidenav">
      <input type="checkbox" id="themeToggle">
      <label for="themeToggle">Dark theme</label>
      <br>

      <a href="dist/avl-datatable/demo/avl-datatable.demo.html">Data Table</a>
  </div>

  <iframe src=""></iframe>

  <script>
    (function() {
      let isDesktopTheme = false;
      let isDarkTheme = false;
      // all anchor tags should change src attribute of iframe
      let iframe = document.body.querySelector('iframe');
      document.body.querySelectorAll('a').forEach(function (a) {
        a.addEventListener('click', function (e) {
          isDesktopTheme = a.href.includes('desktop');
          iframe.src = a.href;
          e.preventDefault();
          return false;
        });
      });

      let themeToggle = document.body.querySelector('#themeToggle');
      themeToggle.addEventListener('click', (event) => {
        isDarkTheme = themeToggle.checked;
        changeTheme();
      });

      iframe.onload = function() {
        changeTheme();  
      }; 

      function changeTheme() {
        let theme = (isDesktopTheme ? 'desktop-' : '') + (isDarkTheme ? 'dark' : 'light');
        let iframeDocument = iframe.contentDocument || iframe.contentWindow.document;
        iframeDocument.body.setAttribute('theme', theme);
        iframeDocument.body.querySelectorAll('avl-demo-snippet').forEach( (e) => {
          e.theme = theme.replace('desktop-', '');
        });
      }
    })();
  </script>


</body>

</html>
